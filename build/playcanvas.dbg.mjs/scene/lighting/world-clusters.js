/**
 * @license
 * PlayCanvas Engine v1.59.0-preview revision 797466563 (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
import { Vec3 } from '../../core/math/vec3.js';
import { math } from '../../core/math/math.js';
import { BoundingBox } from '../../core/shape/bounding-box.js';
import { PIXELFORMAT_RGBA8 } from '../../platform/graphics/constants.js';
import { MASK_AFFECT_DYNAMIC, MASK_AFFECT_LIGHTMAPPED, LIGHTTYPE_SPOT, LIGHTTYPE_DIRECTIONAL } from '../constants.js';
import { LightsBuffer } from './lights-buffer.js';
import { Debug } from '../../core/debug.js';

const tempVec3 = new Vec3();
const tempMin3 = new Vec3();
const tempMax3 = new Vec3();
const tempBox = new BoundingBox();
const epsilon = 0.000001;
const maxTextureSize = 4096;

class ClusterLight {
  constructor() {
    this.light = null;

    this.min = new Vec3();
    this.max = new Vec3();
  }
}

class WorldClusters {
  constructor(device) {
    this.device = device;
    this.name = 'Untitled';

    this.reportCount = 0;

    this.boundsMin = new Vec3();
    this.boundsMax = new Vec3();
    this.boundsDelta = new Vec3();

    this._cells = new Vec3(1, 1, 1);
    this._cellsLimit = new Vec3();
    this.cells = this._cells;

    this._maxCellLightCount = 0;
    this._pixelsPerCellCount = 0;
    this.maxCellLightCount = 4;

    this._maxAttenuation = 0;
    this._maxColorValue = 0;

    this._usedLights = [];

    this._usedLights.push(new ClusterLight());

    this.lightsBuffer = new LightsBuffer(device);

    this.registerUniforms(device);
  }
  set maxCellLightCount(count) {
    const maxCellLightCount = math.roundUp(count, 4);
    if (maxCellLightCount !== this._maxCellLightCount) {
      this._maxCellLightCount = maxCellLightCount;
      this._pixelsPerCellCount = this._maxCellLightCount / 4;
      this._cellsDirty = true;
    }
  }
  get maxCellLightCount() {
    return this._maxCellLightCount;
  }
  set cells(value) {
    tempVec3.copy(value).floor();
    if (!this._cells.equals(tempVec3)) {
      this._cells.copy(tempVec3);
      this._cellsLimit.copy(tempVec3).sub(Vec3.ONE);
      this._cellsDirty = true;
    }
  }
  get cells() {
    return this._cells;
  }
  destroy() {
    this.lightsBuffer.destroy();
    this.releaseClusterTexture();
  }
  releaseClusterTexture() {
    if (this.clusterTexture) {
      this.clusterTexture.destroy();
      this.clusterTexture = null;
    }
  }
  registerUniforms(device) {
    this._clusterMaxCellsId = device.scope.resolve('clusterMaxCells');
    this._clusterWorldTextureId = device.scope.resolve('clusterWorldTexture');
    this._clusterPixelsPerCellId = device.scope.resolve('clusterPixelsPerCell');
    this._clusterTextureSizeId = device.scope.resolve('clusterTextureSize');
    this._clusterTextureSizeData = new Float32Array(3);
    this._clusterBoundsMinId = device.scope.resolve('clusterBoundsMin');
    this._clusterBoundsMinData = new Float32Array(3);
    this._clusterBoundsDeltaId = device.scope.resolve('clusterBoundsDelta');
    this._clusterBoundsDeltaData = new Float32Array(3);
    this._clusterCellsCountByBoundsSizeId = device.scope.resolve('clusterCellsCountByBoundsSize');
    this._clusterCellsCountByBoundsSizeData = new Float32Array(3);
    this._clusterCellsDotId = device.scope.resolve('clusterCellsDot');
    this._clusterCellsDotData = new Float32Array(3);

    this._clusterCellsMaxId = device.scope.resolve('clusterCellsMax');
    this._clusterCellsMaxData = new Float32Array(3);

    this._clusterCompressionLimit0Id = device.scope.resolve('clusterCompressionLimit0');
    this._clusterCompressionLimit0Data = new Float32Array(2);
  }

  updateParams(lightingParams) {
    if (lightingParams) {
      this.cells = lightingParams.cells;
      this.maxCellLightCount = lightingParams.maxLightsPerCell;
      this.lightsBuffer.cookiesEnabled = lightingParams.cookiesEnabled;
      this.lightsBuffer.shadowsEnabled = lightingParams.shadowsEnabled;
      this.lightsBuffer.areaLightsEnabled = lightingParams.areaLightsEnabled;
    }
  }
  updateCells() {
    if (this._cellsDirty) {
      this._cellsDirty = false;
      const cx = this._cells.x;
      const cy = this._cells.y;
      const cz = this._cells.z;

      const numCells = cx * cy * cz;
      const totalPixels = this._pixelsPerCellCount * numCells;

      let width = Math.ceil(Math.sqrt(totalPixels));
      width = math.roundUp(width, this._pixelsPerCellCount);
      const height = Math.ceil(totalPixels / width);

      Debug.assert(width <= maxTextureSize && height <= maxTextureSize, 'Clustered lights parameters cause the texture size to be over the limit, please adjust them.');

      this._clusterCellsMaxData[0] = cx;
      this._clusterCellsMaxData[1] = cy;
      this._clusterCellsMaxData[2] = cz;

      this._clusterCellsDotData[0] = this._pixelsPerCellCount;
      this._clusterCellsDotData[1] = cx * cz * this._pixelsPerCellCount;
      this._clusterCellsDotData[2] = cx * this._pixelsPerCellCount;

      this.clusters = new Uint8ClampedArray(4 * totalPixels);
      this.counts = new Int32Array(numCells);
      this._clusterTextureSizeData[0] = width;
      this._clusterTextureSizeData[1] = 1.0 / width;
      this._clusterTextureSizeData[2] = 1.0 / height;
      this.releaseClusterTexture();
      this.clusterTexture = LightsBuffer.createTexture(this.device, width, height, PIXELFORMAT_RGBA8, 'ClusterTexture');
    }
  }
  uploadTextures() {
    this.clusterTexture.lock().set(this.clusters);
    this.clusterTexture.unlock();
    this.lightsBuffer.uploadTextures();
  }
  updateUniforms() {
    this.lightsBuffer.updateUniforms();

    this._clusterWorldTextureId.setValue(this.clusterTexture);

    this._clusterMaxCellsId.setValue(this._pixelsPerCellCount);
    const boundsDelta = this.boundsDelta;
    this._clusterCellsCountByBoundsSizeData[0] = this._cells.x / boundsDelta.x;
    this._clusterCellsCountByBoundsSizeData[1] = this._cells.y / boundsDelta.y;
    this._clusterCellsCountByBoundsSizeData[2] = this._cells.z / boundsDelta.z;
    this._clusterCellsCountByBoundsSizeId.setValue(this._clusterCellsCountByBoundsSizeData);
    this._clusterBoundsMinData[0] = this.boundsMin.x;
    this._clusterBoundsMinData[1] = this.boundsMin.y;
    this._clusterBoundsMinData[2] = this.boundsMin.z;
    this._clusterBoundsDeltaData[0] = boundsDelta.x;
    this._clusterBoundsDeltaData[1] = boundsDelta.y;
    this._clusterBoundsDeltaData[2] = boundsDelta.z;
    this._clusterCompressionLimit0Data[0] = this._maxAttenuation;
    this._clusterCompressionLimit0Data[1] = this._maxColorValue;

    this._clusterPixelsPerCellId.setValue(this._pixelsPerCellCount);
    this._clusterTextureSizeId.setValue(this._clusterTextureSizeData);
    this._clusterBoundsMinId.setValue(this._clusterBoundsMinData);
    this._clusterBoundsDeltaId.setValue(this._clusterBoundsDeltaData);
    this._clusterCellsDotId.setValue(this._clusterCellsDotData);
    this._clusterCellsMaxId.setValue(this._clusterCellsMaxData);
    this._clusterCompressionLimit0Id.setValue(this._clusterCompressionLimit0Data);
  }

  evalLightCellMinMax(clusteredLight, min, max) {
    min.copy(clusteredLight.min);
    min.sub(this.boundsMin);
    min.div(this.boundsDelta);
    min.mul2(min, this.cells);
    min.floor();

    max.copy(clusteredLight.max);
    max.sub(this.boundsMin);
    max.div(this.boundsDelta);
    max.mul2(max, this.cells);
    max.ceil();

    min.max(Vec3.ZERO);
    max.min(this._cellsLimit);
  }
  collectLights(lights) {
    const maxLights = this.lightsBuffer.maxLights;

    const usedLights = this._usedLights;
    let lightIndex = 1;
    lights.forEach(light => {
      const runtimeLight = !!(light.mask & (MASK_AFFECT_DYNAMIC | MASK_AFFECT_LIGHTMAPPED));
      const zeroAngleSpotlight = light.type === LIGHTTYPE_SPOT && light._outerConeAngle === 0;
      if (light.enabled && light.type !== LIGHTTYPE_DIRECTIONAL && light.visibleThisFrame && light.intensity > 0 && runtimeLight && !zeroAngleSpotlight) {
        if (lightIndex < maxLights) {
          let clusteredLight;
          if (lightIndex < usedLights.length) {
            clusteredLight = usedLights[lightIndex];
          } else {
            clusteredLight = new ClusterLight();
            usedLights.push(clusteredLight);
          }

          clusteredLight.light = light;
          light.getBoundingBox(tempBox);
          clusteredLight.min.copy(tempBox.getMin());
          clusteredLight.max.copy(tempBox.getMax());
          lightIndex++;
        } else {
          Debug.warnOnce(`Clustered lighting: more than ${maxLights - 1} lights in the frame, ignoring some.`);
        }
      }
    });
    usedLights.length = lightIndex;
  }

  evaluateBounds() {
    const usedLights = this._usedLights;

    const min = this.boundsMin;
    const max = this.boundsMax;

    if (usedLights.length > 1) {
      min.copy(usedLights[1].min);
      max.copy(usedLights[1].max);
      for (let i = 2; i < usedLights.length; i++) {
        min.min(usedLights[i].min);
        max.max(usedLights[i].max);
      }
    } else {
      min.set(0, 0, 0);
      max.set(1, 1, 1);
    }

    this.boundsDelta.sub2(max, min);
    this.lightsBuffer.setBounds(min, this.boundsDelta);
  }

  evaluateCompressionLimits(gammaCorrection) {
    let maxAttenuation = 0;
    let maxColorValue = 0;
    const usedLights = this._usedLights;
    for (let i = 1; i < usedLights.length; i++) {
      const light = usedLights[i].light;
      maxAttenuation = Math.max(light.attenuationEnd, maxAttenuation);
      const color = gammaCorrection ? light._linearFinalColor : light._finalColor;
      maxColorValue = Math.max(color[0], maxColorValue);
      maxColorValue = Math.max(color[1], maxColorValue);
      maxColorValue = Math.max(color[2], maxColorValue);
    }

    this._maxAttenuation = maxAttenuation + epsilon;
    this._maxColorValue = maxColorValue + epsilon;
    this.lightsBuffer.setCompressionRanges(this._maxAttenuation, this._maxColorValue);
  }
  updateClusters(gammaCorrection) {
    this.counts.fill(0);
    this.clusters.fill(0);

    const divX = this._cells.x;
    const divZ = this._cells.z;
    const counts = this.counts;
    const limit = this._maxCellLightCount;
    const clusters = this.clusters;
    const pixelsPerCellCount = this._pixelsPerCellCount;
    let tooManyLights = false;

    const usedLights = this._usedLights;
    for (let i = 1; i < usedLights.length; i++) {
      const clusteredLight = usedLights[i];
      const light = clusteredLight.light;

      this.lightsBuffer.addLightData(light, i, gammaCorrection);

      this.evalLightCellMinMax(clusteredLight, tempMin3, tempMax3);
      const xStart = tempMin3.x;
      const xEnd = tempMax3.x;
      const yStart = tempMin3.y;
      const yEnd = tempMax3.y;
      const zStart = tempMin3.z;
      const zEnd = tempMax3.z;

      for (let x = xStart; x <= xEnd; x++) {
        for (let z = zStart; z <= zEnd; z++) {
          for (let y = yStart; y <= yEnd; y++) {
            const clusterIndex = x + divX * (z + y * divZ);
            const count = counts[clusterIndex];
            if (count < limit) {
              clusters[pixelsPerCellCount * clusterIndex * 4 + count] = i;
              counts[clusterIndex] = count + 1;
            } else {
              tooManyLights = true;
            }
          }
        }
      }
    }
    if (tooManyLights) {
      const reportLimit = 5;
      if (this.reportCount < reportLimit) {
        console.warn('Too many lights in light cluster ' + this.name + ', please adjust parameters.' + (this.reportCount === reportLimit - 1 ? ' Giving up on reporting it.' : ''));
        this.reportCount++;
      }
    }
  }

  update(lights, gammaCorrection, lightingParams) {
    this.updateParams(lightingParams);
    this.updateCells();
    this.collectLights(lights);
    this.evaluateBounds();
    this.evaluateCompressionLimits(gammaCorrection);
    this.updateClusters(gammaCorrection);
    this.uploadTextures();
  }

  activate() {
    this.updateUniforms();
  }
}

export { WorldClusters };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid29ybGQtY2x1c3RlcnMuanMiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9zY2VuZS9saWdodGluZy93b3JsZC1jbHVzdGVycy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBWZWMzIH0gZnJvbSAnLi4vLi4vY29yZS9tYXRoL3ZlYzMuanMnO1xuaW1wb3J0IHsgbWF0aCB9IGZyb20gJy4uLy4uL2NvcmUvbWF0aC9tYXRoLmpzJztcbmltcG9ydCB7IEJvdW5kaW5nQm94IH0gZnJvbSAnLi4vLi4vY29yZS9zaGFwZS9ib3VuZGluZy1ib3guanMnO1xuaW1wb3J0IHsgUElYRUxGT1JNQVRfUkdCQTggfSBmcm9tICcuLi8uLi9wbGF0Zm9ybS9ncmFwaGljcy9jb25zdGFudHMuanMnO1xuaW1wb3J0IHsgTElHSFRUWVBFX0RJUkVDVElPTkFMLCBMSUdIVFRZUEVfU1BPVCwgTUFTS19BRkZFQ1RfRFlOQU1JQywgTUFTS19BRkZFQ1RfTElHSFRNQVBQRUQgfSBmcm9tICcuLi9jb25zdGFudHMuanMnO1xuaW1wb3J0IHsgTGlnaHRzQnVmZmVyIH0gZnJvbSAnLi9saWdodHMtYnVmZmVyLmpzJztcbmltcG9ydCB7IERlYnVnIH0gZnJvbSAnLi4vLi4vY29yZS9kZWJ1Zy5qcyc7XG5cbmNvbnN0IHRlbXBWZWMzID0gbmV3IFZlYzMoKTtcbmNvbnN0IHRlbXBNaW4zID0gbmV3IFZlYzMoKTtcbmNvbnN0IHRlbXBNYXgzID0gbmV3IFZlYzMoKTtcbmNvbnN0IHRlbXBCb3ggPSBuZXcgQm91bmRpbmdCb3goKTtcblxuY29uc3QgZXBzaWxvbiA9IDAuMDAwMDAxO1xuY29uc3QgbWF4VGV4dHVyZVNpemUgPSA0MDk2OyAgICAvLyBtYXhpbXVtIHRleHR1cmUgc2l6ZSBhbGxvd2VkIHRvIHdvcmsgb24gYWxsIGRldmljZXNcblxuLy8gaGVscGVyIGNsYXNzIHRvIHN0b3JlIHByb3BlcnRpZXMgb2YgYSBsaWdodCB1c2VkIGJ5IGNsdXN0ZXJpbmdcbmNsYXNzIENsdXN0ZXJMaWdodCB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIC8vIHRoZSBsaWdodCBpdHNlbGZcbiAgICAgICAgdGhpcy5saWdodCA9IG51bGw7XG5cbiAgICAgICAgLy8gYm91bmRpbmcgYm94XG4gICAgICAgIHRoaXMubWluID0gbmV3IFZlYzMoKTtcbiAgICAgICAgdGhpcy5tYXggPSBuZXcgVmVjMygpO1xuICAgIH1cbn1cblxuLy8gTWFpbiBjbGFzcyBpbXBsZW1lbnRpbmcgY2x1c3RlcmVkIGxpZ2h0aW5nLiBJbnRlcm5hbGx5IGl0IG9yZ2FuaXplcyB0aGUgb21uaSAvIHNwb3QgbGlnaHRzIHBsYWNlbWVudCBpbiB3b3JsZCBzcGFjZSAzZCBjZWxsIHN0cnVjdHVyZSxcbi8vIGFuZCBhbHNvIHVzZXMgTGlnaHRzQnVmZmVyIGNsYXNzIHRvIHN0b3JlIGxpZ2h0IHByb3BlcnRpZXMgaW4gdGV4dHVyZXNcbmNsYXNzIFdvcmxkQ2x1c3RlcnMge1xuICAgIGNvbnN0cnVjdG9yKGRldmljZSkge1xuICAgICAgICB0aGlzLmRldmljZSA9IGRldmljZTtcbiAgICAgICAgdGhpcy5uYW1lID0gJ1VudGl0bGVkJztcblxuICAgICAgICAvLyBudW1iZXIgb2YgdGltZXMgYSB3YXJuaW5nIHdhcyByZXBvcnRlZFxuICAgICAgICB0aGlzLnJlcG9ydENvdW50ID0gMDtcblxuICAgICAgICAvLyBib3VuZHMgb2YgYWxsIGxpZ2h0IHZvbHVtZXMgKHZvbHVtZSBjb3ZlcmVkIGJ5IHRoZSBjbHVzdGVycylcbiAgICAgICAgdGhpcy5ib3VuZHNNaW4gPSBuZXcgVmVjMygpO1xuICAgICAgICB0aGlzLmJvdW5kc01heCA9IG5ldyBWZWMzKCk7XG4gICAgICAgIHRoaXMuYm91bmRzRGVsdGEgPSBuZXcgVmVjMygpO1xuXG4gICAgICAgIC8vIG51bWJlciBvZiBjZWxscyBhbG9uZyAzIGF4ZXNcbiAgICAgICAgdGhpcy5fY2VsbHMgPSBuZXcgVmVjMygxLCAxLCAxKTsgICAgICAgLy8gbnVtYmVyIG9mIGNlbGxzXG4gICAgICAgIHRoaXMuX2NlbGxzTGltaXQgPSBuZXcgVmVjMygpOyAgLy8gbnVtYmVyIG9mIGNlbGxzIG1pbnVzIG9uZVxuICAgICAgICB0aGlzLmNlbGxzID0gdGhpcy5fY2VsbHM7XG5cbiAgICAgICAgLy8gbnVtYmVyIG9mIGxpZ2h0cyBlYWNoIGNlbGwgY2FuIHN0b3JlLCBhbmQgbnVtYmVyIG9mIHBpeGVscyB0aGlzIHRha2VzICg0IGxpZ2h0cyBwZXIgcGl4ZWwpXG4gICAgICAgIHRoaXMuX21heENlbGxMaWdodENvdW50ID0gMDtcbiAgICAgICAgdGhpcy5fcGl4ZWxzUGVyQ2VsbENvdW50ID0gMDtcbiAgICAgICAgdGhpcy5tYXhDZWxsTGlnaHRDb3VudCA9IDQ7XG5cbiAgICAgICAgLy8gbGltaXRzIG9uIHNvbWUgbGlnaHQgcHJvcGVydGllcywgdXNlZCBmb3IgY29tcHJlc3Npb24gdG8gOGJpdCB0ZXh0dXJlXG4gICAgICAgIHRoaXMuX21heEF0dGVudWF0aW9uID0gMDtcbiAgICAgICAgdGhpcy5fbWF4Q29sb3JWYWx1ZSA9IDA7XG5cbiAgICAgICAgLy8gaW50ZXJuYWwgbGlzdCBvZiBsaWdodHMgKG9mIHR5cGUgQ2x1c3RlckxpZ2h0KVxuICAgICAgICB0aGlzLl91c2VkTGlnaHRzID0gW107XG5cbiAgICAgICAgLy8gbGlnaHQgMCBpcyBhbHdheXMgcmVzZXJ2ZWQgZm9yICdubyBsaWdodCcgaW5kZXhcbiAgICAgICAgdGhpcy5fdXNlZExpZ2h0cy5wdXNoKG5ldyBDbHVzdGVyTGlnaHQoKSk7XG5cbiAgICAgICAgLy8gYWxsb2NhdGUgdGV4dHVyZXMgdG8gc3RvcmUgbGlnaHRzXG4gICAgICAgIHRoaXMubGlnaHRzQnVmZmVyID0gbmV3IExpZ2h0c0J1ZmZlcihkZXZpY2UpO1xuXG4gICAgICAgIC8vIHJlZ2lzdGVyIHNoYWRlciB1bmlmb3Jtc1xuICAgICAgICB0aGlzLnJlZ2lzdGVyVW5pZm9ybXMoZGV2aWNlKTtcbiAgICB9XG5cbiAgICBzZXQgbWF4Q2VsbExpZ2h0Q291bnQoY291bnQpIHtcblxuICAgICAgICAvLyBlYWNoIGNlbGwgc3RvcmVzIDQgbGlnaHRzICh4eXp3KSwgc28gcm91bmQgdXAgdGhlIGNvdW50XG4gICAgICAgIGNvbnN0IG1heENlbGxMaWdodENvdW50ID0gbWF0aC5yb3VuZFVwKGNvdW50LCA0KTtcbiAgICAgICAgaWYgKG1heENlbGxMaWdodENvdW50ICE9PSB0aGlzLl9tYXhDZWxsTGlnaHRDb3VudCkge1xuICAgICAgICAgICAgdGhpcy5fbWF4Q2VsbExpZ2h0Q291bnQgPSBtYXhDZWxsTGlnaHRDb3VudDtcbiAgICAgICAgICAgIHRoaXMuX3BpeGVsc1BlckNlbGxDb3VudCA9IHRoaXMuX21heENlbGxMaWdodENvdW50IC8gNDtcbiAgICAgICAgICAgIHRoaXMuX2NlbGxzRGlydHkgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0IG1heENlbGxMaWdodENvdW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fbWF4Q2VsbExpZ2h0Q291bnQ7XG4gICAgfVxuXG4gICAgc2V0IGNlbGxzKHZhbHVlKSB7XG5cbiAgICAgICAgLy8gbWFrZSBzdXJlIHdlIGhhdmUgd2hvbGUgbnVtYmVyc1xuICAgICAgICB0ZW1wVmVjMy5jb3B5KHZhbHVlKS5mbG9vcigpO1xuXG4gICAgICAgIGlmICghdGhpcy5fY2VsbHMuZXF1YWxzKHRlbXBWZWMzKSkge1xuICAgICAgICAgICAgdGhpcy5fY2VsbHMuY29weSh0ZW1wVmVjMyk7XG4gICAgICAgICAgICB0aGlzLl9jZWxsc0xpbWl0LmNvcHkodGVtcFZlYzMpLnN1YihWZWMzLk9ORSk7XG4gICAgICAgICAgICB0aGlzLl9jZWxsc0RpcnR5ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldCBjZWxscygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NlbGxzO1xuICAgIH1cblxuICAgIGRlc3Ryb3koKSB7XG5cbiAgICAgICAgdGhpcy5saWdodHNCdWZmZXIuZGVzdHJveSgpO1xuXG4gICAgICAgIHRoaXMucmVsZWFzZUNsdXN0ZXJUZXh0dXJlKCk7XG4gICAgfVxuXG4gICAgcmVsZWFzZUNsdXN0ZXJUZXh0dXJlKCkge1xuICAgICAgICBpZiAodGhpcy5jbHVzdGVyVGV4dHVyZSkge1xuICAgICAgICAgICAgdGhpcy5jbHVzdGVyVGV4dHVyZS5kZXN0cm95KCk7XG4gICAgICAgICAgICB0aGlzLmNsdXN0ZXJUZXh0dXJlID0gbnVsbDtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJlZ2lzdGVyVW5pZm9ybXMoZGV2aWNlKSB7XG5cbiAgICAgICAgdGhpcy5fY2x1c3Rlck1heENlbGxzSWQgPSBkZXZpY2Uuc2NvcGUucmVzb2x2ZSgnY2x1c3Rlck1heENlbGxzJyk7XG5cbiAgICAgICAgdGhpcy5fY2x1c3RlcldvcmxkVGV4dHVyZUlkID0gZGV2aWNlLnNjb3BlLnJlc29sdmUoJ2NsdXN0ZXJXb3JsZFRleHR1cmUnKTtcbiAgICAgICAgdGhpcy5fY2x1c3RlclBpeGVsc1BlckNlbGxJZCA9IGRldmljZS5zY29wZS5yZXNvbHZlKCdjbHVzdGVyUGl4ZWxzUGVyQ2VsbCcpO1xuXG4gICAgICAgIHRoaXMuX2NsdXN0ZXJUZXh0dXJlU2l6ZUlkID0gZGV2aWNlLnNjb3BlLnJlc29sdmUoJ2NsdXN0ZXJUZXh0dXJlU2l6ZScpO1xuICAgICAgICB0aGlzLl9jbHVzdGVyVGV4dHVyZVNpemVEYXRhID0gbmV3IEZsb2F0MzJBcnJheSgzKTtcblxuICAgICAgICB0aGlzLl9jbHVzdGVyQm91bmRzTWluSWQgPSBkZXZpY2Uuc2NvcGUucmVzb2x2ZSgnY2x1c3RlckJvdW5kc01pbicpO1xuICAgICAgICB0aGlzLl9jbHVzdGVyQm91bmRzTWluRGF0YSA9IG5ldyBGbG9hdDMyQXJyYXkoMyk7XG5cbiAgICAgICAgdGhpcy5fY2x1c3RlckJvdW5kc0RlbHRhSWQgPSBkZXZpY2Uuc2NvcGUucmVzb2x2ZSgnY2x1c3RlckJvdW5kc0RlbHRhJyk7XG4gICAgICAgIHRoaXMuX2NsdXN0ZXJCb3VuZHNEZWx0YURhdGEgPSBuZXcgRmxvYXQzMkFycmF5KDMpO1xuXG4gICAgICAgIHRoaXMuX2NsdXN0ZXJDZWxsc0NvdW50QnlCb3VuZHNTaXplSWQgPSBkZXZpY2Uuc2NvcGUucmVzb2x2ZSgnY2x1c3RlckNlbGxzQ291bnRCeUJvdW5kc1NpemUnKTtcbiAgICAgICAgdGhpcy5fY2x1c3RlckNlbGxzQ291bnRCeUJvdW5kc1NpemVEYXRhID0gbmV3IEZsb2F0MzJBcnJheSgzKTtcblxuICAgICAgICB0aGlzLl9jbHVzdGVyQ2VsbHNEb3RJZCA9IGRldmljZS5zY29wZS5yZXNvbHZlKCdjbHVzdGVyQ2VsbHNEb3QnKTtcbiAgICAgICAgdGhpcy5fY2x1c3RlckNlbGxzRG90RGF0YSA9IG5ldyBGbG9hdDMyQXJyYXkoMyk7XG5cbiAgICAgICAgLy8gbnVtYmVyIG9mIGNlbGxzIGluIGVhY2ggZGlyZWN0aW9uICh2ZWMzKVxuICAgICAgICB0aGlzLl9jbHVzdGVyQ2VsbHNNYXhJZCA9IGRldmljZS5zY29wZS5yZXNvbHZlKCdjbHVzdGVyQ2VsbHNNYXgnKTtcbiAgICAgICAgdGhpcy5fY2x1c3RlckNlbGxzTWF4RGF0YSA9IG5ldyBGbG9hdDMyQXJyYXkoMyk7XG5cbiAgICAgICAgLy8gY29tcHJlc3Npb24gbGltaXQgMFxuICAgICAgICB0aGlzLl9jbHVzdGVyQ29tcHJlc3Npb25MaW1pdDBJZCA9IGRldmljZS5zY29wZS5yZXNvbHZlKCdjbHVzdGVyQ29tcHJlc3Npb25MaW1pdDAnKTtcbiAgICAgICAgdGhpcy5fY2x1c3RlckNvbXByZXNzaW9uTGltaXQwRGF0YSA9IG5ldyBGbG9hdDMyQXJyYXkoMik7XG4gICAgfVxuXG4gICAgLy8gdXBkYXRlcyBpdHNlbGYgYmFzZWQgb24gcGFyYW1ldGVycyBzdG9yZWQgaW4gdGhlIHNjZW5lXG4gICAgdXBkYXRlUGFyYW1zKGxpZ2h0aW5nUGFyYW1zKSB7XG4gICAgICAgIGlmIChsaWdodGluZ1BhcmFtcykge1xuICAgICAgICAgICAgdGhpcy5jZWxscyA9IGxpZ2h0aW5nUGFyYW1zLmNlbGxzO1xuICAgICAgICAgICAgdGhpcy5tYXhDZWxsTGlnaHRDb3VudCA9IGxpZ2h0aW5nUGFyYW1zLm1heExpZ2h0c1BlckNlbGw7XG5cbiAgICAgICAgICAgIHRoaXMubGlnaHRzQnVmZmVyLmNvb2tpZXNFbmFibGVkID0gbGlnaHRpbmdQYXJhbXMuY29va2llc0VuYWJsZWQ7XG4gICAgICAgICAgICB0aGlzLmxpZ2h0c0J1ZmZlci5zaGFkb3dzRW5hYmxlZCA9IGxpZ2h0aW5nUGFyYW1zLnNoYWRvd3NFbmFibGVkO1xuXG4gICAgICAgICAgICB0aGlzLmxpZ2h0c0J1ZmZlci5hcmVhTGlnaHRzRW5hYmxlZCA9IGxpZ2h0aW5nUGFyYW1zLmFyZWFMaWdodHNFbmFibGVkO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgdXBkYXRlQ2VsbHMoKSB7XG4gICAgICAgIGlmICh0aGlzLl9jZWxsc0RpcnR5KSB7XG4gICAgICAgICAgICB0aGlzLl9jZWxsc0RpcnR5ID0gZmFsc2U7XG5cbiAgICAgICAgICAgIGNvbnN0IGN4ID0gdGhpcy5fY2VsbHMueDtcbiAgICAgICAgICAgIGNvbnN0IGN5ID0gdGhpcy5fY2VsbHMueTtcbiAgICAgICAgICAgIGNvbnN0IGN6ID0gdGhpcy5fY2VsbHMuejtcblxuICAgICAgICAgICAgLy8gc3RvcmluZyA0IGxpZ2h0cyBwZXIgcGl4ZWxzXG4gICAgICAgICAgICBjb25zdCBudW1DZWxscyA9IGN4ICogY3kgKiBjejtcbiAgICAgICAgICAgIGNvbnN0IHRvdGFsUGl4ZWxzID0gdGhpcy5fcGl4ZWxzUGVyQ2VsbENvdW50ICogbnVtQ2VsbHM7XG5cbiAgICAgICAgICAgIC8vIGNsdXN0ZXIgdGV4dHVyZSBzaXplIC0gcm91Z2hseSBzcXVhcmUgdGhhdCBmaXRzIGFsbCBjZWxscy4gVGhlIHdpZHRoIGlzIG11bHRpcGx5IG9mIG51bVBpeGVscyB0byBzaW1wbGlmeSBzaGFkZXIgbWF0aFxuICAgICAgICAgICAgbGV0IHdpZHRoID0gTWF0aC5jZWlsKE1hdGguc3FydCh0b3RhbFBpeGVscykpO1xuICAgICAgICAgICAgd2lkdGggPSBtYXRoLnJvdW5kVXAod2lkdGgsIHRoaXMuX3BpeGVsc1BlckNlbGxDb3VudCk7XG4gICAgICAgICAgICBjb25zdCBoZWlnaHQgPSBNYXRoLmNlaWwodG90YWxQaXhlbHMgLyB3aWR0aCk7XG5cbiAgICAgICAgICAgIC8vIGlmIHRoZSB0ZXh0dXJlIGlzIGFsbG93ZWQgc2l6ZVxuICAgICAgICAgICAgRGVidWcuYXNzZXJ0KHdpZHRoIDw9IG1heFRleHR1cmVTaXplICYmIGhlaWdodCA8PSBtYXhUZXh0dXJlU2l6ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAnQ2x1c3RlcmVkIGxpZ2h0cyBwYXJhbWV0ZXJzIGNhdXNlIHRoZSB0ZXh0dXJlIHNpemUgdG8gYmUgb3ZlciB0aGUgbGltaXQsIHBsZWFzZSBhZGp1c3QgdGhlbS4nKTtcblxuICAgICAgICAgICAgLy8gbWF4aW11bSByYW5nZSBvZiBjZWxsc1xuICAgICAgICAgICAgdGhpcy5fY2x1c3RlckNlbGxzTWF4RGF0YVswXSA9IGN4O1xuICAgICAgICAgICAgdGhpcy5fY2x1c3RlckNlbGxzTWF4RGF0YVsxXSA9IGN5O1xuICAgICAgICAgICAgdGhpcy5fY2x1c3RlckNlbGxzTWF4RGF0YVsyXSA9IGN6O1xuXG4gICAgICAgICAgICAvLyB2ZWN0b3IgdG8gYWxsb3cgc2luZ2xlIGRvdCBwcm9kdWN0IHRvIGNvbnZlcnQgZnJvbSB3b3JsZCBjb29yZGluYXRlcyB0byBjbHVzdGVyIGluZGV4XG4gICAgICAgICAgICB0aGlzLl9jbHVzdGVyQ2VsbHNEb3REYXRhWzBdID0gdGhpcy5fcGl4ZWxzUGVyQ2VsbENvdW50O1xuICAgICAgICAgICAgdGhpcy5fY2x1c3RlckNlbGxzRG90RGF0YVsxXSA9IGN4ICogY3ogKiB0aGlzLl9waXhlbHNQZXJDZWxsQ291bnQ7XG4gICAgICAgICAgICB0aGlzLl9jbHVzdGVyQ2VsbHNEb3REYXRhWzJdID0gY3ggKiB0aGlzLl9waXhlbHNQZXJDZWxsQ291bnQ7XG5cbiAgICAgICAgICAgIC8vIGNsdXN0ZXIgZGF0YSBhbmQgbnVtYmVyIG9mIGxpZ2h0cyBwZXIgY2VsbFxuICAgICAgICAgICAgdGhpcy5jbHVzdGVycyA9IG5ldyBVaW50OENsYW1wZWRBcnJheSg0ICogdG90YWxQaXhlbHMpO1xuICAgICAgICAgICAgdGhpcy5jb3VudHMgPSBuZXcgSW50MzJBcnJheShudW1DZWxscyk7XG5cbiAgICAgICAgICAgIHRoaXMuX2NsdXN0ZXJUZXh0dXJlU2l6ZURhdGFbMF0gPSB3aWR0aDtcbiAgICAgICAgICAgIHRoaXMuX2NsdXN0ZXJUZXh0dXJlU2l6ZURhdGFbMV0gPSAxLjAgLyB3aWR0aDtcbiAgICAgICAgICAgIHRoaXMuX2NsdXN0ZXJUZXh0dXJlU2l6ZURhdGFbMl0gPSAxLjAgLyBoZWlnaHQ7XG5cbiAgICAgICAgICAgIHRoaXMucmVsZWFzZUNsdXN0ZXJUZXh0dXJlKCk7XG4gICAgICAgICAgICB0aGlzLmNsdXN0ZXJUZXh0dXJlID0gTGlnaHRzQnVmZmVyLmNyZWF0ZVRleHR1cmUodGhpcy5kZXZpY2UsIHdpZHRoLCBoZWlnaHQsIFBJWEVMRk9STUFUX1JHQkE4LCAnQ2x1c3RlclRleHR1cmUnKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHVwbG9hZFRleHR1cmVzKCkge1xuXG4gICAgICAgIHRoaXMuY2x1c3RlclRleHR1cmUubG9jaygpLnNldCh0aGlzLmNsdXN0ZXJzKTtcbiAgICAgICAgdGhpcy5jbHVzdGVyVGV4dHVyZS51bmxvY2soKTtcblxuICAgICAgICB0aGlzLmxpZ2h0c0J1ZmZlci51cGxvYWRUZXh0dXJlcygpO1xuICAgIH1cblxuICAgIHVwZGF0ZVVuaWZvcm1zKCkge1xuXG4gICAgICAgIHRoaXMubGlnaHRzQnVmZmVyLnVwZGF0ZVVuaWZvcm1zKCk7XG5cbiAgICAgICAgLy8gdGV4dHVyZVxuICAgICAgICB0aGlzLl9jbHVzdGVyV29ybGRUZXh0dXJlSWQuc2V0VmFsdWUodGhpcy5jbHVzdGVyVGV4dHVyZSk7XG5cbiAgICAgICAgLy8gdW5pZm9ybSB2YWx1ZXNcbiAgICAgICAgdGhpcy5fY2x1c3Rlck1heENlbGxzSWQuc2V0VmFsdWUodGhpcy5fcGl4ZWxzUGVyQ2VsbENvdW50KTtcblxuICAgICAgICBjb25zdCBib3VuZHNEZWx0YSA9IHRoaXMuYm91bmRzRGVsdGE7XG4gICAgICAgIHRoaXMuX2NsdXN0ZXJDZWxsc0NvdW50QnlCb3VuZHNTaXplRGF0YVswXSA9IHRoaXMuX2NlbGxzLnggLyBib3VuZHNEZWx0YS54O1xuICAgICAgICB0aGlzLl9jbHVzdGVyQ2VsbHNDb3VudEJ5Qm91bmRzU2l6ZURhdGFbMV0gPSB0aGlzLl9jZWxscy55IC8gYm91bmRzRGVsdGEueTtcbiAgICAgICAgdGhpcy5fY2x1c3RlckNlbGxzQ291bnRCeUJvdW5kc1NpemVEYXRhWzJdID0gdGhpcy5fY2VsbHMueiAvIGJvdW5kc0RlbHRhLno7XG4gICAgICAgIHRoaXMuX2NsdXN0ZXJDZWxsc0NvdW50QnlCb3VuZHNTaXplSWQuc2V0VmFsdWUodGhpcy5fY2x1c3RlckNlbGxzQ291bnRCeUJvdW5kc1NpemVEYXRhKTtcblxuICAgICAgICB0aGlzLl9jbHVzdGVyQm91bmRzTWluRGF0YVswXSA9IHRoaXMuYm91bmRzTWluLng7XG4gICAgICAgIHRoaXMuX2NsdXN0ZXJCb3VuZHNNaW5EYXRhWzFdID0gdGhpcy5ib3VuZHNNaW4ueTtcbiAgICAgICAgdGhpcy5fY2x1c3RlckJvdW5kc01pbkRhdGFbMl0gPSB0aGlzLmJvdW5kc01pbi56O1xuXG4gICAgICAgIHRoaXMuX2NsdXN0ZXJCb3VuZHNEZWx0YURhdGFbMF0gPSBib3VuZHNEZWx0YS54O1xuICAgICAgICB0aGlzLl9jbHVzdGVyQm91bmRzRGVsdGFEYXRhWzFdID0gYm91bmRzRGVsdGEueTtcbiAgICAgICAgdGhpcy5fY2x1c3RlckJvdW5kc0RlbHRhRGF0YVsyXSA9IGJvdW5kc0RlbHRhLno7XG5cbiAgICAgICAgdGhpcy5fY2x1c3RlckNvbXByZXNzaW9uTGltaXQwRGF0YVswXSA9IHRoaXMuX21heEF0dGVudWF0aW9uO1xuICAgICAgICB0aGlzLl9jbHVzdGVyQ29tcHJlc3Npb25MaW1pdDBEYXRhWzFdID0gdGhpcy5fbWF4Q29sb3JWYWx1ZTtcblxuICAgICAgICAvLyBhc3NpZ24gdmFsdWVzXG4gICAgICAgIHRoaXMuX2NsdXN0ZXJQaXhlbHNQZXJDZWxsSWQuc2V0VmFsdWUodGhpcy5fcGl4ZWxzUGVyQ2VsbENvdW50KTtcbiAgICAgICAgdGhpcy5fY2x1c3RlclRleHR1cmVTaXplSWQuc2V0VmFsdWUodGhpcy5fY2x1c3RlclRleHR1cmVTaXplRGF0YSk7XG4gICAgICAgIHRoaXMuX2NsdXN0ZXJCb3VuZHNNaW5JZC5zZXRWYWx1ZSh0aGlzLl9jbHVzdGVyQm91bmRzTWluRGF0YSk7XG4gICAgICAgIHRoaXMuX2NsdXN0ZXJCb3VuZHNEZWx0YUlkLnNldFZhbHVlKHRoaXMuX2NsdXN0ZXJCb3VuZHNEZWx0YURhdGEpO1xuICAgICAgICB0aGlzLl9jbHVzdGVyQ2VsbHNEb3RJZC5zZXRWYWx1ZSh0aGlzLl9jbHVzdGVyQ2VsbHNEb3REYXRhKTtcbiAgICAgICAgdGhpcy5fY2x1c3RlckNlbGxzTWF4SWQuc2V0VmFsdWUodGhpcy5fY2x1c3RlckNlbGxzTWF4RGF0YSk7XG4gICAgICAgIHRoaXMuX2NsdXN0ZXJDb21wcmVzc2lvbkxpbWl0MElkLnNldFZhbHVlKHRoaXMuX2NsdXN0ZXJDb21wcmVzc2lvbkxpbWl0MERhdGEpO1xuICAgIH1cblxuICAgIC8vIGV2YWx1YXRlcyBtaW4gYW5kIG1heCBjb29yZGluYXRlcyBvZiBBQUJCIG9mIHRoZSBsaWdodCBpbiB0aGUgY2VsbCBzcGFjZVxuICAgIGV2YWxMaWdodENlbGxNaW5NYXgoY2x1c3RlcmVkTGlnaHQsIG1pbiwgbWF4KSB7XG5cbiAgICAgICAgLy8gbWluIHBvaW50IG9mIEFBQkIgaW4gY2VsbCBzcGFjZVxuICAgICAgICBtaW4uY29weShjbHVzdGVyZWRMaWdodC5taW4pO1xuICAgICAgICBtaW4uc3ViKHRoaXMuYm91bmRzTWluKTtcbiAgICAgICAgbWluLmRpdih0aGlzLmJvdW5kc0RlbHRhKTtcbiAgICAgICAgbWluLm11bDIobWluLCB0aGlzLmNlbGxzKTtcbiAgICAgICAgbWluLmZsb29yKCk7XG5cbiAgICAgICAgLy8gbWF4IHBvaW50IG9mIEFBQkIgaW4gY2VsbCBzcGFjZVxuICAgICAgICBtYXguY29weShjbHVzdGVyZWRMaWdodC5tYXgpO1xuICAgICAgICBtYXguc3ViKHRoaXMuYm91bmRzTWluKTtcbiAgICAgICAgbWF4LmRpdih0aGlzLmJvdW5kc0RlbHRhKTtcbiAgICAgICAgbWF4Lm11bDIobWF4LCB0aGlzLmNlbGxzKTtcbiAgICAgICAgbWF4LmNlaWwoKTtcblxuICAgICAgICAvLyBjbGFtcCB0byBsaW1pdHNcbiAgICAgICAgbWluLm1heChWZWMzLlpFUk8pO1xuICAgICAgICBtYXgubWluKHRoaXMuX2NlbGxzTGltaXQpO1xuICAgIH1cblxuICAgIGNvbGxlY3RMaWdodHMobGlnaHRzKSB7XG5cbiAgICAgICAgY29uc3QgbWF4TGlnaHRzID0gdGhpcy5saWdodHNCdWZmZXIubWF4TGlnaHRzO1xuXG4gICAgICAgIC8vIHNraXAgaW5kZXggMCBhcyB0aGF0IGlzIHVzZWQgZm9yIHVudXNlZCBsaWdodFxuICAgICAgICBjb25zdCB1c2VkTGlnaHRzID0gdGhpcy5fdXNlZExpZ2h0cztcbiAgICAgICAgbGV0IGxpZ2h0SW5kZXggPSAxO1xuXG4gICAgICAgIGxpZ2h0cy5mb3JFYWNoKChsaWdodCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcnVudGltZUxpZ2h0ID0gISEobGlnaHQubWFzayAmIChNQVNLX0FGRkVDVF9EWU5BTUlDIHwgTUFTS19BRkZFQ1RfTElHSFRNQVBQRUQpKTtcbiAgICAgICAgICAgIGNvbnN0IHplcm9BbmdsZVNwb3RsaWdodCA9IGxpZ2h0LnR5cGUgPT09IExJR0hUVFlQRV9TUE9UICYmIGxpZ2h0Ll9vdXRlckNvbmVBbmdsZSA9PT0gMDtcbiAgICAgICAgICAgIGlmIChsaWdodC5lbmFibGVkICYmIGxpZ2h0LnR5cGUgIT09IExJR0hUVFlQRV9ESVJFQ1RJT05BTCAmJiBsaWdodC52aXNpYmxlVGhpc0ZyYW1lICYmIGxpZ2h0LmludGVuc2l0eSA+IDAgJiYgcnVudGltZUxpZ2h0ICYmICF6ZXJvQW5nbGVTcG90bGlnaHQpIHtcblxuICAgICAgICAgICAgICAgIC8vIHdpdGhpbiBsaWdodCBsaW1pdFxuICAgICAgICAgICAgICAgIGlmIChsaWdodEluZGV4IDwgbWF4TGlnaHRzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gcmV1c2UgYWxsb2NhdGVkIHNwb3RcbiAgICAgICAgICAgICAgICAgICAgbGV0IGNsdXN0ZXJlZExpZ2h0O1xuICAgICAgICAgICAgICAgICAgICBpZiAobGlnaHRJbmRleCA8IHVzZWRMaWdodHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjbHVzdGVyZWRMaWdodCA9IHVzZWRMaWdodHNbbGlnaHRJbmRleF07XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBhbGxvY2F0ZSBuZXcgc3BvdFxuICAgICAgICAgICAgICAgICAgICAgICAgY2x1c3RlcmVkTGlnaHQgPSBuZXcgQ2x1c3RlckxpZ2h0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB1c2VkTGlnaHRzLnB1c2goY2x1c3RlcmVkTGlnaHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gc3RvcmUgbGlnaHQgcHJvcGVydGllc1xuICAgICAgICAgICAgICAgICAgICBjbHVzdGVyZWRMaWdodC5saWdodCA9IGxpZ2h0O1xuICAgICAgICAgICAgICAgICAgICBsaWdodC5nZXRCb3VuZGluZ0JveCh0ZW1wQm94KTtcbiAgICAgICAgICAgICAgICAgICAgY2x1c3RlcmVkTGlnaHQubWluLmNvcHkodGVtcEJveC5nZXRNaW4oKSk7XG4gICAgICAgICAgICAgICAgICAgIGNsdXN0ZXJlZExpZ2h0Lm1heC5jb3B5KHRlbXBCb3guZ2V0TWF4KCkpO1xuXG4gICAgICAgICAgICAgICAgICAgIGxpZ2h0SW5kZXgrKztcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBEZWJ1Zy53YXJuT25jZShgQ2x1c3RlcmVkIGxpZ2h0aW5nOiBtb3JlIHRoYW4gJHttYXhMaWdodHMgLSAxfSBsaWdodHMgaW4gdGhlIGZyYW1lLCBpZ25vcmluZyBzb21lLmApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgdXNlZExpZ2h0cy5sZW5ndGggPSBsaWdodEluZGV4O1xuICAgIH1cblxuICAgIC8vIGV2YWx1YXRlIHRoZSBhcmVhIGFsbCBsaWdodHMgY292ZXJcbiAgICBldmFsdWF0ZUJvdW5kcygpIHtcblxuICAgICAgICBjb25zdCB1c2VkTGlnaHRzID0gdGhpcy5fdXNlZExpZ2h0cztcblxuICAgICAgICAvLyBib3VuZHMgb2YgdGhlIGFyZWEgdGhlIGxpZ2h0cyBjb3ZlclxuICAgICAgICBjb25zdCBtaW4gPSB0aGlzLmJvdW5kc01pbjtcbiAgICAgICAgY29uc3QgbWF4ID0gdGhpcy5ib3VuZHNNYXg7XG5cbiAgICAgICAgLy8gaWYgYXQgbGVhc3Qgb25lIGxpZ2h0IChpbmRleCAwIGlzIG51bGwsIHNvIGlnbm9yZSB0aGF0IG9uZSlcbiAgICAgICAgaWYgKHVzZWRMaWdodHMubGVuZ3RoID4gMSkge1xuXG4gICAgICAgICAgICAvLyBBQUJCIG9mIHRoZSBmaXJzdCBsaWdodFxuICAgICAgICAgICAgbWluLmNvcHkodXNlZExpZ2h0c1sxXS5taW4pO1xuICAgICAgICAgICAgbWF4LmNvcHkodXNlZExpZ2h0c1sxXS5tYXgpO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMjsgaSA8IHVzZWRMaWdodHMubGVuZ3RoOyBpKyspIHtcblxuICAgICAgICAgICAgICAgIC8vIGV4cGFuZCBieSBBQUJCIG9mIHRoaXMgbGlnaHRcbiAgICAgICAgICAgICAgICBtaW4ubWluKHVzZWRMaWdodHNbaV0ubWluKTtcbiAgICAgICAgICAgICAgICBtYXgubWF4KHVzZWRMaWdodHNbaV0ubWF4KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgLy8gYW55IHNtYWxsIHZvbHVtZSBpZiBubyBsaWdodHNcbiAgICAgICAgICAgIG1pbi5zZXQoMCwgMCwgMCk7XG4gICAgICAgICAgICBtYXguc2V0KDEsIDEsIDEpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gYm91bmRzIHJhbmdlXG4gICAgICAgIHRoaXMuYm91bmRzRGVsdGEuc3ViMihtYXgsIG1pbik7XG5cbiAgICAgICAgdGhpcy5saWdodHNCdWZmZXIuc2V0Qm91bmRzKG1pbiwgdGhpcy5ib3VuZHNEZWx0YSk7XG4gICAgfVxuXG4gICAgLy8gZXZhbHVhdGUgcmFuZ2VzIG9mIHZhcmlhYmxlcyBjb21wcmVzc2VkIHRvIDhiaXQgdGV4dHVyZSB0byBhbGxvdyB0aGVpciBzY2FsaW5nIHRvIDAuLjEgcmFuZ2VcbiAgICBldmFsdWF0ZUNvbXByZXNzaW9uTGltaXRzKGdhbW1hQ29ycmVjdGlvbikge1xuXG4gICAgICAgIGxldCBtYXhBdHRlbnVhdGlvbiA9IDA7XG4gICAgICAgIGxldCBtYXhDb2xvclZhbHVlID0gMDtcblxuICAgICAgICBjb25zdCB1c2VkTGlnaHRzID0gdGhpcy5fdXNlZExpZ2h0cztcbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCB1c2VkTGlnaHRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBsaWdodCA9IHVzZWRMaWdodHNbaV0ubGlnaHQ7XG4gICAgICAgICAgICBtYXhBdHRlbnVhdGlvbiA9IE1hdGgubWF4KGxpZ2h0LmF0dGVudWF0aW9uRW5kLCBtYXhBdHRlbnVhdGlvbik7XG5cbiAgICAgICAgICAgIGNvbnN0IGNvbG9yID0gZ2FtbWFDb3JyZWN0aW9uID8gbGlnaHQuX2xpbmVhckZpbmFsQ29sb3IgOiBsaWdodC5fZmluYWxDb2xvcjtcbiAgICAgICAgICAgIG1heENvbG9yVmFsdWUgPSBNYXRoLm1heChjb2xvclswXSwgbWF4Q29sb3JWYWx1ZSk7XG4gICAgICAgICAgICBtYXhDb2xvclZhbHVlID0gTWF0aC5tYXgoY29sb3JbMV0sIG1heENvbG9yVmFsdWUpO1xuICAgICAgICAgICAgbWF4Q29sb3JWYWx1ZSA9IE1hdGgubWF4KGNvbG9yWzJdLCBtYXhDb2xvclZhbHVlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGluY3JlYXNlIHNsaWdodGx5IGFzIGNvbXByZXNzaW9uIG5lZWRzIHZhbHVlIDwgMVxuICAgICAgICB0aGlzLl9tYXhBdHRlbnVhdGlvbiA9IG1heEF0dGVudWF0aW9uICsgZXBzaWxvbjtcbiAgICAgICAgdGhpcy5fbWF4Q29sb3JWYWx1ZSA9IG1heENvbG9yVmFsdWUgKyBlcHNpbG9uO1xuXG4gICAgICAgIHRoaXMubGlnaHRzQnVmZmVyLnNldENvbXByZXNzaW9uUmFuZ2VzKHRoaXMuX21heEF0dGVudWF0aW9uLCB0aGlzLl9tYXhDb2xvclZhbHVlKTtcbiAgICB9XG5cbiAgICB1cGRhdGVDbHVzdGVycyhnYW1tYUNvcnJlY3Rpb24pIHtcblxuICAgICAgICAvLyBjbGVhciBjbHVzdGVyc1xuICAgICAgICB0aGlzLmNvdW50cy5maWxsKDApO1xuICAgICAgICB0aGlzLmNsdXN0ZXJzLmZpbGwoMCk7XG5cbiAgICAgICAgLy8gbG9jYWwgYWNjZXNzb3JzXG4gICAgICAgIGNvbnN0IGRpdlggPSB0aGlzLl9jZWxscy54O1xuICAgICAgICBjb25zdCBkaXZaID0gdGhpcy5fY2VsbHMuejtcbiAgICAgICAgY29uc3QgY291bnRzID0gdGhpcy5jb3VudHM7XG4gICAgICAgIGNvbnN0IGxpbWl0ID0gdGhpcy5fbWF4Q2VsbExpZ2h0Q291bnQ7XG4gICAgICAgIGNvbnN0IGNsdXN0ZXJzID0gdGhpcy5jbHVzdGVycztcbiAgICAgICAgY29uc3QgcGl4ZWxzUGVyQ2VsbENvdW50ID0gdGhpcy5fcGl4ZWxzUGVyQ2VsbENvdW50O1xuICAgICAgICBsZXQgdG9vTWFueUxpZ2h0cyA9IGZhbHNlO1xuXG4gICAgICAgIC8vIHN0YXJ0ZWQgZnJvbSBpbmRleCAxLCB6ZXJvIGlzIFwibm8tbGlnaHRcIiBpbmRleFxuICAgICAgICBjb25zdCB1c2VkTGlnaHRzID0gdGhpcy5fdXNlZExpZ2h0cztcbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCB1c2VkTGlnaHRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBjbHVzdGVyZWRMaWdodCA9IHVzZWRMaWdodHNbaV07XG4gICAgICAgICAgICBjb25zdCBsaWdodCA9IGNsdXN0ZXJlZExpZ2h0LmxpZ2h0O1xuXG4gICAgICAgICAgICAvLyBhZGQgbGlnaHQgZGF0YSBpbnRvIHRleHR1cmVzXG4gICAgICAgICAgICB0aGlzLmxpZ2h0c0J1ZmZlci5hZGRMaWdodERhdGEobGlnaHQsIGksIGdhbW1hQ29ycmVjdGlvbik7XG5cbiAgICAgICAgICAgIC8vIGxpZ2h0J3MgYm91bmRzIGluIGNlbGwgc3BhY2VcbiAgICAgICAgICAgIHRoaXMuZXZhbExpZ2h0Q2VsbE1pbk1heChjbHVzdGVyZWRMaWdodCwgdGVtcE1pbjMsIHRlbXBNYXgzKTtcblxuICAgICAgICAgICAgY29uc3QgeFN0YXJ0ID0gdGVtcE1pbjMueDtcbiAgICAgICAgICAgIGNvbnN0IHhFbmQgPSB0ZW1wTWF4My54O1xuICAgICAgICAgICAgY29uc3QgeVN0YXJ0ID0gdGVtcE1pbjMueTtcbiAgICAgICAgICAgIGNvbnN0IHlFbmQgPSB0ZW1wTWF4My55O1xuICAgICAgICAgICAgY29uc3QgelN0YXJ0ID0gdGVtcE1pbjMuejtcbiAgICAgICAgICAgIGNvbnN0IHpFbmQgPSB0ZW1wTWF4My56O1xuXG4gICAgICAgICAgICAvLyBhZGQgdGhlIGxpZ2h0IHRvIHRoZSBjZWxsc1xuICAgICAgICAgICAgZm9yIChsZXQgeCA9IHhTdGFydDsgeCA8PSB4RW5kOyB4KyspIHtcbiAgICAgICAgICAgICAgICBmb3IgKGxldCB6ID0gelN0YXJ0OyB6IDw9IHpFbmQ7IHorKykge1xuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCB5ID0geVN0YXJ0OyB5IDw9IHlFbmQ7IHkrKykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjbHVzdGVySW5kZXggPSB4ICsgZGl2WCAqICh6ICsgeSAqIGRpdlopO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY291bnQgPSBjb3VudHNbY2x1c3RlckluZGV4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb3VudCA8IGxpbWl0KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2x1c3RlcnNbcGl4ZWxzUGVyQ2VsbENvdW50ICogY2x1c3RlckluZGV4ICogNCArIGNvdW50XSA9IGk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY291bnRzW2NsdXN0ZXJJbmRleF0gPSBjb3VudCArIDE7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9vTWFueUxpZ2h0cyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vICNpZiBfREVCVUdcbiAgICAgICAgaWYgKHRvb01hbnlMaWdodHMpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlcG9ydExpbWl0ID0gNTtcbiAgICAgICAgICAgIGlmICh0aGlzLnJlcG9ydENvdW50IDwgcmVwb3J0TGltaXQpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oJ1RvbyBtYW55IGxpZ2h0cyBpbiBsaWdodCBjbHVzdGVyICcgKyB0aGlzLm5hbWUgKyAnLCBwbGVhc2UgYWRqdXN0IHBhcmFtZXRlcnMuJyArXG4gICAgICAgICAgICAgICAgKHRoaXMucmVwb3J0Q291bnQgPT09IHJlcG9ydExpbWl0IC0gMSA/ICcgR2l2aW5nIHVwIG9uIHJlcG9ydGluZyBpdC4nIDogJycpKTtcbiAgICAgICAgICAgICAgICB0aGlzLnJlcG9ydENvdW50Kys7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gI2VuZGlmXG4gICAgfVxuXG4gICAgLy8gaW50ZXJuYWwgdXBkYXRlIG9mIHRoZSBjbHVzdGVyIGRhdGEsIGV4ZWN1dGVzIG9uY2UgcGVyIGZyYW1lXG4gICAgdXBkYXRlKGxpZ2h0cywgZ2FtbWFDb3JyZWN0aW9uLCBsaWdodGluZ1BhcmFtcykge1xuICAgICAgICB0aGlzLnVwZGF0ZVBhcmFtcyhsaWdodGluZ1BhcmFtcyk7XG4gICAgICAgIHRoaXMudXBkYXRlQ2VsbHMoKTtcbiAgICAgICAgdGhpcy5jb2xsZWN0TGlnaHRzKGxpZ2h0cyk7XG4gICAgICAgIHRoaXMuZXZhbHVhdGVCb3VuZHMoKTtcbiAgICAgICAgdGhpcy5ldmFsdWF0ZUNvbXByZXNzaW9uTGltaXRzKGdhbW1hQ29ycmVjdGlvbik7XG4gICAgICAgIHRoaXMudXBkYXRlQ2x1c3RlcnMoZ2FtbWFDb3JyZWN0aW9uKTtcbiAgICAgICAgdGhpcy51cGxvYWRUZXh0dXJlcygpO1xuICAgIH1cblxuICAgIC8vIGNhbGxlZCBvbiBhbHJlYWR5IHVwZGF0ZWQgY2x1c3RlcnMsIGFjdGl2YXRlcyBmb3IgcmVuZGVyaW5nIGJ5IHNldHRpbmcgdXAgdW5pZm9ybXMgLyB0ZXh0dXJlcyBvbiB0aGUgZGV2aWNlXG4gICAgYWN0aXZhdGUoKSB7XG4gICAgICAgIHRoaXMudXBkYXRlVW5pZm9ybXMoKTtcbiAgICB9XG59XG5cbmV4cG9ydCB7IFdvcmxkQ2x1c3RlcnMgfTtcbiJdLCJuYW1lcyI6WyJ0ZW1wVmVjMyIsIlZlYzMiLCJ0ZW1wTWluMyIsInRlbXBNYXgzIiwidGVtcEJveCIsIkJvdW5kaW5nQm94IiwiZXBzaWxvbiIsIm1heFRleHR1cmVTaXplIiwiQ2x1c3RlckxpZ2h0IiwiY29uc3RydWN0b3IiLCJsaWdodCIsIm1pbiIsIm1heCIsIldvcmxkQ2x1c3RlcnMiLCJkZXZpY2UiLCJuYW1lIiwicmVwb3J0Q291bnQiLCJib3VuZHNNaW4iLCJib3VuZHNNYXgiLCJib3VuZHNEZWx0YSIsIl9jZWxscyIsIl9jZWxsc0xpbWl0IiwiY2VsbHMiLCJfbWF4Q2VsbExpZ2h0Q291bnQiLCJfcGl4ZWxzUGVyQ2VsbENvdW50IiwibWF4Q2VsbExpZ2h0Q291bnQiLCJfbWF4QXR0ZW51YXRpb24iLCJfbWF4Q29sb3JWYWx1ZSIsIl91c2VkTGlnaHRzIiwicHVzaCIsImxpZ2h0c0J1ZmZlciIsIkxpZ2h0c0J1ZmZlciIsInJlZ2lzdGVyVW5pZm9ybXMiLCJjb3VudCIsIm1hdGgiLCJyb3VuZFVwIiwiX2NlbGxzRGlydHkiLCJ2YWx1ZSIsImNvcHkiLCJmbG9vciIsImVxdWFscyIsInN1YiIsIk9ORSIsImRlc3Ryb3kiLCJyZWxlYXNlQ2x1c3RlclRleHR1cmUiLCJjbHVzdGVyVGV4dHVyZSIsIl9jbHVzdGVyTWF4Q2VsbHNJZCIsInNjb3BlIiwicmVzb2x2ZSIsIl9jbHVzdGVyV29ybGRUZXh0dXJlSWQiLCJfY2x1c3RlclBpeGVsc1BlckNlbGxJZCIsIl9jbHVzdGVyVGV4dHVyZVNpemVJZCIsIl9jbHVzdGVyVGV4dHVyZVNpemVEYXRhIiwiRmxvYXQzMkFycmF5IiwiX2NsdXN0ZXJCb3VuZHNNaW5JZCIsIl9jbHVzdGVyQm91bmRzTWluRGF0YSIsIl9jbHVzdGVyQm91bmRzRGVsdGFJZCIsIl9jbHVzdGVyQm91bmRzRGVsdGFEYXRhIiwiX2NsdXN0ZXJDZWxsc0NvdW50QnlCb3VuZHNTaXplSWQiLCJfY2x1c3RlckNlbGxzQ291bnRCeUJvdW5kc1NpemVEYXRhIiwiX2NsdXN0ZXJDZWxsc0RvdElkIiwiX2NsdXN0ZXJDZWxsc0RvdERhdGEiLCJfY2x1c3RlckNlbGxzTWF4SWQiLCJfY2x1c3RlckNlbGxzTWF4RGF0YSIsIl9jbHVzdGVyQ29tcHJlc3Npb25MaW1pdDBJZCIsIl9jbHVzdGVyQ29tcHJlc3Npb25MaW1pdDBEYXRhIiwidXBkYXRlUGFyYW1zIiwibGlnaHRpbmdQYXJhbXMiLCJtYXhMaWdodHNQZXJDZWxsIiwiY29va2llc0VuYWJsZWQiLCJzaGFkb3dzRW5hYmxlZCIsImFyZWFMaWdodHNFbmFibGVkIiwidXBkYXRlQ2VsbHMiLCJjeCIsIngiLCJjeSIsInkiLCJjeiIsInoiLCJudW1DZWxscyIsInRvdGFsUGl4ZWxzIiwid2lkdGgiLCJNYXRoIiwiY2VpbCIsInNxcnQiLCJoZWlnaHQiLCJEZWJ1ZyIsImFzc2VydCIsImNsdXN0ZXJzIiwiVWludDhDbGFtcGVkQXJyYXkiLCJjb3VudHMiLCJJbnQzMkFycmF5IiwiY3JlYXRlVGV4dHVyZSIsIlBJWEVMRk9STUFUX1JHQkE4IiwidXBsb2FkVGV4dHVyZXMiLCJsb2NrIiwic2V0IiwidW5sb2NrIiwidXBkYXRlVW5pZm9ybXMiLCJzZXRWYWx1ZSIsImV2YWxMaWdodENlbGxNaW5NYXgiLCJjbHVzdGVyZWRMaWdodCIsImRpdiIsIm11bDIiLCJaRVJPIiwiY29sbGVjdExpZ2h0cyIsImxpZ2h0cyIsIm1heExpZ2h0cyIsInVzZWRMaWdodHMiLCJsaWdodEluZGV4IiwiZm9yRWFjaCIsInJ1bnRpbWVMaWdodCIsIm1hc2siLCJNQVNLX0FGRkVDVF9EWU5BTUlDIiwiTUFTS19BRkZFQ1RfTElHSFRNQVBQRUQiLCJ6ZXJvQW5nbGVTcG90bGlnaHQiLCJ0eXBlIiwiTElHSFRUWVBFX1NQT1QiLCJfb3V0ZXJDb25lQW5nbGUiLCJlbmFibGVkIiwiTElHSFRUWVBFX0RJUkVDVElPTkFMIiwidmlzaWJsZVRoaXNGcmFtZSIsImludGVuc2l0eSIsImxlbmd0aCIsImdldEJvdW5kaW5nQm94IiwiZ2V0TWluIiwiZ2V0TWF4Iiwid2Fybk9uY2UiLCJldmFsdWF0ZUJvdW5kcyIsImkiLCJzdWIyIiwic2V0Qm91bmRzIiwiZXZhbHVhdGVDb21wcmVzc2lvbkxpbWl0cyIsImdhbW1hQ29ycmVjdGlvbiIsIm1heEF0dGVudWF0aW9uIiwibWF4Q29sb3JWYWx1ZSIsImF0dGVudWF0aW9uRW5kIiwiY29sb3IiLCJfbGluZWFyRmluYWxDb2xvciIsIl9maW5hbENvbG9yIiwic2V0Q29tcHJlc3Npb25SYW5nZXMiLCJ1cGRhdGVDbHVzdGVycyIsImZpbGwiLCJkaXZYIiwiZGl2WiIsImxpbWl0IiwicGl4ZWxzUGVyQ2VsbENvdW50IiwidG9vTWFueUxpZ2h0cyIsImFkZExpZ2h0RGF0YSIsInhTdGFydCIsInhFbmQiLCJ5U3RhcnQiLCJ5RW5kIiwielN0YXJ0IiwiekVuZCIsImNsdXN0ZXJJbmRleCIsInJlcG9ydExpbWl0IiwiY29uc29sZSIsIndhcm4iLCJ1cGRhdGUiLCJhY3RpdmF0ZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQVFBLE1BQU1BLFFBQVEsR0FBRyxJQUFJQyxJQUFJLEVBQUUsQ0FBQTtBQUMzQixNQUFNQyxRQUFRLEdBQUcsSUFBSUQsSUFBSSxFQUFFLENBQUE7QUFDM0IsTUFBTUUsUUFBUSxHQUFHLElBQUlGLElBQUksRUFBRSxDQUFBO0FBQzNCLE1BQU1HLE9BQU8sR0FBRyxJQUFJQyxXQUFXLEVBQUUsQ0FBQTtBQUVqQyxNQUFNQyxPQUFPLEdBQUcsUUFBUSxDQUFBO0FBQ3hCLE1BQU1DLGNBQWMsR0FBRyxJQUFJLENBQUE7O0FBRzNCLE1BQU1DLFlBQVksQ0FBQztBQUNmQyxFQUFBQSxXQUFXLEdBQUc7SUFFVixJQUFJLENBQUNDLEtBQUssR0FBRyxJQUFJLENBQUE7O0FBR2pCLElBQUEsSUFBSSxDQUFDQyxHQUFHLEdBQUcsSUFBSVYsSUFBSSxFQUFFLENBQUE7QUFDckIsSUFBQSxJQUFJLENBQUNXLEdBQUcsR0FBRyxJQUFJWCxJQUFJLEVBQUUsQ0FBQTtBQUN6QixHQUFBO0FBQ0osQ0FBQTs7QUFJQSxNQUFNWSxhQUFhLENBQUM7RUFDaEJKLFdBQVcsQ0FBQ0ssTUFBTSxFQUFFO0lBQ2hCLElBQUksQ0FBQ0EsTUFBTSxHQUFHQSxNQUFNLENBQUE7SUFDcEIsSUFBSSxDQUFDQyxJQUFJLEdBQUcsVUFBVSxDQUFBOztJQUd0QixJQUFJLENBQUNDLFdBQVcsR0FBRyxDQUFDLENBQUE7O0FBR3BCLElBQUEsSUFBSSxDQUFDQyxTQUFTLEdBQUcsSUFBSWhCLElBQUksRUFBRSxDQUFBO0FBQzNCLElBQUEsSUFBSSxDQUFDaUIsU0FBUyxHQUFHLElBQUlqQixJQUFJLEVBQUUsQ0FBQTtBQUMzQixJQUFBLElBQUksQ0FBQ2tCLFdBQVcsR0FBRyxJQUFJbEIsSUFBSSxFQUFFLENBQUE7O0lBRzdCLElBQUksQ0FBQ21CLE1BQU0sR0FBRyxJQUFJbkIsSUFBSSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUE7QUFDL0IsSUFBQSxJQUFJLENBQUNvQixXQUFXLEdBQUcsSUFBSXBCLElBQUksRUFBRSxDQUFBO0FBQzdCLElBQUEsSUFBSSxDQUFDcUIsS0FBSyxHQUFHLElBQUksQ0FBQ0YsTUFBTSxDQUFBOztJQUd4QixJQUFJLENBQUNHLGtCQUFrQixHQUFHLENBQUMsQ0FBQTtJQUMzQixJQUFJLENBQUNDLG1CQUFtQixHQUFHLENBQUMsQ0FBQTtJQUM1QixJQUFJLENBQUNDLGlCQUFpQixHQUFHLENBQUMsQ0FBQTs7SUFHMUIsSUFBSSxDQUFDQyxlQUFlLEdBQUcsQ0FBQyxDQUFBO0lBQ3hCLElBQUksQ0FBQ0MsY0FBYyxHQUFHLENBQUMsQ0FBQTs7SUFHdkIsSUFBSSxDQUFDQyxXQUFXLEdBQUcsRUFBRSxDQUFBOztJQUdyQixJQUFJLENBQUNBLFdBQVcsQ0FBQ0MsSUFBSSxDQUFDLElBQUlyQixZQUFZLEVBQUUsQ0FBQyxDQUFBOztBQUd6QyxJQUFBLElBQUksQ0FBQ3NCLFlBQVksR0FBRyxJQUFJQyxZQUFZLENBQUNqQixNQUFNLENBQUMsQ0FBQTs7QUFHNUMsSUFBQSxJQUFJLENBQUNrQixnQkFBZ0IsQ0FBQ2xCLE1BQU0sQ0FBQyxDQUFBO0FBQ2pDLEdBQUE7RUFFQSxJQUFJVyxpQkFBaUIsQ0FBQ1EsS0FBSyxFQUFFO0lBR3pCLE1BQU1SLGlCQUFpQixHQUFHUyxJQUFJLENBQUNDLE9BQU8sQ0FBQ0YsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFBO0FBQ2hELElBQUEsSUFBSVIsaUJBQWlCLEtBQUssSUFBSSxDQUFDRixrQkFBa0IsRUFBRTtNQUMvQyxJQUFJLENBQUNBLGtCQUFrQixHQUFHRSxpQkFBaUIsQ0FBQTtBQUMzQyxNQUFBLElBQUksQ0FBQ0QsbUJBQW1CLEdBQUcsSUFBSSxDQUFDRCxrQkFBa0IsR0FBRyxDQUFDLENBQUE7TUFDdEQsSUFBSSxDQUFDYSxXQUFXLEdBQUcsSUFBSSxDQUFBO0FBQzNCLEtBQUE7QUFDSixHQUFBO0FBRUEsRUFBQSxJQUFJWCxpQkFBaUIsR0FBRztJQUNwQixPQUFPLElBQUksQ0FBQ0Ysa0JBQWtCLENBQUE7QUFDbEMsR0FBQTtFQUVBLElBQUlELEtBQUssQ0FBQ2UsS0FBSyxFQUFFO0FBR2JyQyxJQUFBQSxRQUFRLENBQUNzQyxJQUFJLENBQUNELEtBQUssQ0FBQyxDQUFDRSxLQUFLLEVBQUUsQ0FBQTtJQUU1QixJQUFJLENBQUMsSUFBSSxDQUFDbkIsTUFBTSxDQUFDb0IsTUFBTSxDQUFDeEMsUUFBUSxDQUFDLEVBQUU7QUFDL0IsTUFBQSxJQUFJLENBQUNvQixNQUFNLENBQUNrQixJQUFJLENBQUN0QyxRQUFRLENBQUMsQ0FBQTtBQUMxQixNQUFBLElBQUksQ0FBQ3FCLFdBQVcsQ0FBQ2lCLElBQUksQ0FBQ3RDLFFBQVEsQ0FBQyxDQUFDeUMsR0FBRyxDQUFDeEMsSUFBSSxDQUFDeUMsR0FBRyxDQUFDLENBQUE7TUFDN0MsSUFBSSxDQUFDTixXQUFXLEdBQUcsSUFBSSxDQUFBO0FBQzNCLEtBQUE7QUFDSixHQUFBO0FBRUEsRUFBQSxJQUFJZCxLQUFLLEdBQUc7SUFDUixPQUFPLElBQUksQ0FBQ0YsTUFBTSxDQUFBO0FBQ3RCLEdBQUE7QUFFQXVCLEVBQUFBLE9BQU8sR0FBRztBQUVOLElBQUEsSUFBSSxDQUFDYixZQUFZLENBQUNhLE9BQU8sRUFBRSxDQUFBO0lBRTNCLElBQUksQ0FBQ0MscUJBQXFCLEVBQUUsQ0FBQTtBQUNoQyxHQUFBO0FBRUFBLEVBQUFBLHFCQUFxQixHQUFHO0lBQ3BCLElBQUksSUFBSSxDQUFDQyxjQUFjLEVBQUU7QUFDckIsTUFBQSxJQUFJLENBQUNBLGNBQWMsQ0FBQ0YsT0FBTyxFQUFFLENBQUE7TUFDN0IsSUFBSSxDQUFDRSxjQUFjLEdBQUcsSUFBSSxDQUFBO0FBQzlCLEtBQUE7QUFDSixHQUFBO0VBRUFiLGdCQUFnQixDQUFDbEIsTUFBTSxFQUFFO0lBRXJCLElBQUksQ0FBQ2dDLGtCQUFrQixHQUFHaEMsTUFBTSxDQUFDaUMsS0FBSyxDQUFDQyxPQUFPLENBQUMsaUJBQWlCLENBQUMsQ0FBQTtJQUVqRSxJQUFJLENBQUNDLHNCQUFzQixHQUFHbkMsTUFBTSxDQUFDaUMsS0FBSyxDQUFDQyxPQUFPLENBQUMscUJBQXFCLENBQUMsQ0FBQTtJQUN6RSxJQUFJLENBQUNFLHVCQUF1QixHQUFHcEMsTUFBTSxDQUFDaUMsS0FBSyxDQUFDQyxPQUFPLENBQUMsc0JBQXNCLENBQUMsQ0FBQTtJQUUzRSxJQUFJLENBQUNHLHFCQUFxQixHQUFHckMsTUFBTSxDQUFDaUMsS0FBSyxDQUFDQyxPQUFPLENBQUMsb0JBQW9CLENBQUMsQ0FBQTtBQUN2RSxJQUFBLElBQUksQ0FBQ0ksdUJBQXVCLEdBQUcsSUFBSUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFBO0lBRWxELElBQUksQ0FBQ0MsbUJBQW1CLEdBQUd4QyxNQUFNLENBQUNpQyxLQUFLLENBQUNDLE9BQU8sQ0FBQyxrQkFBa0IsQ0FBQyxDQUFBO0FBQ25FLElBQUEsSUFBSSxDQUFDTyxxQkFBcUIsR0FBRyxJQUFJRixZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUE7SUFFaEQsSUFBSSxDQUFDRyxxQkFBcUIsR0FBRzFDLE1BQU0sQ0FBQ2lDLEtBQUssQ0FBQ0MsT0FBTyxDQUFDLG9CQUFvQixDQUFDLENBQUE7QUFDdkUsSUFBQSxJQUFJLENBQUNTLHVCQUF1QixHQUFHLElBQUlKLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQTtJQUVsRCxJQUFJLENBQUNLLGdDQUFnQyxHQUFHNUMsTUFBTSxDQUFDaUMsS0FBSyxDQUFDQyxPQUFPLENBQUMsK0JBQStCLENBQUMsQ0FBQTtBQUM3RixJQUFBLElBQUksQ0FBQ1csa0NBQWtDLEdBQUcsSUFBSU4sWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFBO0lBRTdELElBQUksQ0FBQ08sa0JBQWtCLEdBQUc5QyxNQUFNLENBQUNpQyxLQUFLLENBQUNDLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxDQUFBO0FBQ2pFLElBQUEsSUFBSSxDQUFDYSxvQkFBb0IsR0FBRyxJQUFJUixZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUE7O0lBRy9DLElBQUksQ0FBQ1Msa0JBQWtCLEdBQUdoRCxNQUFNLENBQUNpQyxLQUFLLENBQUNDLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxDQUFBO0FBQ2pFLElBQUEsSUFBSSxDQUFDZSxvQkFBb0IsR0FBRyxJQUFJVixZQUFZLENBQUMsQ0FBQyxDQUFDLENBQUE7O0lBRy9DLElBQUksQ0FBQ1csMkJBQTJCLEdBQUdsRCxNQUFNLENBQUNpQyxLQUFLLENBQUNDLE9BQU8sQ0FBQywwQkFBMEIsQ0FBQyxDQUFBO0FBQ25GLElBQUEsSUFBSSxDQUFDaUIsNkJBQTZCLEdBQUcsSUFBSVosWUFBWSxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQzVELEdBQUE7O0VBR0FhLFlBQVksQ0FBQ0MsY0FBYyxFQUFFO0FBQ3pCLElBQUEsSUFBSUEsY0FBYyxFQUFFO0FBQ2hCLE1BQUEsSUFBSSxDQUFDN0MsS0FBSyxHQUFHNkMsY0FBYyxDQUFDN0MsS0FBSyxDQUFBO0FBQ2pDLE1BQUEsSUFBSSxDQUFDRyxpQkFBaUIsR0FBRzBDLGNBQWMsQ0FBQ0MsZ0JBQWdCLENBQUE7QUFFeEQsTUFBQSxJQUFJLENBQUN0QyxZQUFZLENBQUN1QyxjQUFjLEdBQUdGLGNBQWMsQ0FBQ0UsY0FBYyxDQUFBO0FBQ2hFLE1BQUEsSUFBSSxDQUFDdkMsWUFBWSxDQUFDd0MsY0FBYyxHQUFHSCxjQUFjLENBQUNHLGNBQWMsQ0FBQTtBQUVoRSxNQUFBLElBQUksQ0FBQ3hDLFlBQVksQ0FBQ3lDLGlCQUFpQixHQUFHSixjQUFjLENBQUNJLGlCQUFpQixDQUFBO0FBQzFFLEtBQUE7QUFDSixHQUFBO0FBRUFDLEVBQUFBLFdBQVcsR0FBRztJQUNWLElBQUksSUFBSSxDQUFDcEMsV0FBVyxFQUFFO01BQ2xCLElBQUksQ0FBQ0EsV0FBVyxHQUFHLEtBQUssQ0FBQTtBQUV4QixNQUFBLE1BQU1xQyxFQUFFLEdBQUcsSUFBSSxDQUFDckQsTUFBTSxDQUFDc0QsQ0FBQyxDQUFBO0FBQ3hCLE1BQUEsTUFBTUMsRUFBRSxHQUFHLElBQUksQ0FBQ3ZELE1BQU0sQ0FBQ3dELENBQUMsQ0FBQTtBQUN4QixNQUFBLE1BQU1DLEVBQUUsR0FBRyxJQUFJLENBQUN6RCxNQUFNLENBQUMwRCxDQUFDLENBQUE7O0FBR3hCLE1BQUEsTUFBTUMsUUFBUSxHQUFHTixFQUFFLEdBQUdFLEVBQUUsR0FBR0UsRUFBRSxDQUFBO0FBQzdCLE1BQUEsTUFBTUcsV0FBVyxHQUFHLElBQUksQ0FBQ3hELG1CQUFtQixHQUFHdUQsUUFBUSxDQUFBOztBQUd2RCxNQUFBLElBQUlFLEtBQUssR0FBR0MsSUFBSSxDQUFDQyxJQUFJLENBQUNELElBQUksQ0FBQ0UsSUFBSSxDQUFDSixXQUFXLENBQUMsQ0FBQyxDQUFBO01BQzdDQyxLQUFLLEdBQUcvQyxJQUFJLENBQUNDLE9BQU8sQ0FBQzhDLEtBQUssRUFBRSxJQUFJLENBQUN6RCxtQkFBbUIsQ0FBQyxDQUFBO01BQ3JELE1BQU02RCxNQUFNLEdBQUdILElBQUksQ0FBQ0MsSUFBSSxDQUFDSCxXQUFXLEdBQUdDLEtBQUssQ0FBQyxDQUFBOztBQUc3Q0ssTUFBQUEsS0FBSyxDQUFDQyxNQUFNLENBQUNOLEtBQUssSUFBSTFFLGNBQWMsSUFBSThFLE1BQU0sSUFBSTlFLGNBQWMsRUFDbkQsOEZBQThGLENBQUMsQ0FBQTs7QUFHNUcsTUFBQSxJQUFJLENBQUN3RCxvQkFBb0IsQ0FBQyxDQUFDLENBQUMsR0FBR1UsRUFBRSxDQUFBO0FBQ2pDLE1BQUEsSUFBSSxDQUFDVixvQkFBb0IsQ0FBQyxDQUFDLENBQUMsR0FBR1ksRUFBRSxDQUFBO0FBQ2pDLE1BQUEsSUFBSSxDQUFDWixvQkFBb0IsQ0FBQyxDQUFDLENBQUMsR0FBR2MsRUFBRSxDQUFBOztNQUdqQyxJQUFJLENBQUNoQixvQkFBb0IsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUNyQyxtQkFBbUIsQ0FBQTtBQUN2RCxNQUFBLElBQUksQ0FBQ3FDLG9CQUFvQixDQUFDLENBQUMsQ0FBQyxHQUFHWSxFQUFFLEdBQUdJLEVBQUUsR0FBRyxJQUFJLENBQUNyRCxtQkFBbUIsQ0FBQTtNQUNqRSxJQUFJLENBQUNxQyxvQkFBb0IsQ0FBQyxDQUFDLENBQUMsR0FBR1ksRUFBRSxHQUFHLElBQUksQ0FBQ2pELG1CQUFtQixDQUFBOztNQUc1RCxJQUFJLENBQUNnRSxRQUFRLEdBQUcsSUFBSUMsaUJBQWlCLENBQUMsQ0FBQyxHQUFHVCxXQUFXLENBQUMsQ0FBQTtBQUN0RCxNQUFBLElBQUksQ0FBQ1UsTUFBTSxHQUFHLElBQUlDLFVBQVUsQ0FBQ1osUUFBUSxDQUFDLENBQUE7QUFFdEMsTUFBQSxJQUFJLENBQUMzQix1QkFBdUIsQ0FBQyxDQUFDLENBQUMsR0FBRzZCLEtBQUssQ0FBQTtNQUN2QyxJQUFJLENBQUM3Qix1QkFBdUIsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLEdBQUc2QixLQUFLLENBQUE7TUFDN0MsSUFBSSxDQUFDN0IsdUJBQXVCLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxHQUFHaUMsTUFBTSxDQUFBO01BRTlDLElBQUksQ0FBQ3pDLHFCQUFxQixFQUFFLENBQUE7QUFDNUIsTUFBQSxJQUFJLENBQUNDLGNBQWMsR0FBR2QsWUFBWSxDQUFDNkQsYUFBYSxDQUFDLElBQUksQ0FBQzlFLE1BQU0sRUFBRW1FLEtBQUssRUFBRUksTUFBTSxFQUFFUSxpQkFBaUIsRUFBRSxnQkFBZ0IsQ0FBQyxDQUFBO0FBQ3JILEtBQUE7QUFDSixHQUFBO0FBRUFDLEVBQUFBLGNBQWMsR0FBRztJQUViLElBQUksQ0FBQ2pELGNBQWMsQ0FBQ2tELElBQUksRUFBRSxDQUFDQyxHQUFHLENBQUMsSUFBSSxDQUFDUixRQUFRLENBQUMsQ0FBQTtBQUM3QyxJQUFBLElBQUksQ0FBQzNDLGNBQWMsQ0FBQ29ELE1BQU0sRUFBRSxDQUFBO0FBRTVCLElBQUEsSUFBSSxDQUFDbkUsWUFBWSxDQUFDZ0UsY0FBYyxFQUFFLENBQUE7QUFDdEMsR0FBQTtBQUVBSSxFQUFBQSxjQUFjLEdBQUc7QUFFYixJQUFBLElBQUksQ0FBQ3BFLFlBQVksQ0FBQ29FLGNBQWMsRUFBRSxDQUFBOztJQUdsQyxJQUFJLENBQUNqRCxzQkFBc0IsQ0FBQ2tELFFBQVEsQ0FBQyxJQUFJLENBQUN0RCxjQUFjLENBQUMsQ0FBQTs7SUFHekQsSUFBSSxDQUFDQyxrQkFBa0IsQ0FBQ3FELFFBQVEsQ0FBQyxJQUFJLENBQUMzRSxtQkFBbUIsQ0FBQyxDQUFBO0FBRTFELElBQUEsTUFBTUwsV0FBVyxHQUFHLElBQUksQ0FBQ0EsV0FBVyxDQUFBO0FBQ3BDLElBQUEsSUFBSSxDQUFDd0Msa0NBQWtDLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDdkMsTUFBTSxDQUFDc0QsQ0FBQyxHQUFHdkQsV0FBVyxDQUFDdUQsQ0FBQyxDQUFBO0FBQzFFLElBQUEsSUFBSSxDQUFDZixrQ0FBa0MsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUN2QyxNQUFNLENBQUN3RCxDQUFDLEdBQUd6RCxXQUFXLENBQUN5RCxDQUFDLENBQUE7QUFDMUUsSUFBQSxJQUFJLENBQUNqQixrQ0FBa0MsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUN2QyxNQUFNLENBQUMwRCxDQUFDLEdBQUczRCxXQUFXLENBQUMyRCxDQUFDLENBQUE7SUFDMUUsSUFBSSxDQUFDcEIsZ0NBQWdDLENBQUN5QyxRQUFRLENBQUMsSUFBSSxDQUFDeEMsa0NBQWtDLENBQUMsQ0FBQTtJQUV2RixJQUFJLENBQUNKLHFCQUFxQixDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQ3RDLFNBQVMsQ0FBQ3lELENBQUMsQ0FBQTtJQUNoRCxJQUFJLENBQUNuQixxQkFBcUIsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUN0QyxTQUFTLENBQUMyRCxDQUFDLENBQUE7SUFDaEQsSUFBSSxDQUFDckIscUJBQXFCLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDdEMsU0FBUyxDQUFDNkQsQ0FBQyxDQUFBO0lBRWhELElBQUksQ0FBQ3JCLHVCQUF1QixDQUFDLENBQUMsQ0FBQyxHQUFHdEMsV0FBVyxDQUFDdUQsQ0FBQyxDQUFBO0lBQy9DLElBQUksQ0FBQ2pCLHVCQUF1QixDQUFDLENBQUMsQ0FBQyxHQUFHdEMsV0FBVyxDQUFDeUQsQ0FBQyxDQUFBO0lBQy9DLElBQUksQ0FBQ25CLHVCQUF1QixDQUFDLENBQUMsQ0FBQyxHQUFHdEMsV0FBVyxDQUFDMkQsQ0FBQyxDQUFBO0lBRS9DLElBQUksQ0FBQ2IsNkJBQTZCLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDdkMsZUFBZSxDQUFBO0lBQzVELElBQUksQ0FBQ3VDLDZCQUE2QixDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQ3RDLGNBQWMsQ0FBQTs7SUFHM0QsSUFBSSxDQUFDdUIsdUJBQXVCLENBQUNpRCxRQUFRLENBQUMsSUFBSSxDQUFDM0UsbUJBQW1CLENBQUMsQ0FBQTtJQUMvRCxJQUFJLENBQUMyQixxQkFBcUIsQ0FBQ2dELFFBQVEsQ0FBQyxJQUFJLENBQUMvQyx1QkFBdUIsQ0FBQyxDQUFBO0lBQ2pFLElBQUksQ0FBQ0UsbUJBQW1CLENBQUM2QyxRQUFRLENBQUMsSUFBSSxDQUFDNUMscUJBQXFCLENBQUMsQ0FBQTtJQUM3RCxJQUFJLENBQUNDLHFCQUFxQixDQUFDMkMsUUFBUSxDQUFDLElBQUksQ0FBQzFDLHVCQUF1QixDQUFDLENBQUE7SUFDakUsSUFBSSxDQUFDRyxrQkFBa0IsQ0FBQ3VDLFFBQVEsQ0FBQyxJQUFJLENBQUN0QyxvQkFBb0IsQ0FBQyxDQUFBO0lBQzNELElBQUksQ0FBQ0Msa0JBQWtCLENBQUNxQyxRQUFRLENBQUMsSUFBSSxDQUFDcEMsb0JBQW9CLENBQUMsQ0FBQTtJQUMzRCxJQUFJLENBQUNDLDJCQUEyQixDQUFDbUMsUUFBUSxDQUFDLElBQUksQ0FBQ2xDLDZCQUE2QixDQUFDLENBQUE7QUFDakYsR0FBQTs7QUFHQW1DLEVBQUFBLG1CQUFtQixDQUFDQyxjQUFjLEVBQUUxRixHQUFHLEVBQUVDLEdBQUcsRUFBRTtBQUcxQ0QsSUFBQUEsR0FBRyxDQUFDMkIsSUFBSSxDQUFDK0QsY0FBYyxDQUFDMUYsR0FBRyxDQUFDLENBQUE7QUFDNUJBLElBQUFBLEdBQUcsQ0FBQzhCLEdBQUcsQ0FBQyxJQUFJLENBQUN4QixTQUFTLENBQUMsQ0FBQTtBQUN2Qk4sSUFBQUEsR0FBRyxDQUFDMkYsR0FBRyxDQUFDLElBQUksQ0FBQ25GLFdBQVcsQ0FBQyxDQUFBO0lBQ3pCUixHQUFHLENBQUM0RixJQUFJLENBQUM1RixHQUFHLEVBQUUsSUFBSSxDQUFDVyxLQUFLLENBQUMsQ0FBQTtJQUN6QlgsR0FBRyxDQUFDNEIsS0FBSyxFQUFFLENBQUE7O0FBR1gzQixJQUFBQSxHQUFHLENBQUMwQixJQUFJLENBQUMrRCxjQUFjLENBQUN6RixHQUFHLENBQUMsQ0FBQTtBQUM1QkEsSUFBQUEsR0FBRyxDQUFDNkIsR0FBRyxDQUFDLElBQUksQ0FBQ3hCLFNBQVMsQ0FBQyxDQUFBO0FBQ3ZCTCxJQUFBQSxHQUFHLENBQUMwRixHQUFHLENBQUMsSUFBSSxDQUFDbkYsV0FBVyxDQUFDLENBQUE7SUFDekJQLEdBQUcsQ0FBQzJGLElBQUksQ0FBQzNGLEdBQUcsRUFBRSxJQUFJLENBQUNVLEtBQUssQ0FBQyxDQUFBO0lBQ3pCVixHQUFHLENBQUN1RSxJQUFJLEVBQUUsQ0FBQTs7QUFHVnhFLElBQUFBLEdBQUcsQ0FBQ0MsR0FBRyxDQUFDWCxJQUFJLENBQUN1RyxJQUFJLENBQUMsQ0FBQTtBQUNsQjVGLElBQUFBLEdBQUcsQ0FBQ0QsR0FBRyxDQUFDLElBQUksQ0FBQ1UsV0FBVyxDQUFDLENBQUE7QUFDN0IsR0FBQTtFQUVBb0YsYUFBYSxDQUFDQyxNQUFNLEVBQUU7QUFFbEIsSUFBQSxNQUFNQyxTQUFTLEdBQUcsSUFBSSxDQUFDN0UsWUFBWSxDQUFDNkUsU0FBUyxDQUFBOztBQUc3QyxJQUFBLE1BQU1DLFVBQVUsR0FBRyxJQUFJLENBQUNoRixXQUFXLENBQUE7SUFDbkMsSUFBSWlGLFVBQVUsR0FBRyxDQUFDLENBQUE7QUFFbEJILElBQUFBLE1BQU0sQ0FBQ0ksT0FBTyxDQUFFcEcsS0FBSyxJQUFLO0FBQ3RCLE1BQUEsTUFBTXFHLFlBQVksR0FBRyxDQUFDLEVBQUVyRyxLQUFLLENBQUNzRyxJQUFJLElBQUlDLG1CQUFtQixHQUFHQyx1QkFBdUIsQ0FBQyxDQUFDLENBQUE7QUFDckYsTUFBQSxNQUFNQyxrQkFBa0IsR0FBR3pHLEtBQUssQ0FBQzBHLElBQUksS0FBS0MsY0FBYyxJQUFJM0csS0FBSyxDQUFDNEcsZUFBZSxLQUFLLENBQUMsQ0FBQTtNQUN2RixJQUFJNUcsS0FBSyxDQUFDNkcsT0FBTyxJQUFJN0csS0FBSyxDQUFDMEcsSUFBSSxLQUFLSSxxQkFBcUIsSUFBSTlHLEtBQUssQ0FBQytHLGdCQUFnQixJQUFJL0csS0FBSyxDQUFDZ0gsU0FBUyxHQUFHLENBQUMsSUFBSVgsWUFBWSxJQUFJLENBQUNJLGtCQUFrQixFQUFFO1FBRy9JLElBQUlOLFVBQVUsR0FBR0YsU0FBUyxFQUFFO0FBR3hCLFVBQUEsSUFBSU4sY0FBYyxDQUFBO0FBQ2xCLFVBQUEsSUFBSVEsVUFBVSxHQUFHRCxVQUFVLENBQUNlLE1BQU0sRUFBRTtBQUNoQ3RCLFlBQUFBLGNBQWMsR0FBR08sVUFBVSxDQUFDQyxVQUFVLENBQUMsQ0FBQTtBQUMzQyxXQUFDLE1BQU07WUFFSFIsY0FBYyxHQUFHLElBQUk3RixZQUFZLEVBQUUsQ0FBQTtBQUNuQ29HLFlBQUFBLFVBQVUsQ0FBQy9FLElBQUksQ0FBQ3dFLGNBQWMsQ0FBQyxDQUFBO0FBQ25DLFdBQUE7O1VBR0FBLGNBQWMsQ0FBQzNGLEtBQUssR0FBR0EsS0FBSyxDQUFBO0FBQzVCQSxVQUFBQSxLQUFLLENBQUNrSCxjQUFjLENBQUN4SCxPQUFPLENBQUMsQ0FBQTtVQUM3QmlHLGNBQWMsQ0FBQzFGLEdBQUcsQ0FBQzJCLElBQUksQ0FBQ2xDLE9BQU8sQ0FBQ3lILE1BQU0sRUFBRSxDQUFDLENBQUE7VUFDekN4QixjQUFjLENBQUN6RixHQUFHLENBQUMwQixJQUFJLENBQUNsQyxPQUFPLENBQUMwSCxNQUFNLEVBQUUsQ0FBQyxDQUFBO0FBRXpDakIsVUFBQUEsVUFBVSxFQUFFLENBQUE7QUFDaEIsU0FBQyxNQUFNO1VBQ0h2QixLQUFLLENBQUN5QyxRQUFRLENBQUUsQ0FBQSw4QkFBQSxFQUFnQ3BCLFNBQVMsR0FBRyxDQUFFLHNDQUFxQyxDQUFDLENBQUE7QUFDeEcsU0FBQTtBQUNKLE9BQUE7QUFDSixLQUFDLENBQUMsQ0FBQTtJQUVGQyxVQUFVLENBQUNlLE1BQU0sR0FBR2QsVUFBVSxDQUFBO0FBQ2xDLEdBQUE7O0FBR0FtQixFQUFBQSxjQUFjLEdBQUc7QUFFYixJQUFBLE1BQU1wQixVQUFVLEdBQUcsSUFBSSxDQUFDaEYsV0FBVyxDQUFBOztBQUduQyxJQUFBLE1BQU1qQixHQUFHLEdBQUcsSUFBSSxDQUFDTSxTQUFTLENBQUE7QUFDMUIsSUFBQSxNQUFNTCxHQUFHLEdBQUcsSUFBSSxDQUFDTSxTQUFTLENBQUE7O0FBRzFCLElBQUEsSUFBSTBGLFVBQVUsQ0FBQ2UsTUFBTSxHQUFHLENBQUMsRUFBRTtNQUd2QmhILEdBQUcsQ0FBQzJCLElBQUksQ0FBQ3NFLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQ2pHLEdBQUcsQ0FBQyxDQUFBO01BQzNCQyxHQUFHLENBQUMwQixJQUFJLENBQUNzRSxVQUFVLENBQUMsQ0FBQyxDQUFDLENBQUNoRyxHQUFHLENBQUMsQ0FBQTtBQUUzQixNQUFBLEtBQUssSUFBSXFILENBQUMsR0FBRyxDQUFDLEVBQUVBLENBQUMsR0FBR3JCLFVBQVUsQ0FBQ2UsTUFBTSxFQUFFTSxDQUFDLEVBQUUsRUFBRTtRQUd4Q3RILEdBQUcsQ0FBQ0EsR0FBRyxDQUFDaUcsVUFBVSxDQUFDcUIsQ0FBQyxDQUFDLENBQUN0SCxHQUFHLENBQUMsQ0FBQTtRQUMxQkMsR0FBRyxDQUFDQSxHQUFHLENBQUNnRyxVQUFVLENBQUNxQixDQUFDLENBQUMsQ0FBQ3JILEdBQUcsQ0FBQyxDQUFBO0FBQzlCLE9BQUE7QUFDSixLQUFDLE1BQU07TUFHSEQsR0FBRyxDQUFDcUYsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUE7TUFDaEJwRixHQUFHLENBQUNvRixHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQTtBQUNwQixLQUFBOztJQUdBLElBQUksQ0FBQzdFLFdBQVcsQ0FBQytHLElBQUksQ0FBQ3RILEdBQUcsRUFBRUQsR0FBRyxDQUFDLENBQUE7SUFFL0IsSUFBSSxDQUFDbUIsWUFBWSxDQUFDcUcsU0FBUyxDQUFDeEgsR0FBRyxFQUFFLElBQUksQ0FBQ1EsV0FBVyxDQUFDLENBQUE7QUFDdEQsR0FBQTs7RUFHQWlILHlCQUF5QixDQUFDQyxlQUFlLEVBQUU7SUFFdkMsSUFBSUMsY0FBYyxHQUFHLENBQUMsQ0FBQTtJQUN0QixJQUFJQyxhQUFhLEdBQUcsQ0FBQyxDQUFBO0FBRXJCLElBQUEsTUFBTTNCLFVBQVUsR0FBRyxJQUFJLENBQUNoRixXQUFXLENBQUE7QUFDbkMsSUFBQSxLQUFLLElBQUlxRyxDQUFDLEdBQUcsQ0FBQyxFQUFFQSxDQUFDLEdBQUdyQixVQUFVLENBQUNlLE1BQU0sRUFBRU0sQ0FBQyxFQUFFLEVBQUU7QUFDeEMsTUFBQSxNQUFNdkgsS0FBSyxHQUFHa0csVUFBVSxDQUFDcUIsQ0FBQyxDQUFDLENBQUN2SCxLQUFLLENBQUE7TUFDakM0SCxjQUFjLEdBQUdwRCxJQUFJLENBQUN0RSxHQUFHLENBQUNGLEtBQUssQ0FBQzhILGNBQWMsRUFBRUYsY0FBYyxDQUFDLENBQUE7TUFFL0QsTUFBTUcsS0FBSyxHQUFHSixlQUFlLEdBQUczSCxLQUFLLENBQUNnSSxpQkFBaUIsR0FBR2hJLEtBQUssQ0FBQ2lJLFdBQVcsQ0FBQTtNQUMzRUosYUFBYSxHQUFHckQsSUFBSSxDQUFDdEUsR0FBRyxDQUFDNkgsS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFFRixhQUFhLENBQUMsQ0FBQTtNQUNqREEsYUFBYSxHQUFHckQsSUFBSSxDQUFDdEUsR0FBRyxDQUFDNkgsS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFFRixhQUFhLENBQUMsQ0FBQTtNQUNqREEsYUFBYSxHQUFHckQsSUFBSSxDQUFDdEUsR0FBRyxDQUFDNkgsS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFFRixhQUFhLENBQUMsQ0FBQTtBQUNyRCxLQUFBOztBQUdBLElBQUEsSUFBSSxDQUFDN0csZUFBZSxHQUFHNEcsY0FBYyxHQUFHaEksT0FBTyxDQUFBO0FBQy9DLElBQUEsSUFBSSxDQUFDcUIsY0FBYyxHQUFHNEcsYUFBYSxHQUFHakksT0FBTyxDQUFBO0FBRTdDLElBQUEsSUFBSSxDQUFDd0IsWUFBWSxDQUFDOEcsb0JBQW9CLENBQUMsSUFBSSxDQUFDbEgsZUFBZSxFQUFFLElBQUksQ0FBQ0MsY0FBYyxDQUFDLENBQUE7QUFDckYsR0FBQTtFQUVBa0gsY0FBYyxDQUFDUixlQUFlLEVBQUU7QUFHNUIsSUFBQSxJQUFJLENBQUMzQyxNQUFNLENBQUNvRCxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUE7QUFDbkIsSUFBQSxJQUFJLENBQUN0RCxRQUFRLENBQUNzRCxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUE7O0FBR3JCLElBQUEsTUFBTUMsSUFBSSxHQUFHLElBQUksQ0FBQzNILE1BQU0sQ0FBQ3NELENBQUMsQ0FBQTtBQUMxQixJQUFBLE1BQU1zRSxJQUFJLEdBQUcsSUFBSSxDQUFDNUgsTUFBTSxDQUFDMEQsQ0FBQyxDQUFBO0FBQzFCLElBQUEsTUFBTVksTUFBTSxHQUFHLElBQUksQ0FBQ0EsTUFBTSxDQUFBO0FBQzFCLElBQUEsTUFBTXVELEtBQUssR0FBRyxJQUFJLENBQUMxSCxrQkFBa0IsQ0FBQTtBQUNyQyxJQUFBLE1BQU1pRSxRQUFRLEdBQUcsSUFBSSxDQUFDQSxRQUFRLENBQUE7QUFDOUIsSUFBQSxNQUFNMEQsa0JBQWtCLEdBQUcsSUFBSSxDQUFDMUgsbUJBQW1CLENBQUE7SUFDbkQsSUFBSTJILGFBQWEsR0FBRyxLQUFLLENBQUE7O0FBR3pCLElBQUEsTUFBTXZDLFVBQVUsR0FBRyxJQUFJLENBQUNoRixXQUFXLENBQUE7QUFDbkMsSUFBQSxLQUFLLElBQUlxRyxDQUFDLEdBQUcsQ0FBQyxFQUFFQSxDQUFDLEdBQUdyQixVQUFVLENBQUNlLE1BQU0sRUFBRU0sQ0FBQyxFQUFFLEVBQUU7QUFDeEMsTUFBQSxNQUFNNUIsY0FBYyxHQUFHTyxVQUFVLENBQUNxQixDQUFDLENBQUMsQ0FBQTtBQUNwQyxNQUFBLE1BQU12SCxLQUFLLEdBQUcyRixjQUFjLENBQUMzRixLQUFLLENBQUE7O01BR2xDLElBQUksQ0FBQ29CLFlBQVksQ0FBQ3NILFlBQVksQ0FBQzFJLEtBQUssRUFBRXVILENBQUMsRUFBRUksZUFBZSxDQUFDLENBQUE7O01BR3pELElBQUksQ0FBQ2pDLG1CQUFtQixDQUFDQyxjQUFjLEVBQUVuRyxRQUFRLEVBQUVDLFFBQVEsQ0FBQyxDQUFBO0FBRTVELE1BQUEsTUFBTWtKLE1BQU0sR0FBR25KLFFBQVEsQ0FBQ3dFLENBQUMsQ0FBQTtBQUN6QixNQUFBLE1BQU00RSxJQUFJLEdBQUduSixRQUFRLENBQUN1RSxDQUFDLENBQUE7QUFDdkIsTUFBQSxNQUFNNkUsTUFBTSxHQUFHckosUUFBUSxDQUFDMEUsQ0FBQyxDQUFBO0FBQ3pCLE1BQUEsTUFBTTRFLElBQUksR0FBR3JKLFFBQVEsQ0FBQ3lFLENBQUMsQ0FBQTtBQUN2QixNQUFBLE1BQU02RSxNQUFNLEdBQUd2SixRQUFRLENBQUM0RSxDQUFDLENBQUE7QUFDekIsTUFBQSxNQUFNNEUsSUFBSSxHQUFHdkosUUFBUSxDQUFDMkUsQ0FBQyxDQUFBOztNQUd2QixLQUFLLElBQUlKLENBQUMsR0FBRzJFLE1BQU0sRUFBRTNFLENBQUMsSUFBSTRFLElBQUksRUFBRTVFLENBQUMsRUFBRSxFQUFFO1FBQ2pDLEtBQUssSUFBSUksQ0FBQyxHQUFHMkUsTUFBTSxFQUFFM0UsQ0FBQyxJQUFJNEUsSUFBSSxFQUFFNUUsQ0FBQyxFQUFFLEVBQUU7VUFDakMsS0FBSyxJQUFJRixDQUFDLEdBQUcyRSxNQUFNLEVBQUUzRSxDQUFDLElBQUk0RSxJQUFJLEVBQUU1RSxDQUFDLEVBQUUsRUFBRTtZQUVqQyxNQUFNK0UsWUFBWSxHQUFHakYsQ0FBQyxHQUFHcUUsSUFBSSxJQUFJakUsQ0FBQyxHQUFHRixDQUFDLEdBQUdvRSxJQUFJLENBQUMsQ0FBQTtBQUM5QyxZQUFBLE1BQU0vRyxLQUFLLEdBQUd5RCxNQUFNLENBQUNpRSxZQUFZLENBQUMsQ0FBQTtZQUNsQyxJQUFJMUgsS0FBSyxHQUFHZ0gsS0FBSyxFQUFFO2NBQ2Z6RCxRQUFRLENBQUMwRCxrQkFBa0IsR0FBR1MsWUFBWSxHQUFHLENBQUMsR0FBRzFILEtBQUssQ0FBQyxHQUFHZ0csQ0FBQyxDQUFBO0FBQzNEdkMsY0FBQUEsTUFBTSxDQUFDaUUsWUFBWSxDQUFDLEdBQUcxSCxLQUFLLEdBQUcsQ0FBQyxDQUFBO0FBRXBDLGFBQUMsTUFBTTtBQUNIa0gsY0FBQUEsYUFBYSxHQUFHLElBQUksQ0FBQTtBQUN4QixhQUFBO0FBRUosV0FBQTtBQUNKLFNBQUE7QUFDSixPQUFBO0FBQ0osS0FBQTtBQUdBLElBQUEsSUFBSUEsYUFBYSxFQUFFO01BQ2YsTUFBTVMsV0FBVyxHQUFHLENBQUMsQ0FBQTtBQUNyQixNQUFBLElBQUksSUFBSSxDQUFDNUksV0FBVyxHQUFHNEksV0FBVyxFQUFFO1FBQ2hDQyxPQUFPLENBQUNDLElBQUksQ0FBQyxtQ0FBbUMsR0FBRyxJQUFJLENBQUMvSSxJQUFJLEdBQUcsNkJBQTZCLElBQzNGLElBQUksQ0FBQ0MsV0FBVyxLQUFLNEksV0FBVyxHQUFHLENBQUMsR0FBRyw2QkFBNkIsR0FBRyxFQUFFLENBQUMsQ0FBQyxDQUFBO1FBQzVFLElBQUksQ0FBQzVJLFdBQVcsRUFBRSxDQUFBO0FBQ3RCLE9BQUE7QUFDSixLQUFBO0FBRUosR0FBQTs7QUFHQStJLEVBQUFBLE1BQU0sQ0FBQ3JELE1BQU0sRUFBRTJCLGVBQWUsRUFBRWxFLGNBQWMsRUFBRTtBQUM1QyxJQUFBLElBQUksQ0FBQ0QsWUFBWSxDQUFDQyxjQUFjLENBQUMsQ0FBQTtJQUNqQyxJQUFJLENBQUNLLFdBQVcsRUFBRSxDQUFBO0FBQ2xCLElBQUEsSUFBSSxDQUFDaUMsYUFBYSxDQUFDQyxNQUFNLENBQUMsQ0FBQTtJQUMxQixJQUFJLENBQUNzQixjQUFjLEVBQUUsQ0FBQTtBQUNyQixJQUFBLElBQUksQ0FBQ0kseUJBQXlCLENBQUNDLGVBQWUsQ0FBQyxDQUFBO0FBQy9DLElBQUEsSUFBSSxDQUFDUSxjQUFjLENBQUNSLGVBQWUsQ0FBQyxDQUFBO0lBQ3BDLElBQUksQ0FBQ3ZDLGNBQWMsRUFBRSxDQUFBO0FBQ3pCLEdBQUE7O0FBR0FrRSxFQUFBQSxRQUFRLEdBQUc7SUFDUCxJQUFJLENBQUM5RCxjQUFjLEVBQUUsQ0FBQTtBQUN6QixHQUFBO0FBQ0o7Ozs7In0=
