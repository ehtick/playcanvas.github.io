/**
 * @license
 * PlayCanvas Engine v1.62.0-dev revision 7d088032c (DEBUG PROFILER)
 * Copyright 2011-2023 PlayCanvas Ltd. All rights reserved.
 */
import { Vec4 } from '../../core/math/vec4.js';
import { Mat4 } from '../../core/math/mat4.js';
import { PIXELFORMAT_RGBA8, FILTER_NEAREST, ADDRESS_CLAMP_TO_EDGE } from '../../platform/graphics/constants.js';
import { DebugGraphics } from '../../platform/graphics/debug-graphics.js';
import { drawQuadWithShader } from '../graphics/quad-render-utils.js';
import { Texture } from '../../platform/graphics/texture.js';
import { LIGHTTYPE_OMNI } from '../constants.js';
import { createShaderFromCode } from '../shader-lib/utils.js';
import { LightCamera } from './light-camera.js';

const textureBlitVertexShader = `
    attribute vec2 vertex_position;
    varying vec2 uv0;
    void main(void) {
        gl_Position = vec4(vertex_position, 0.5, 1.0);
        uv0 = vertex_position.xy * 0.5 + 0.5;
    }`;
const textureBlitFragmentShader = `
    varying vec2 uv0;
    uniform sampler2D blitTexture;
    void main(void) {
        gl_FragColor = texture2D(blitTexture, uv0);
    }`;

// shader runs for each face, with inViewProj matrix representing a face camera
const textureCubeBlitFragmentShader = `
    varying vec2 uv0;
    uniform samplerCube blitTexture;
    uniform mat4 invViewProj;
    void main(void) {
        vec4 projPos = vec4(uv0 * 2.0 - 1.0, 0.5, 1.0);
        vec4 worldPos = invViewProj * projPos;
        gl_FragColor = textureCube(blitTexture, worldPos.xyz);
    }`;
const _viewport = new Vec4();

// helper class used by clustered lighting system to render cookies into the texture atlas, similarly to shadow renderer
class CookieRenderer {
  constructor(device, lightTextureAtlas) {
    this.device = device;
    this.lightTextureAtlas = lightTextureAtlas;
    this.blitShader2d = null;
    this.blitShaderCube = null;
    this.blitTextureId = null;
    this.invViewProjId = null;
  }
  destroy() {}
  getShader(shader, fragment) {
    if (!this[shader]) this[shader] = createShaderFromCode(this.device, textureBlitVertexShader, fragment, `cookie_renderer_${shader}`);
    if (!this.blitTextureId) this.blitTextureId = this.device.scope.resolve('blitTexture');
    if (!this.invViewProjId) this.invViewProjId = this.device.scope.resolve('invViewProj');
    return this[shader];
  }
  get shader2d() {
    return this.getShader('blitShader2d', textureBlitFragmentShader);
  }
  get shaderCube() {
    return this.getShader('blitShaderCube', textureCubeBlitFragmentShader);
  }
  static createTexture(device, resolution) {
    const texture = new Texture(device, {
      name: 'CookieAtlas',
      width: resolution,
      height: resolution,
      format: PIXELFORMAT_RGBA8,
      cubemap: false,
      mipmaps: false,
      minFilter: FILTER_NEAREST,
      magFilter: FILTER_NEAREST,
      addressU: ADDRESS_CLAMP_TO_EDGE,
      addressV: ADDRESS_CLAMP_TO_EDGE
    });
    return texture;
  }

  // for rendering of cookies, store inverse view projection matrices for 6 faces, allowing cubemap faces to be copied into the atlas

  initInvViewProjMatrices() {
    if (!CookieRenderer._invViewProjMatrices) {
      CookieRenderer._invViewProjMatrices = [];
      for (let face = 0; face < 6; face++) {
        const camera = LightCamera.create(null, LIGHTTYPE_OMNI, face);
        const projMat = camera.projectionMatrix;
        const viewMat = camera.node.getLocalTransform().clone().invert();
        CookieRenderer._invViewProjMatrices[face] = new Mat4().mul2(projMat, viewMat).invert();
      }
    }
  }
  render(light, renderTarget) {
    if (light.enabled && light.cookie && light.visibleThisFrame) {
      DebugGraphics.pushGpuMarker(this.device, `COOKIE ${light._node.name}`);
      const faceCount = light.numShadowFaces;
      const shader = faceCount > 1 ? this.shaderCube : this.shader2d;
      const device = this.device;
      if (faceCount > 1) {
        this.initInvViewProjMatrices();
      }

      // source texture
      this.blitTextureId.setValue(light.cookie);

      // render it to a viewport of the target
      for (let face = 0; face < faceCount; face++) {
        _viewport.copy(light.atlasViewport);
        if (faceCount > 1) {
          // for cubemap, render to one of the 3x3 sub-areas
          const smallSize = _viewport.z / 3;
          const offset = this.lightTextureAtlas.cubeSlotsOffsets[face];
          _viewport.x += smallSize * offset.x;
          _viewport.y += smallSize * offset.y;
          _viewport.z = smallSize;
          _viewport.w = smallSize;

          // cubemap face projection uniform
          this.invViewProjId.setValue(CookieRenderer._invViewProjMatrices[face].data);
        }
        _viewport.mulScalar(renderTarget.colorBuffer.width);
        drawQuadWithShader(device, renderTarget, shader, _viewport);
      }
      DebugGraphics.popGpuMarker(this.device);
    }
  }
}
CookieRenderer._invViewProjMatrices = null;

export { CookieRenderer };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29va2llLXJlbmRlcmVyLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvc2NlbmUvcmVuZGVyZXIvY29va2llLXJlbmRlcmVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFZlYzQgfSBmcm9tICcuLi8uLi9jb3JlL21hdGgvdmVjNC5qcyc7XG5pbXBvcnQgeyBNYXQ0IH0gZnJvbSAnLi4vLi4vY29yZS9tYXRoL21hdDQuanMnO1xuXG5pbXBvcnQgeyBBRERSRVNTX0NMQU1QX1RPX0VER0UsIEZJTFRFUl9ORUFSRVNULCBQSVhFTEZPUk1BVF9SR0JBOCB9IGZyb20gJy4uLy4uL3BsYXRmb3JtL2dyYXBoaWNzL2NvbnN0YW50cy5qcyc7XG5pbXBvcnQgeyBEZWJ1Z0dyYXBoaWNzIH0gZnJvbSAnLi4vLi4vcGxhdGZvcm0vZ3JhcGhpY3MvZGVidWctZ3JhcGhpY3MuanMnO1xuaW1wb3J0IHsgZHJhd1F1YWRXaXRoU2hhZGVyIH0gZnJvbSAnLi4vZ3JhcGhpY3MvcXVhZC1yZW5kZXItdXRpbHMuanMnO1xuaW1wb3J0IHsgVGV4dHVyZSB9IGZyb20gJy4uLy4uL3BsYXRmb3JtL2dyYXBoaWNzL3RleHR1cmUuanMnO1xuXG5pbXBvcnQgeyBMSUdIVFRZUEVfT01OSSB9IGZyb20gJy4uL2NvbnN0YW50cy5qcyc7XG5pbXBvcnQgeyBjcmVhdGVTaGFkZXJGcm9tQ29kZSB9IGZyb20gJy4uL3NoYWRlci1saWIvdXRpbHMuanMnO1xuaW1wb3J0IHsgTGlnaHRDYW1lcmEgfSBmcm9tICcuL2xpZ2h0LWNhbWVyYS5qcyc7XG5cbmNvbnN0IHRleHR1cmVCbGl0VmVydGV4U2hhZGVyID0gYFxuICAgIGF0dHJpYnV0ZSB2ZWMyIHZlcnRleF9wb3NpdGlvbjtcbiAgICB2YXJ5aW5nIHZlYzIgdXYwO1xuICAgIHZvaWQgbWFpbih2b2lkKSB7XG4gICAgICAgIGdsX1Bvc2l0aW9uID0gdmVjNCh2ZXJ0ZXhfcG9zaXRpb24sIDAuNSwgMS4wKTtcbiAgICAgICAgdXYwID0gdmVydGV4X3Bvc2l0aW9uLnh5ICogMC41ICsgMC41O1xuICAgIH1gO1xuXG5jb25zdCB0ZXh0dXJlQmxpdEZyYWdtZW50U2hhZGVyID0gYFxuICAgIHZhcnlpbmcgdmVjMiB1djA7XG4gICAgdW5pZm9ybSBzYW1wbGVyMkQgYmxpdFRleHR1cmU7XG4gICAgdm9pZCBtYWluKHZvaWQpIHtcbiAgICAgICAgZ2xfRnJhZ0NvbG9yID0gdGV4dHVyZTJEKGJsaXRUZXh0dXJlLCB1djApO1xuICAgIH1gO1xuXG4vLyBzaGFkZXIgcnVucyBmb3IgZWFjaCBmYWNlLCB3aXRoIGluVmlld1Byb2ogbWF0cml4IHJlcHJlc2VudGluZyBhIGZhY2UgY2FtZXJhXG5jb25zdCB0ZXh0dXJlQ3ViZUJsaXRGcmFnbWVudFNoYWRlciA9IGBcbiAgICB2YXJ5aW5nIHZlYzIgdXYwO1xuICAgIHVuaWZvcm0gc2FtcGxlckN1YmUgYmxpdFRleHR1cmU7XG4gICAgdW5pZm9ybSBtYXQ0IGludlZpZXdQcm9qO1xuICAgIHZvaWQgbWFpbih2b2lkKSB7XG4gICAgICAgIHZlYzQgcHJvalBvcyA9IHZlYzQodXYwICogMi4wIC0gMS4wLCAwLjUsIDEuMCk7XG4gICAgICAgIHZlYzQgd29ybGRQb3MgPSBpbnZWaWV3UHJvaiAqIHByb2pQb3M7XG4gICAgICAgIGdsX0ZyYWdDb2xvciA9IHRleHR1cmVDdWJlKGJsaXRUZXh0dXJlLCB3b3JsZFBvcy54eXopO1xuICAgIH1gO1xuXG5jb25zdCBfdmlld3BvcnQgPSBuZXcgVmVjNCgpO1xuXG4vLyBoZWxwZXIgY2xhc3MgdXNlZCBieSBjbHVzdGVyZWQgbGlnaHRpbmcgc3lzdGVtIHRvIHJlbmRlciBjb29raWVzIGludG8gdGhlIHRleHR1cmUgYXRsYXMsIHNpbWlsYXJseSB0byBzaGFkb3cgcmVuZGVyZXJcbmNsYXNzIENvb2tpZVJlbmRlcmVyIHtcbiAgICBjb25zdHJ1Y3RvcihkZXZpY2UsIGxpZ2h0VGV4dHVyZUF0bGFzKSB7XG4gICAgICAgIHRoaXMuZGV2aWNlID0gZGV2aWNlO1xuICAgICAgICB0aGlzLmxpZ2h0VGV4dHVyZUF0bGFzID0gbGlnaHRUZXh0dXJlQXRsYXM7XG5cbiAgICAgICAgdGhpcy5ibGl0U2hhZGVyMmQgPSBudWxsO1xuICAgICAgICB0aGlzLmJsaXRTaGFkZXJDdWJlID0gbnVsbDtcbiAgICAgICAgdGhpcy5ibGl0VGV4dHVyZUlkID0gbnVsbDtcbiAgICAgICAgdGhpcy5pbnZWaWV3UHJvaklkID0gbnVsbDtcbiAgICB9XG5cbiAgICBkZXN0cm95KCkge1xuICAgIH1cblxuICAgIGdldFNoYWRlcihzaGFkZXIsIGZyYWdtZW50KSB7XG5cbiAgICAgICAgaWYgKCF0aGlzW3NoYWRlcl0pXG4gICAgICAgICAgICB0aGlzW3NoYWRlcl0gPSBjcmVhdGVTaGFkZXJGcm9tQ29kZSh0aGlzLmRldmljZSwgdGV4dHVyZUJsaXRWZXJ0ZXhTaGFkZXIsIGZyYWdtZW50LCBgY29va2llX3JlbmRlcmVyXyR7c2hhZGVyfWApO1xuXG4gICAgICAgIGlmICghdGhpcy5ibGl0VGV4dHVyZUlkKVxuICAgICAgICAgICAgdGhpcy5ibGl0VGV4dHVyZUlkID0gdGhpcy5kZXZpY2Uuc2NvcGUucmVzb2x2ZSgnYmxpdFRleHR1cmUnKTtcblxuICAgICAgICBpZiAoIXRoaXMuaW52Vmlld1Byb2pJZClcbiAgICAgICAgICAgIHRoaXMuaW52Vmlld1Byb2pJZCA9IHRoaXMuZGV2aWNlLnNjb3BlLnJlc29sdmUoJ2ludlZpZXdQcm9qJyk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXNbc2hhZGVyXTtcbiAgICB9XG5cbiAgICBnZXQgc2hhZGVyMmQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFNoYWRlcignYmxpdFNoYWRlcjJkJywgdGV4dHVyZUJsaXRGcmFnbWVudFNoYWRlcik7XG4gICAgfVxuXG4gICAgZ2V0IHNoYWRlckN1YmUoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFNoYWRlcignYmxpdFNoYWRlckN1YmUnLCB0ZXh0dXJlQ3ViZUJsaXRGcmFnbWVudFNoYWRlcik7XG4gICAgfVxuXG4gICAgc3RhdGljIGNyZWF0ZVRleHR1cmUoZGV2aWNlLCByZXNvbHV0aW9uKSB7XG5cbiAgICAgICAgY29uc3QgdGV4dHVyZSA9IG5ldyBUZXh0dXJlKGRldmljZSwge1xuICAgICAgICAgICAgbmFtZTogJ0Nvb2tpZUF0bGFzJyxcbiAgICAgICAgICAgIHdpZHRoOiByZXNvbHV0aW9uLFxuICAgICAgICAgICAgaGVpZ2h0OiByZXNvbHV0aW9uLFxuICAgICAgICAgICAgZm9ybWF0OiBQSVhFTEZPUk1BVF9SR0JBOCxcbiAgICAgICAgICAgIGN1YmVtYXA6IGZhbHNlLFxuICAgICAgICAgICAgbWlwbWFwczogZmFsc2UsXG4gICAgICAgICAgICBtaW5GaWx0ZXI6IEZJTFRFUl9ORUFSRVNULFxuICAgICAgICAgICAgbWFnRmlsdGVyOiBGSUxURVJfTkVBUkVTVCxcbiAgICAgICAgICAgIGFkZHJlc3NVOiBBRERSRVNTX0NMQU1QX1RPX0VER0UsXG4gICAgICAgICAgICBhZGRyZXNzVjogQUREUkVTU19DTEFNUF9UT19FREdFXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiB0ZXh0dXJlO1xuICAgIH1cblxuICAgIC8vIGZvciByZW5kZXJpbmcgb2YgY29va2llcywgc3RvcmUgaW52ZXJzZSB2aWV3IHByb2plY3Rpb24gbWF0cmljZXMgZm9yIDYgZmFjZXMsIGFsbG93aW5nIGN1YmVtYXAgZmFjZXMgdG8gYmUgY29waWVkIGludG8gdGhlIGF0bGFzXG4gICAgc3RhdGljIF9pbnZWaWV3UHJvak1hdHJpY2VzID0gbnVsbDtcblxuICAgIGluaXRJbnZWaWV3UHJvak1hdHJpY2VzKCkge1xuICAgICAgICBpZiAoIUNvb2tpZVJlbmRlcmVyLl9pbnZWaWV3UHJvak1hdHJpY2VzKSB7XG4gICAgICAgICAgICBDb29raWVSZW5kZXJlci5faW52Vmlld1Byb2pNYXRyaWNlcyA9IFtdO1xuXG4gICAgICAgICAgICBmb3IgKGxldCBmYWNlID0gMDsgZmFjZSA8IDY7IGZhY2UrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNhbWVyYSA9IExpZ2h0Q2FtZXJhLmNyZWF0ZShudWxsLCBMSUdIVFRZUEVfT01OSSwgZmFjZSk7XG4gICAgICAgICAgICAgICAgY29uc3QgcHJvak1hdCA9IGNhbWVyYS5wcm9qZWN0aW9uTWF0cml4O1xuICAgICAgICAgICAgICAgIGNvbnN0IHZpZXdNYXQgPSBjYW1lcmEubm9kZS5nZXRMb2NhbFRyYW5zZm9ybSgpLmNsb25lKCkuaW52ZXJ0KCk7XG4gICAgICAgICAgICAgICAgQ29va2llUmVuZGVyZXIuX2ludlZpZXdQcm9qTWF0cmljZXNbZmFjZV0gPSBuZXcgTWF0NCgpLm11bDIocHJvak1hdCwgdmlld01hdCkuaW52ZXJ0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZW5kZXIobGlnaHQsIHJlbmRlclRhcmdldCkge1xuXG4gICAgICAgIGlmIChsaWdodC5lbmFibGVkICYmIGxpZ2h0LmNvb2tpZSAmJiBsaWdodC52aXNpYmxlVGhpc0ZyYW1lKSB7XG5cbiAgICAgICAgICAgIERlYnVnR3JhcGhpY3MucHVzaEdwdU1hcmtlcih0aGlzLmRldmljZSwgYENPT0tJRSAke2xpZ2h0Ll9ub2RlLm5hbWV9YCk7XG5cbiAgICAgICAgICAgIGNvbnN0IGZhY2VDb3VudCA9IGxpZ2h0Lm51bVNoYWRvd0ZhY2VzO1xuICAgICAgICAgICAgY29uc3Qgc2hhZGVyID0gZmFjZUNvdW50ID4gMSA/IHRoaXMuc2hhZGVyQ3ViZSA6IHRoaXMuc2hhZGVyMmQ7XG4gICAgICAgICAgICBjb25zdCBkZXZpY2UgPSB0aGlzLmRldmljZTtcblxuICAgICAgICAgICAgaWYgKGZhY2VDb3VudCA+IDEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRJbnZWaWV3UHJvak1hdHJpY2VzKCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIHNvdXJjZSB0ZXh0dXJlXG4gICAgICAgICAgICB0aGlzLmJsaXRUZXh0dXJlSWQuc2V0VmFsdWUobGlnaHQuY29va2llKTtcblxuICAgICAgICAgICAgLy8gcmVuZGVyIGl0IHRvIGEgdmlld3BvcnQgb2YgdGhlIHRhcmdldFxuICAgICAgICAgICAgZm9yIChsZXQgZmFjZSA9IDA7IGZhY2UgPCBmYWNlQ291bnQ7IGZhY2UrKykge1xuXG4gICAgICAgICAgICAgICAgX3ZpZXdwb3J0LmNvcHkobGlnaHQuYXRsYXNWaWV3cG9ydCk7XG5cbiAgICAgICAgICAgICAgICBpZiAoZmFjZUNvdW50ID4gMSkge1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIGZvciBjdWJlbWFwLCByZW5kZXIgdG8gb25lIG9mIHRoZSAzeDMgc3ViLWFyZWFzXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNtYWxsU2l6ZSA9IF92aWV3cG9ydC56IC8gMztcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgb2Zmc2V0ID0gdGhpcy5saWdodFRleHR1cmVBdGxhcy5jdWJlU2xvdHNPZmZzZXRzW2ZhY2VdO1xuICAgICAgICAgICAgICAgICAgICBfdmlld3BvcnQueCArPSBzbWFsbFNpemUgKiBvZmZzZXQueDtcbiAgICAgICAgICAgICAgICAgICAgX3ZpZXdwb3J0LnkgKz0gc21hbGxTaXplICogb2Zmc2V0Lnk7XG4gICAgICAgICAgICAgICAgICAgIF92aWV3cG9ydC56ID0gc21hbGxTaXplO1xuICAgICAgICAgICAgICAgICAgICBfdmlld3BvcnQudyA9IHNtYWxsU2l6ZTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBjdWJlbWFwIGZhY2UgcHJvamVjdGlvbiB1bmlmb3JtXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW52Vmlld1Byb2pJZC5zZXRWYWx1ZShDb29raWVSZW5kZXJlci5faW52Vmlld1Byb2pNYXRyaWNlc1tmYWNlXS5kYXRhKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBfdmlld3BvcnQubXVsU2NhbGFyKHJlbmRlclRhcmdldC5jb2xvckJ1ZmZlci53aWR0aCk7XG4gICAgICAgICAgICAgICAgZHJhd1F1YWRXaXRoU2hhZGVyKGRldmljZSwgcmVuZGVyVGFyZ2V0LCBzaGFkZXIsIF92aWV3cG9ydCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIERlYnVnR3JhcGhpY3MucG9wR3B1TWFya2VyKHRoaXMuZGV2aWNlKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IHsgQ29va2llUmVuZGVyZXIgfTtcbiJdLCJuYW1lcyI6WyJ0ZXh0dXJlQmxpdFZlcnRleFNoYWRlciIsInRleHR1cmVCbGl0RnJhZ21lbnRTaGFkZXIiLCJ0ZXh0dXJlQ3ViZUJsaXRGcmFnbWVudFNoYWRlciIsIl92aWV3cG9ydCIsIlZlYzQiLCJDb29raWVSZW5kZXJlciIsImNvbnN0cnVjdG9yIiwiZGV2aWNlIiwibGlnaHRUZXh0dXJlQXRsYXMiLCJibGl0U2hhZGVyMmQiLCJibGl0U2hhZGVyQ3ViZSIsImJsaXRUZXh0dXJlSWQiLCJpbnZWaWV3UHJvaklkIiwiZGVzdHJveSIsImdldFNoYWRlciIsInNoYWRlciIsImZyYWdtZW50IiwiY3JlYXRlU2hhZGVyRnJvbUNvZGUiLCJzY29wZSIsInJlc29sdmUiLCJzaGFkZXIyZCIsInNoYWRlckN1YmUiLCJjcmVhdGVUZXh0dXJlIiwicmVzb2x1dGlvbiIsInRleHR1cmUiLCJUZXh0dXJlIiwibmFtZSIsIndpZHRoIiwiaGVpZ2h0IiwiZm9ybWF0IiwiUElYRUxGT1JNQVRfUkdCQTgiLCJjdWJlbWFwIiwibWlwbWFwcyIsIm1pbkZpbHRlciIsIkZJTFRFUl9ORUFSRVNUIiwibWFnRmlsdGVyIiwiYWRkcmVzc1UiLCJBRERSRVNTX0NMQU1QX1RPX0VER0UiLCJhZGRyZXNzViIsImluaXRJbnZWaWV3UHJvak1hdHJpY2VzIiwiX2ludlZpZXdQcm9qTWF0cmljZXMiLCJmYWNlIiwiY2FtZXJhIiwiTGlnaHRDYW1lcmEiLCJjcmVhdGUiLCJMSUdIVFRZUEVfT01OSSIsInByb2pNYXQiLCJwcm9qZWN0aW9uTWF0cml4Iiwidmlld01hdCIsIm5vZGUiLCJnZXRMb2NhbFRyYW5zZm9ybSIsImNsb25lIiwiaW52ZXJ0IiwiTWF0NCIsIm11bDIiLCJyZW5kZXIiLCJsaWdodCIsInJlbmRlclRhcmdldCIsImVuYWJsZWQiLCJjb29raWUiLCJ2aXNpYmxlVGhpc0ZyYW1lIiwiRGVidWdHcmFwaGljcyIsInB1c2hHcHVNYXJrZXIiLCJfbm9kZSIsImZhY2VDb3VudCIsIm51bVNoYWRvd0ZhY2VzIiwic2V0VmFsdWUiLCJjb3B5IiwiYXRsYXNWaWV3cG9ydCIsInNtYWxsU2l6ZSIsInoiLCJvZmZzZXQiLCJjdWJlU2xvdHNPZmZzZXRzIiwieCIsInkiLCJ3IiwiZGF0YSIsIm11bFNjYWxhciIsImNvbG9yQnVmZmVyIiwiZHJhd1F1YWRXaXRoU2hhZGVyIiwicG9wR3B1TWFya2VyIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFZQSxNQUFNQSx1QkFBdUIsR0FBSSxDQUFBO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFNLENBQUEsQ0FBQTtBQUVOLE1BQU1DLHlCQUF5QixHQUFJLENBQUE7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFNLENBQUEsQ0FBQTs7QUFFTjtBQUNBLE1BQU1DLDZCQUE2QixHQUFJLENBQUE7QUFDdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFNLENBQUEsQ0FBQTtBQUVOLE1BQU1DLFNBQVMsR0FBRyxJQUFJQyxJQUFJLEVBQUUsQ0FBQTs7QUFFNUI7QUFDQSxNQUFNQyxjQUFjLENBQUM7QUFDakJDLEVBQUFBLFdBQVcsQ0FBQ0MsTUFBTSxFQUFFQyxpQkFBaUIsRUFBRTtJQUNuQyxJQUFJLENBQUNELE1BQU0sR0FBR0EsTUFBTSxDQUFBO0lBQ3BCLElBQUksQ0FBQ0MsaUJBQWlCLEdBQUdBLGlCQUFpQixDQUFBO0lBRTFDLElBQUksQ0FBQ0MsWUFBWSxHQUFHLElBQUksQ0FBQTtJQUN4QixJQUFJLENBQUNDLGNBQWMsR0FBRyxJQUFJLENBQUE7SUFDMUIs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
