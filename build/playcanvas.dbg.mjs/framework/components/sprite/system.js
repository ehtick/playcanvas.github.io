/**
 * @license
 * PlayCanvas Engine v1.57.0 revision f1998a31e (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
import { Color } from '../../../math/color.js';
import { PIXELFORMAT_R8_G8_B8_A8, CULLFACE_NONE } from '../../../graphics/constants.js';
import { Texture } from '../../../graphics/texture.js';
import { BLEND_PREMULTIPLIED, SPRITE_RENDERMODE_SLICED, SPRITE_RENDERMODE_TILED } from '../../../scene/constants.js';
import { StandardMaterial } from '../../../scene/materials/standard-material.js';
import { Component } from '../component.js';
import { ComponentSystem } from '../system.js';
import { SpriteComponent } from './component.js';
import { SpriteComponentData } from './data.js';

const _schema = ['enabled'];

class SpriteComponentSystem extends ComponentSystem {
  constructor(app) {
    super(app);
    this.id = 'sprite';
    this.ComponentType = SpriteComponent;
    this.DataType = SpriteComponentData;
    this.schema = _schema;
    this._defaultTexture = null;
    this._defaultMaterial = null;
    this._default9SlicedMaterialSlicedMode = null;
    this._default9SlicedMaterialTiledMode = null;
    this.app.systems.on('update', this.onUpdate, this);
    this.on('beforeremove', this.onBeforeRemove, this);
  }

  set defaultMaterial(material) {
    this._defaultMaterial = material;
  }

  get defaultMaterial() {
    if (!this._defaultMaterial) {
      const texture = new Texture(this.app.graphicsDevice, {
        width: 1,
        height: 1,
        format: PIXELFORMAT_R8_G8_B8_A8,
        name: 'sprite'
      });
      const pixels = new Uint8Array(texture.lock());
      pixels[0] = pixels[1] = pixels[2] = pixels[3] = 255;
      texture.unlock();
      const material = new StandardMaterial();
      material.diffuse.set(0, 0, 0);
      material.emissive.set(0.5, 0.5, 0.5);
      material.emissiveMap = texture;
      material.emissiveTint = true;
      material.opacityMap = texture;
      material.opacityMapChannel = 'a';
      material.opacityTint = true;
      material.opacity = 0;
      material.useLighting = false;
      material.useGammaTonemap = false;
      material.useFog = false;
      material.useSkybox = false;
      material.blendType = BLEND_PREMULTIPLIED;
      material.depthWrite = false;
      material.pixelSnap = false;
      material.cull = CULLFACE_NONE;
      material.update();
      this._defaultTexture = texture;
      this._defaultMaterial = material;
    }

    return this._defaultMaterial;
  }

  set default9SlicedMaterialSlicedMode(material) {
    this._default9SlicedMaterialSlicedMode = material;
  }

  get default9SlicedMaterialSlicedMode() {
    if (!this._default9SlicedMaterialSlicedMode) {
      const material = this.defaultMaterial.clone();
      material.nineSlicedMode = SPRITE_RENDERMODE_SLICED;
      material.update();
      this._default9SlicedMaterialSlicedMode = material;
    }

    return this._default9SlicedMaterialSlicedMode;
  }

  set default9SlicedMaterialTiledMode(material) {
    this._default9SlicedMaterialTiledMode = material;
  }

  get default9SlicedMaterialTiledMode() {
    if (!this._default9SlicedMaterialTiledMode) {
      const material = this.defaultMaterial.clone();
      material.nineSlicedMode = SPRITE_RENDERMODE_TILED;
      material.update();
      this._default9SlicedMaterialTiledMode = material;
    }

    return this._default9SlicedMaterialTiledMode;
  }

  destroy() {
    super.destroy();
    this.app.systems.off('update', this.onUpdate, this);

    if (this._defaultTexture) {
      this._defaultTexture.destroy();

      this._defaultTexture = null;
    }
  }

  initializeComponentData(component, data, properties) {
    if (data.enabled !== undefined) {
      component.enabled = data.enabled;
    }

    component.type = data.type;

    if (data.layers && Array.isArray(data.layers)) {
      component.layers = data.layers.slice(0);
    }

    if (data.drawOrder !== undefined) {
      component.drawOrder = data.drawOrder;
    }

    if (data.color !== undefined) {
      if (data.color instanceof Color) {
        component.color.set(data.color.r, data.color.g, data.color.b, data.opacity !== undefined ? data.opacity : 1);
      } else {
        component.color.set(data.color[0], data.color[1], data.color[2], data.opacity !== undefined ? data.opacity : 1);
      }

      component.color = component.color;
    }

    if (data.opacity !== undefined) {
      component.opacity = data.opacity;
    }

    if (data.flipX !== undefined) {
      component.flipX = data.flipX;
    }

    if (data.flipY !== undefined) {
      component.flipY = data.flipY;
    }

    if (data.width !== undefined) {
      component.width = data.width;
    }

    if (data.height !== undefined) {
      component.height = data.height;
    }

    if (data.spriteAsset !== undefined) {
      component.spriteAsset = data.spriteAsset;
    }

    if (data.sprite) {
      component.sprite = data.sprite;
    }

    if (data.frame !== undefined) {
      component.frame = data.frame;
    }

    if (data.clips) {
      for (const name in data.clips) {
        component.addClip(data.clips[name]);
      }
    }

    if (data.speed !== undefined) {
      component.speed = data.speed;
    }

    if (data.autoPlayClip) {
      component.autoPlayClip = data.autoPlayClip;
    }

    component.batchGroupId = data.batchGroupId === undefined || data.batchGroupId === null ? -1 : data.batchGroupId;
    super.initializeComponentData(component, data, properties);
  }

  cloneComponent(entity, clone) {
    const source = entity.sprite;
    return this.addComponent(clone, {
      enabled: source.enabled,
      type: source.type,
      spriteAsset: source.spriteAsset,
      sprite: source.sprite,
      frame: source.frame,
      color: source.color.clone(),
      opacity: source.opacity,
      flipX: source.flipX,
      flipY: source.flipY,
      speed: source.speed,
      clips: source.clips,
      autoPlayClip: source.autoPlayClip,
      batchGroupId: source.batchGroupId,
      drawOrder: source.drawOrder,
      layers: source.layers.slice(0)
    });
  }

  onUpdate(dt) {
    const components = this.store;

    for (const id in components) {
      if (components.hasOwnProperty(id)) {
        const component = components[id];

        if (component.data.enabled && component.entity.enabled) {
          const sprite = component.entity.sprite;

          if (sprite._currentClip) {
            sprite._currentClip._update(dt);
          }
        }
      }
    }
  }

  onBeforeRemove(entity, component) {
    component.onDestroy();
  }

}

Component._buildAccessors(SpriteComponent.prototype, _schema);

export { SpriteComponentSystem };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3lzdGVtLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvZnJhbWV3b3JrL2NvbXBvbmVudHMvc3ByaXRlL3N5c3RlbS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb2xvciB9IGZyb20gJy4uLy4uLy4uL21hdGgvY29sb3IuanMnO1xuXG5pbXBvcnQge1xuICAgIENVTExGQUNFX05PTkUsXG4gICAgUElYRUxGT1JNQVRfUjhfRzhfQjhfQThcbn0gZnJvbSAnLi4vLi4vLi4vZ3JhcGhpY3MvY29uc3RhbnRzLmpzJztcbmltcG9ydCB7IFRleHR1cmUgfSBmcm9tICcuLi8uLi8uLi9ncmFwaGljcy90ZXh0dXJlLmpzJztcblxuaW1wb3J0IHsgQkxFTkRfUFJFTVVMVElQTElFRCwgU1BSSVRFX1JFTkRFUk1PREVfU0xJQ0VELCBTUFJJVEVfUkVOREVSTU9ERV9USUxFRCB9IGZyb20gJy4uLy4uLy4uL3NjZW5lL2NvbnN0YW50cy5qcyc7XG5pbXBvcnQgeyBTdGFuZGFyZE1hdGVyaWFsIH0gZnJvbSAnLi4vLi4vLi4vc2NlbmUvbWF0ZXJpYWxzL3N0YW5kYXJkLW1hdGVyaWFsLmpzJztcblxuaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAnLi4vY29tcG9uZW50LmpzJztcbmltcG9ydCB7IENvbXBvbmVudFN5c3RlbSB9IGZyb20gJy4uL3N5c3RlbS5qcyc7XG5cbmltcG9ydCB7IFNwcml0ZUNvbXBvbmVudCB9IGZyb20gJy4vY29tcG9uZW50LmpzJztcbmltcG9ydCB7IFNwcml0ZUNvbXBvbmVudERhdGEgfSBmcm9tICcuL2RhdGEuanMnO1xuXG4vKiogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vYXBwLWJhc2UuanMnKS5BcHBCYXNlfSBBcHBCYXNlICovXG5cbmNvbnN0IF9zY2hlbWEgPSBbJ2VuYWJsZWQnXTtcblxuLyoqXG4gKiBNYW5hZ2VzIGNyZWF0aW9uIG9mIHtAbGluayBTcHJpdGVDb21wb25lbnR9cy5cbiAqXG4gKiBAYXVnbWVudHMgQ29tcG9uZW50U3lzdGVtXG4gKi9cbmNsYXNzIFNwcml0ZUNvbXBvbmVudFN5c3RlbSBleHRlbmRzIENvbXBvbmVudFN5c3RlbSB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgbmV3IFNwcml0ZUNvbXBvbmVudFN5c3RlbSBpbnN0YW5jZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7QXBwQmFzZX0gYXBwIC0gVGhlIGFwcGxpY2F0aW9uLlxuICAgICAqIEBoaWRlY29uc3RydWN0b3JcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcihhcHApIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcblxuICAgICAgICB0aGlzLmlkID0gJ3Nwcml0ZSc7XG5cbiAgICAgICAgdGhpcy5Db21wb25lbnRUeXBlID0gU3ByaXRlQ29tcG9uZW50O1xuICAgICAgICB0aGlzLkRhdGFUeXBlID0gU3ByaXRlQ29tcG9uZW50RGF0YTtcblxuICAgICAgICB0aGlzLnNjaGVtYSA9IF9zY2hlbWE7XG5cbiAgICAgICAgLy8gZGVmYXVsdCB0ZXh0dXJlIC0gbWFrZSB3aGl0ZSBzbyB3ZSBjYW4gdGludCBpdCB3aXRoIGVtaXNzaXZlIGNvbG9yXG4gICAgICAgIHRoaXMuX2RlZmF1bHRUZXh0dXJlID0gbnVsbDtcblxuICAgICAgICAvLyBkZWZhdWx0IG1hdGVyaWFsIHVzZWQgYnkgc3ByaXRlc1xuICAgICAgICB0aGlzLl9kZWZhdWx0TWF0ZXJpYWwgPSBudWxsO1xuXG4gICAgICAgIC8vIG1hdGVyaWFsIHVzZWQgZm9yIDktc2xpY2luZyBpbiBzbGljZWQgbW9kZVxuICAgICAgICB0aGlzLl9kZWZhdWx0OVNsaWNlZE1hdGVyaWFsU2xpY2VkTW9kZSA9IG51bGw7XG5cbiAgICAgICAgLy8gbWF0ZXJpYWwgdXNlZCBmb3IgOS1zbGljaW5nIGluIHRpbGVkIG1vZGVcbiAgICAgICAgdGhpcy5fZGVmYXVsdDlTbGljZWRNYXRlcmlhbFRpbGVkTW9kZSA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5hcHAuc3lzdGVtcy5vbigndXBkYXRlJywgdGhpcy5vblVwZGF0ZSwgdGhpcyk7XG4gICAgICAgIHRoaXMub24oJ2JlZm9yZXJlbW92ZScsIHRoaXMub25CZWZvcmVSZW1vdmUsIHRoaXMpO1xuICAgIH1cblxuICAgIHNldCBkZWZhdWx0TWF0ZXJpYWwobWF0ZXJpYWwpIHtcbiAgICAgICAgdGhpcy5fZGVmYXVsdE1hdGVyaWFsID0gbWF0ZXJpYWw7XG4gICAgfVxuXG4gICAgZ2V0IGRlZmF1bHRNYXRlcmlhbCgpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9kZWZhdWx0TWF0ZXJpYWwpIHtcbiAgICAgICAgICAgIGNvbnN0IHRleHR1cmUgPSBuZXcgVGV4dHVyZSh0aGlzLmFwcC5ncmFwaGljc0RldmljZSwge1xuICAgICAgICAgICAgICAgIHdpZHRoOiAxLFxuICAgICAgICAgICAgICAgIGhlaWdodDogMSxcbiAgICAgICAgICAgICAgICBmb3JtYXQ6IFBJWEVMRk9STUFUX1I4X0c4X0I4X0E4LFxuICAgICAgICAgICAgICAgIG5hbWU6ICdzcHJpdGUnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnN0IHBpeGVscyA9IG5ldyBVaW50OEFycmF5KHRleHR1cmUubG9jaygpKTtcbiAgICAgICAgICAgIHBpeGVsc1swXSA9IHBpeGVsc1sxXSA9IHBpeGVsc1syXSA9IHBpeGVsc1szXSA9IDI1NTtcbiAgICAgICAgICAgIHRleHR1cmUudW5sb2NrKCk7XG5cbiAgICAgICAgICAgIGNvbnN0IG1hdGVyaWFsID0gbmV3IFN0YW5kYXJkTWF0ZXJpYWwoKTtcbiAgICAgICAgICAgIG1hdGVyaWFsLmRpZmZ1c2Uuc2V0KDAsIDAsIDApOyAvLyBibGFjayBkaWZmdXNlIGNvbG9yIHRvIHByZXZlbnQgYW1iaWVudCBsaWdodCBiZWluZyBpbmNsdWRlZFxuICAgICAgICAgICAgbWF0ZXJpYWwuZW1pc3NpdmUuc2V0KDAuNSwgMC41LCAwLjUpOyAvLyB1c2Ugbm9uLXdoaXRlIHRvIGNvbXBpbGUgc2hhZGVyIGNvcnJlY3RseVxuICAgICAgICAgICAgbWF0ZXJpYWwuZW1pc3NpdmVNYXAgPSB0ZXh0dXJlO1xuICAgICAgICAgICAgbWF0ZXJpYWwuZW1pc3NpdmVUaW50ID0gdHJ1ZTtcbiAgICAgICAgICAgIG1hdGVyaWFsLm9wYWNpdHlNYXAgPSB0ZXh0dXJlO1xuICAgICAgICAgICAgbWF0ZXJpYWwub3BhY2l0eU1hcENoYW5uZWwgPSAnYSc7XG4gICAgICAgICAgICBtYXRlcmlhbC5vcGFjaXR5VGludCA9IHRydWU7XG4gICAgICAgICAgICBtYXRlcmlhbC5vcGFjaXR5ID0gMDsgLy8gdXNlIG5vbi0xIG9wYWNpdHkgdG8gY29tcGlsZSBzaGFkZXIgY29ycmVjdGx5XG4gICAgICAgICAgICBtYXRlcmlhbC51c2VMaWdodGluZyA9IGZhbHNlO1xuICAgICAgICAgICAgbWF0ZXJpYWwudXNlR2FtbWFUb25lbWFwID0gZmFsc2U7XG4gICAgICAgICAgICBtYXRlcmlhbC51c2VGb2cgPSBmYWxzZTtcbiAgICAgICAgICAgIG1hdGVyaWFsLnVzZVNreWJveCA9IGZhbHNlO1xuICAgICAgICAgICAgbWF0ZXJpYWwuYmxlbmRUeXBlID0gQkxFTkRfUFJFTVVMVElQTElFRDtcbiAgICAgICAgICAgIG1hdGVyaWFsLmRlcHRoV3JpdGUgPSBmYWxzZTtcbiAgICAgICAgICAgIG1hdGVyaWFsLnBpeGVsU25hcCA9IGZhbHNlO1xuICAgICAgICAgICAgbWF0ZXJpYWwuY3VsbCA9IENVTExGQUNFX05PTkU7IC8vIGRvbid0IGN1bGwgYmVjYXVzZSB3ZSBtaWdodCBmbGlwWCBvciBmbGlwWSB3aGljaCB1c2VzIG5lZ2F0aXZlIHNjYWxlIG9uIHRoZSBncmFwaCBub2RlXG4gICAgICAgICAgICBtYXRlcmlhbC51cGRhdGUoKTtcblxuICAgICAgICAgICAgdGhpcy5fZGVmYXVsdFRleHR1cmUgPSB0ZXh0dXJlO1xuICAgICAgICAgICAgdGhpcy5fZGVmYXVsdE1hdGVyaWFsID0gbWF0ZXJpYWw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX2RlZmF1bHRNYXRlcmlhbDtcbiAgICB9XG5cbiAgICBzZXQgZGVmYXVsdDlTbGljZWRNYXRlcmlhbFNsaWNlZE1vZGUobWF0ZXJpYWwpIHtcbiAgICAgICAgdGhpcy5fZGVmYXVsdDlTbGljZWRNYXRlcmlhbFNsaWNlZE1vZGUgPSBtYXRlcmlhbDtcbiAgICB9XG5cbiAgICBnZXQgZGVmYXVsdDlTbGljZWRNYXRlcmlhbFNsaWNlZE1vZGUoKSB7XG4gICAgICAgIGlmICghdGhpcy5fZGVmYXVsdDlTbGljZWRNYXRlcmlhbFNsaWNlZE1vZGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG1hdGVyaWFsID0gdGhpcy5kZWZhdWx0TWF0ZXJpYWwuY2xvbmUoKTtcbiAgICAgICAgICAgIG1hdGVyaWFsLm5pbmVTbGljZWRNb2RlID0gU1BSSVRFX1JFTkRFUk1PREVfU0xJQ0VEO1xuICAgICAgICAgICAgbWF0ZXJpYWwudXBkYXRlKCk7XG5cbiAgICAgICAgICAgIHRoaXMuX2RlZmF1bHQ5U2xpY2VkTWF0ZXJpYWxTbGljZWRNb2RlID0gbWF0ZXJpYWw7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXMuX2RlZmF1bHQ5U2xpY2VkTWF0ZXJpYWxTbGljZWRNb2RlO1xuICAgIH1cblxuICAgIHNldCBkZWZhdWx0OVNsaWNlZE1hdGVyaWFsVGlsZWRNb2RlKG1hdGVyaWFsKSB7XG4gICAgICAgIHRoaXMuX2RlZmF1bHQ5U2xpY2VkTWF0ZXJpYWxUaWxlZE1vZGUgPSBtYXRlcmlhbDtcbiAgICB9XG5cbiAgICBnZXQgZGVmYXVsdDlTbGljZWRNYXRlcmlhbFRpbGVkTW9kZSgpIHtcbiAgICAgICAgaWYgKCF0aGlzLl9kZWZhdWx0OVNsaWNlZE1hdGVyaWFsVGlsZWRNb2RlKSB7XG4gICAgICAgICAgICBjb25zdCBtYXRlcmlhbCA9IHRoaXMuZGVmYXVsdE1hdGVyaWFsLmNsb25lKCk7XG4gICAgICAgICAgICBtYXRlcmlhbC5uaW5lU2xpY2VkTW9kZSA9IFNQUklURV9SRU5ERVJNT0RFX1RJTEVEO1xuICAgICAgICAgICAgbWF0ZXJpYWwudXBkYXRlKCk7XG5cbiAgICAgICAgICAgIHRoaXMuX2RlZmF1bHQ5U2xpY2VkTWF0ZXJpYWxUaWxlZE1vZGUgPSBtYXRlcmlhbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcy5fZGVmYXVsdDlTbGljZWRNYXRlcmlhbFRpbGVkTW9kZTtcbiAgICB9XG5cbiAgICBkZXN0cm95KCkge1xuICAgICAgICBzdXBlci5kZXN0cm95KCk7XG5cbiAgICAgICAgdGhpcy5hcHAuc3lzdGVtcy5vZmYoJ3VwZGF0ZScsIHRoaXMub25VcGRhdGUsIHRoaXMpO1xuXG4gICAgICAgIGlmICh0aGlzLl9kZWZhdWx0VGV4dHVyZSkge1xuICAgICAgICAgICAgdGhpcy5fZGVmYXVsdFRleHR1cmUuZGVzdHJveSgpO1xuICAgICAgICAgICAgdGhpcy5fZGVmYXVsdFRleHR1cmUgPSBudWxsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaW5pdGlhbGl6ZUNvbXBvbmVudERhdGEoY29tcG9uZW50LCBkYXRhLCBwcm9wZXJ0aWVzKSB7XG4gICAgICAgIGlmIChkYXRhLmVuYWJsZWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY29tcG9uZW50LmVuYWJsZWQgPSBkYXRhLmVuYWJsZWQ7XG4gICAgICAgIH1cblxuICAgICAgICBjb21wb25lbnQudHlwZSA9IGRhdGEudHlwZTtcblxuICAgICAgICBpZiAoZGF0YS5sYXllcnMgJiYgQXJyYXkuaXNBcnJheShkYXRhLmxheWVycykpIHtcbiAgICAgICAgICAgIGNvbXBvbmVudC5sYXllcnMgPSBkYXRhLmxheWVycy5zbGljZSgwKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkYXRhLmRyYXdPcmRlciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBjb21wb25lbnQuZHJhd09yZGVyID0gZGF0YS5kcmF3T3JkZXI7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZGF0YS5jb2xvciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBpZiAoZGF0YS5jb2xvciBpbnN0YW5jZW9mIENvbG9yKSB7XG4gICAgICAgICAgICAgICAgY29tcG9uZW50LmNvbG9yLnNldChkYXRhLmNvbG9yLnIsIGRhdGEuY29sb3IuZywgZGF0YS5jb2xvci5iLCBkYXRhLm9wYWNpdHkgIT09IHVuZGVmaW5lZCA/IGRhdGEub3BhY2l0eSA6IDEpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb21wb25lbnQuY29sb3Iuc2V0KGRhdGEuY29sb3JbMF0sIGRhdGEuY29sb3JbMV0sIGRhdGEuY29sb3JbMl0sIGRhdGEub3BhY2l0eSAhPT0gdW5kZWZpbmVkID8gZGF0YS5vcGFjaXR5IDogMSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLXNlbGYtYXNzaWduICovXG4gICAgICAgICAgICAvLyBmb3JjZSB1cGRhdGVcbiAgICAgICAgICAgIGNvbXBvbmVudC5jb2xvciA9IGNvbXBvbmVudC5jb2xvcjtcbiAgICAgICAgICAgIC8qIGVzbGludC1lbmFibGUgbm8tc2VsZi1hc3NpZ24gKi9cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkYXRhLm9wYWNpdHkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY29tcG9uZW50Lm9wYWNpdHkgPSBkYXRhLm9wYWNpdHk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZGF0YS5mbGlwWCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBjb21wb25lbnQuZmxpcFggPSBkYXRhLmZsaXBYO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGRhdGEuZmxpcFkgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY29tcG9uZW50LmZsaXBZID0gZGF0YS5mbGlwWTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkYXRhLndpZHRoICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIGNvbXBvbmVudC53aWR0aCA9IGRhdGEud2lkdGg7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZGF0YS5oZWlnaHQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY29tcG9uZW50LmhlaWdodCA9IGRhdGEuaGVpZ2h0O1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGRhdGEuc3ByaXRlQXNzZXQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY29tcG9uZW50LnNwcml0ZUFzc2V0ID0gZGF0YS5zcHJpdGVBc3NldDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkYXRhLnNwcml0ZSkge1xuICAgICAgICAgICAgY29tcG9uZW50LnNwcml0ZSA9IGRhdGEuc3ByaXRlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGRhdGEuZnJhbWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgY29tcG9uZW50LmZyYW1lID0gZGF0YS5mcmFtZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkYXRhLmNsaXBzKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IG5hbWUgaW4gZGF0YS5jbGlwcykge1xuICAgICAgICAgICAgICAgIGNvbXBvbmVudC5hZGRDbGlwKGRhdGEuY2xpcHNbbmFtZV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGRhdGEuc3BlZWQgIT09IHVuZGVmaW5lZCkgIHtcbiAgICAgICAgICAgIGNvbXBvbmVudC5zcGVlZCA9IGRhdGEuc3BlZWQ7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZGF0YS5hdXRvUGxheUNsaXApIHtcbiAgICAgICAgICAgIGNvbXBvbmVudC5hdXRvUGxheUNsaXAgPSBkYXRhLmF1dG9QbGF5Q2xpcDtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbXBvbmVudC5iYXRjaEdyb3VwSWQgPSBkYXRhLmJhdGNoR3JvdXBJZCA9PT0gdW5kZWZpbmVkIHx8IGRhdGEuYmF0Y2hHcm91cElkID09PSBudWxsID8gLTEgOiBkYXRhLmJhdGNoR3JvdXBJZDtcblxuICAgICAgICBzdXBlci5pbml0aWFsaXplQ29tcG9uZW50RGF0YShjb21wb25lbnQsIGRhdGEsIHByb3BlcnRpZXMpO1xuICAgIH1cblxuICAgIGNsb25lQ29tcG9uZW50KGVudGl0eSwgY2xvbmUpIHtcbiAgICAgICAgY29uc3Qgc291cmNlID0gZW50aXR5LnNwcml0ZTtcblxuICAgICAgICByZXR1cm4gdGhpcy5hZGRDb21wb25lbnQoY2xvbmUsIHtcbiAgICAgICAgICAgIGVuYWJsZWQ6IHNvdXJjZS5lbmFibGVkLFxuICAgICAgICAgICAgdHlwZTogc291cmNlLnR5cGUsXG4gICAgICAgICAgICBzcHJpdGVBc3NldDogc291cmNlLnNwcml0ZUFzc2V0LFxuICAgICAgICAgICAgc3ByaXRlOiBzb3VyY2Uuc3ByaXRlLFxuICAgICAgICAgICAgZnJhbWU6IHNvdXJjZS5mcmFtZSxcbiAgICAgICAgICAgIGNvbG9yOiBzb3VyY2UuY29sb3IuY2xvbmUoKSxcbiAgICAgICAgICAgIG9wYWNpdHk6IHNvdXJjZS5vcGFjaXR5LFxuICAgICAgICAgICAgZmxpcFg6IHNvdXJjZS5mbGlwWCxcbiAgICAgICAgICAgIGZsaXBZOiBzb3VyY2UuZmxpcFksXG4gICAgICAgICAgICBzcGVlZDogc291cmNlLnNwZWVkLFxuICAgICAgICAgICAgY2xpcHM6IHNvdXJjZS5jbGlwcyxcbiAgICAgICAgICAgIGF1dG9QbGF5Q2xpcDogc291cmNlLmF1dG9QbGF5Q2xpcCxcbiAgICAgICAgICAgIGJhdGNoR3JvdXBJZDogc291cmNlLmJhdGNoR3JvdXBJZCxcbiAgICAgICAgICAgIGRyYXdPcmRlcjogc291cmNlLmRyYXdPcmRlcixcbiAgICAgICAgICAgIGxheWVyczogc291cmNlLmxheWVycy5zbGljZSgwKVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBvblVwZGF0ZShkdCkge1xuICAgICAgICBjb25zdCBjb21wb25lbnRzID0gdGhpcy5zdG9yZTtcblxuICAgICAgICBmb3IgKGNvbnN0IGlkIGluIGNvbXBvbmVudHMpIHtcbiAgICAgICAgICAgIGlmIChjb21wb25lbnRzLmhhc093blByb3BlcnR5KGlkKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbXBvbmVudCA9IGNvbXBvbmVudHNbaWRdO1xuICAgICAgICAgICAgICAgIC8vIGlmIHNwcml0ZSBjb21wb25lbnQgaXMgZW5hYmxlZCBhZHZhbmNlIGl0cyBjdXJyZW50IGNsaXBcbiAgICAgICAgICAgICAgICBpZiAoY29tcG9uZW50LmRhdGEuZW5hYmxlZCAmJiBjb21wb25lbnQuZW50aXR5LmVuYWJsZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qgc3ByaXRlID0gY29tcG9uZW50LmVudGl0eS5zcHJpdGU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzcHJpdGUuX2N1cnJlbnRDbGlwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzcHJpdGUuX2N1cnJlbnRDbGlwLl91cGRhdGUoZHQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgb25CZWZvcmVSZW1vdmUoZW50aXR5LCBjb21wb25lbnQpIHtcbiAgICAgICAgY29tcG9uZW50Lm9uRGVzdHJveSgpO1xuICAgIH1cbn1cblxuQ29tcG9uZW50Ll9idWlsZEFjY2Vzc29ycyhTcHJpdGVDb21wb25lbnQucHJvdG90eXBlLCBfc2NoZW1hKTtcblxuZXhwb3J0IHsgU3ByaXRlQ29tcG9uZW50U3lzdGVtIH07XG4iXSwibmFtZXMiOlsiX3NjaGVtYSIsIlNwcml0ZUNvbXBvbmVudFN5c3RlbSIsIkNvbXBvbmVudFN5c3RlbSIsImNvbnN0cnVjdG9yIiwiYXBwIiwiaWQiLCJDb21wb25lbnRUeXBlIiwiU3ByaXRlQ29tcG9uZW50IiwiRGF0YVR5cGUiLCJTcHJpdGVDb21wb25lbnREYXRhIiwic2NoZW1hIiwiX2RlZmF1bHRUZXh0dXJlIiwiX2RlZmF1bHRNYXRlcmlhbCIsIl9kZWZhdWx0OVNsaWNlZE1hdGVyaWFsU2xpY2VkTW9kZSIsIl9kZWZhdWx0OVNsaWNlZE1hdGVyaWFsVGlsZWRNb2RlIiwic3lzdGVtcyIsIm9uIiwib25VcGRhdGUiLCJvbkJlZm9yZVJlbW92ZSIsImRlZmF1bHRNYXRlcmlhbCIsIm1hdGVyaWFsIiwidGV4dHVyZSIsIlRleHR1cmUiLCJncmFwaGljc0RldmljZSIsIndpZHRoIiwiaGVpZ2h0IiwiZm9ybWF0IiwiUElYRUxGT1JNQVRfUjhfRzhfQjhfQTgiLCJuYW1lIiwicGl4ZWxzIiwiVWludDhBcnJheSIsImxvY2siLCJ1bmxvY2siLCJTdGFuZGFyZE1hdGVyaWFsIiwiZGlmZnVzZSIsInNldCIsImVtaXNzaXZlIiwiZW1pc3NpdmVNYXAiLCJlbWlzc2l2ZVRpbnQiLCJvcGFjaXR5TWFwIiwib3BhY2l0eU1hcENoYW5uZWwiLCJvcGFjaXR5VGludCIsIm9wYWNpdHkiLCJ1c2VMaWdodGluZyIsInVzZUdhbW1hVG9uZW1hcCIsInVzZUZvZyIsInVzZVNreWJveCIsImJsZW5kVHlwZSIsIkJMRU5EX1BSRU1VTFRJUExJRUQiLCJkZXB0aFdyaXRlIiwicGl4ZWxTbmFwIiwiY3VsbCIsIkNVTExGQUNFX05PTkUiLCJ1cGRhdGUiLCJkZWZhdWx0OVNsaWNlZE1hdGVyaWFsU2xpY2VkTW9kZSIsImNsb25lIiwibmluZVNsaWNlZE1vZGUiLCJTUFJJVEVfUkVOREVSTU9ERV9TTElDRUQiLCJkZWZhdWx0OVNsaWNlZE1hdGVyaWFsVGlsZWRNb2RlIiwiU1BSSVRFX1JFTkRFUk1PREVfVElMRUQiLCJkZXN0cm95Iiwib2ZmIiwiaW5pdGlhbGl6ZUNvbXBvbmVudERhdGEiLCJjb21wb25lbnQiLCJkYXRhIiwicHJvcGVydGllcyIsImVuYWJsZWQiLCJ1bmRlZmluZWQiLCJ0eXBlIiwibGF5ZXJzIiwiQXJyYXkiLCJpc0FycmF5Iiwic2xpY2UiLCJkcmF3T3JkZXIiLCJjb2xvciIsIkNvbG9yIiwiciIsImciLCJiIiwiZmxpcFgiLCJmbGlwWSIsInNwcml0ZUFzc2V0Iiwic3ByaXRlIiwiZnJhbWUiLCJjbGlwcyIsImFkZENsaXAiLCJzcGVlZCIsImF1dG9QbGF5Q2xpcCIsImJhdGNoR3JvdXBJZCIsImNsb25lQ29tcG9uZW50IiwiZW50aXR5Iiwic291cmNlIiwiYWRkQ29tcG9uZW50IiwiZHQiLCJjb21wb25lbnRzIiwic3RvcmUiLCJoYXNPd25Qcm9wZXJ0eSIsIl9jdXJyZW50Q2xpcCIsIl91cGRhdGUiLCJvbkRlc3Ryb3kiLCJDb21wb25lbnQiLCJfYnVpbGRBY2Nlc3NvcnMiLCJwcm90b3R5cGUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQW1CQSxNQUFNQSxPQUFPLEdBQUcsQ0FBQyxTQUFELENBQWhCLENBQUE7O0FBT0EsTUFBTUMscUJBQU4sU0FBb0NDLGVBQXBDLENBQW9EO0VBT2hEQyxXQUFXLENBQUNDLEdBQUQsRUFBTTtBQUNiLElBQUEsS0FBQSxDQUFNQSxHQUFOLENBQUEsQ0FBQTtJQUVBLElBQUtDLENBQUFBLEVBQUwsR0FBVSxRQUFWLENBQUE7SUFFQSxJQUFLQyxDQUFBQSxhQUFMLEdBQXFCQyxlQUFyQixDQUFBO0lBQ0EsSUFBS0MsQ0FBQUEsUUFBTCxHQUFnQkMsbUJBQWhCLENBQUE7SUFFQSxJQUFLQyxDQUFBQSxNQUFMLEdBQWNWLE9BQWQsQ0FBQTtJQUdBLElBQUtXLENBQUFBLGVBQUwsR0FBdUIsSUFBdkIsQ0FBQTtJQUdBLElBQUtDLENBQUFBLGdCQUFMLEdBQXdCLElBQXhCLENBQUE7SUFHQSxJQUFLQyxDQUFBQSxpQ0FBTCxHQUF5QyxJQUF6QyxDQUFBO0lBR0EsSUFBS0MsQ0FBQUEsZ0NBQUwsR0FBd0MsSUFBeEMsQ0FBQTtJQUVBLElBQUtWLENBQUFBLEdBQUwsQ0FBU1csT0FBVCxDQUFpQkMsRUFBakIsQ0FBb0IsUUFBcEIsRUFBOEIsSUFBQSxDQUFLQyxRQUFuQyxFQUE2QyxJQUE3QyxDQUFBLENBQUE7QUFDQSxJQUFBLElBQUEsQ0FBS0QsRUFBTCxDQUFRLGNBQVIsRUFBd0IsSUFBS0UsQ0FBQUEsY0FBN0IsRUFB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
