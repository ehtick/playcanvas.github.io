/**
 * @license
 * PlayCanvas Engine v1.57.0 revision f1998a31e (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
import { math } from '../../../math/math.js';
import { ORIENTATION_HORIZONTAL } from '../../../scene/constants.js';
import { Component } from '../component.js';
import { ElementDragHelper } from '../element/element-drag-helper.js';
import { EntityReference } from '../../utils/entity-reference.js';

class ScrollbarComponent extends Component {
  constructor(system, entity) {
    super(system, entity);
    this._handleReference = new EntityReference(this, 'handleEntity', {
      'element#gain': this._onHandleElementGain,
      'element#lose': this._onHandleElementLose,
      'element#set:anchor': this._onSetHandleAlignment,
      'element#set:margin': this._onSetHandleAlignment,
      'element#set:pivot': this._onSetHandleAlignment
    });

    this._toggleLifecycleListeners('on');
  }

  _toggleLifecycleListeners(onOrOff) {
    this[onOrOff]('set_value', this._onSetValue, this);
    this[onOrOff]('set_handleSize', this._onSetHandleSize, this);
    this[onOrOff]('set_orientation', this._onSetOrientation, this);
  }

  _onHandleElementGain() {
    this._destroyDragHelper();

    this._handleDragHelper = new ElementDragHelper(this._handleReference.entity.element, this._getAxis());

    this._handleDragHelper.on('drag:move', this._onHandleDrag, this);

    this._updateHandlePositionAndSize();
  }

  _onHandleElementLose() {
    this._destroyDragHelper();
  }

  _onHandleDrag(position) {
    if (this._handleReference.entity && this.enabled && this.entity.enabled) {
      this.value = this._handlePositionToScrollValue(position[this._getAxis()]);
    }
  }

  _onSetValue(name, oldValue, newValue) {
    if (Math.abs(newValue - oldValue) > 1e-5) {
      this.data.value = math.clamp(newValue, 0, 1);

      this._updateHandlePositionAndSize();

      this.fire('set:value', this.data.value);
    }
  }

  _onSetHandleSize(name, oldValue, newValue) {
    if (Math.abs(newValue - oldValue) > 1e-5) {
      this.data.handleSize = math.clamp(newValue, 0, 1);

      this._updateHandlePositionAndSize();
    }
  }

  _onSetHandleAlignment() {
    this._updateHandlePositionAndSize();
  }

  _onSetOrientation(name, oldValue, newValue) {
    if (newValue !== oldValue && this._handleReference.hasComponent('element')) {
      this._handleReference.entity.element[this._getOppositeDimension()] = 0;
    }
  }

  _updateHandlePositionAndSize() {
    const handleEntity = this._handleReference.entity;
    const handleElement = handleEntity && handleEntity.element;

    if (handleEntity) {
      const position = handleEntity.getLocalPosition();
      position[this._getAxis()] = this._getHandlePosition();

      this._handleReference.entity.setLocalPosition(position);
    }

    if (handleElement) {
      handleElement[this._getDimension()] = this._getHandleLength();
    }
  }

  _handlePositionToScrollValue(handlePosition) {
    return handlePosition * this._getSign() / this._getUsableTrackLength();
  }

  _scrollValueToHandlePosition(value) {
    return value * this._getSign() * this._getUsableTrackLength();
  }

  _getUsableTrackLength() {
    return Math.max(this._getTrackLength() - this._getHandleLength(), 0.001);
  }

  _getTrackLength() {
    if (this.entity.element) {
      return this.orientation === ORIENTATION_HORIZONTAL ? this.entity.element.calculatedWidth : this.entity.element.calculatedHeight;
    }

    return 0;
  }

  _getHandleLength() {
    return this._getTrackLength() * this.handleSize;
  }

  _getHandlePosition() {
    return this._scrollValueToHandlePosition(this.value);
  }

  _getSign() {
    return this.orientation === ORIENTATION_HORIZONTAL ? 1 : -1;
  }

  _getAxis() {
    return this.orientation === ORIENTATION_HORIZONTAL ? 'x' : 'y';
  }

  _getDimension() {
    return this.orientation === ORIENTATION_HORIZONTAL ? 'width' : 'height';
  }

  _getOppositeDimension() {
    return this.orientation === ORIENTATION_HORIZONTAL ? 'height' : 'width';
  }

  _destroyDragHelper() {
    if (this._handleDragHelper) {
      this._handleDragHelper.destroy();
    }
  }

  _setHandleDraggingEnabled(enabled) {
    if (this._handleDragHelper) {
      this._handleDragHelper.enabled = enabled;
    }
  }

  onEnable() {
    this._handleReference.onParentComponentEnable();

    this._setHandleDraggingEnabled(true);
  }

  onDisable() {
    this._setHandleDraggingEnabled(false);
  }

  onRemove() {
    this._destroyDragHelper();

    this._toggleLifecycleListeners('off');
  }

}

export { ScrollbarComponent };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9uZW50LmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvZnJhbWV3b3JrL2NvbXBvbmVudHMvc2Nyb2xsYmFyL2NvbXBvbmVudC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBtYXRoIH0gZnJvbSAnLi4vLi4vLi4vbWF0aC9tYXRoLmpzJztcblxuaW1wb3J0IHsgT1JJRU5UQVRJT05fSE9SSVpPTlRBTCB9IGZyb20gJy4uLy4uLy4uL3NjZW5lL2NvbnN0YW50cy5qcyc7XG5cbmltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJy4uL2NvbXBvbmVudC5qcyc7XG5cbmltcG9ydCB7IEVsZW1lbnREcmFnSGVscGVyIH0gZnJvbSAnLi4vZWxlbWVudC9lbGVtZW50LWRyYWctaGVscGVyLmpzJztcblxuaW1wb3J0IHsgRW50aXR5UmVmZXJlbmNlIH0gZnJvbSAnLi4vLi4vdXRpbHMvZW50aXR5LXJlZmVyZW5jZS5qcyc7XG5cbi8qKiBAdHlwZWRlZiB7aW1wb3J0KCcuLi8uLi9lbnRpdHkuanMnKS5FbnRpdHl9IEVudGl0eSAqL1xuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJy4vc3lzdGVtLmpzJykuU2Nyb2xsYmFyQ29tcG9uZW50U3lzdGVtfSBTY3JvbGxiYXJDb21wb25lbnRTeXN0ZW0gKi9cblxuLyoqXG4gKiBBIFNjcm9sbGJhckNvbXBvbmVudCBlbmFibGVzIGEgZ3JvdXAgb2YgZW50aXRpZXMgdG8gYmVoYXZlIGxpa2UgYSBkcmFnZ2FibGUgc2Nyb2xsYmFyLlxuICpcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBvcmllbnRhdGlvbiBXaGV0aGVyIHRoZSBzY3JvbGxiYXIgbW92ZXMgaG9yaXpvbnRhbGx5IG9yIHZlcnRpY2FsbHkuIENhbiBiZTpcbiAqXG4gKiAtIHtAbGluayBPUklFTlRBVElPTl9IT1JJWk9OVEFMfTogVGhlIHNjcm9sbGJhciBhbmltYXRlcyBpbiB0aGUgaG9yaXpvbnRhbCBheGlzLlxuICogLSB7QGxpbmsgT1JJRU5UQVRJT05fVkVSVElDQUx9OiBUaGUgc2Nyb2xsYmFyIGFuaW1hdGVzIGluIHRoZSB2ZXJ0aWNhbCBheGlzLlxuICpcbiAqIERlZmF1bHRzIHRvIHtAbGluayBPUklFTlRBVElPTl9IT1JJWk9OVEFMfS5cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSB2YWx1ZSBUaGUgY3VycmVudCBwb3NpdGlvbiB2YWx1ZSBvZiB0aGUgc2Nyb2xsYmFyLCBpbiB0aGUgcmFuZ2UgMCB0byAxLlxuICogRGVmYXVsdHMgdG8gMC5cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBoYW5kbGVTaXplIFRoZSBzaXplIG9mIHRoZSBoYW5kbGUgcmVsYXRpdmUgdG8gdGhlIHNpemUgb2YgdGhlIHRyYWNrLCBpbiB0aGVcbiAqIHJhbmdlIDAgdG8gMS4gRm9yIGEgdmVydGljYWwgc2Nyb2xsYmFyLCBhIHZhbHVlIG9mIDEgbWVhbnMgdGhhdCB0aGUgaGFuZGxlIHdpbGwgdGFrZSB1cCB0aGUgZnVsbFxuICogaGVpZ2h0IG9mIHRoZSB0cmFjay5cbiAqIEBwcm9wZXJ0eSB7RW50aXR5fSBoYW5kbGVFbnRpdHkgVGhlIGVudGl0eSB0byBiZSB1c2VkIGFzIHRoZSBzY3JvbGxiYXIgaGFuZGxlLiBUaGlzIGVudGl0eSBtdXN0XG4gKiBoYXZlIGEgU2Nyb2xsYmFyIGNvbXBvbmVudC5cbiAqIEBhdWdtZW50cyBDb21wb25lbnRcbiAqL1xuY2xhc3MgU2Nyb2xsYmFyQ29tcG9uZW50IGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBuZXcgU2Nyb2xsYmFyQ29tcG9uZW50LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtTY3JvbGxiYXJDb21wb25lbnRTeXN0ZW19IHN5c3RlbSAtIFRoZSBDb21wb25lbnRTeXN0ZW0gdGhhdCBjcmVhdGVkIHRoaXMgQ29tcG9uZW50LlxuICAgICAqIEBwYXJhbSB7RW50aXR5fSBlbnRpdHkgLSBUaGUgRW50aXR5IHRoYXQgdGhpcyBDb21wb25lbnQgaXMgYXR0YWNoZWQgdG8uXG4gICAgICovXG4gICAgY29uc3RydWN0b3Ioc3lzdGVtLCBlbnRpdHkpIHtcbiAgICAgICAgc3VwZXIoc3lzdGVtLCBlbnRpdHkpO1xuXG4gICAgICAgIHRoaXMuX2hhbmRsZVJlZmVyZW5jZSA9IG5ldyBFbnRpdHlSZWZlcmVuY2UodGhpcywgJ2hhbmRsZUVudGl0eScsIHtcbiAgICAgICAgICAgICdlbGVtZW50I2dhaW4nOiB0aGlzLl9vbkhhbmRsZUVsZW1lbnRHYWluLFxuICAgICAgICAgICAgJ2VsZW1lbnQjbG9zZSc6IHRoaXMuX29uSGFuZGxlRWxlbWVudExvc2UsXG4gICAgICAgICAgICAnZWxlbWVudCNzZXQ6YW5jaG9yJzogdGhpcy5fb25TZXRIYW5kbGVBbGlnbm1lbnQsXG4gICAgICAgICAgICAnZWxlbWVudCNzZXQ6bWFyZ2luJzogdGhpcy5fb25TZXRIYW5kbGVBbGlnbm1lbnQsXG4gICAgICAgICAgICAnZWxlbWVudCNzZXQ6cGl2b3QnOiB0aGlzLl9vblNldEhhbmRsZUFsaWdubWVudFxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLl90b2dnbGVMaWZlY3ljbGVMaXN0ZW5lcnMoJ29uJyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRmlyZWQgd2hlbmV2ZXIgdGhlIHNjcm9sbCB2YWx1ZSBjaGFuZ2VzLlxuICAgICAqXG4gICAgICogQGV2ZW50IFNjcm9sbGJhckNvbXBvbmVudCNzZXQ6dmFsdWVcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gdmFsdWUgLSBUaGUgY3VycmVudCBzY3JvbGwgdmFsdWUuXG4gICAgICovXG5cbiAgICAvKipcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gb25Pck9mZiAtICdvbicgb3IgJ29mZicuXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBfdG9nZ2xlTGlmZWN5Y2xlTGlzdGVuZXJzKG9uT3JPZmYpIHtcbiAgICAgICAgdGhpc1tvbk9yT2ZmXSgnc2V0X3ZhbHVlJywgdGhpcy5fb25TZXRWYWx1ZSwgdGhpcyk7XG4gICAgICAgIHRoaXNbb25Pck9mZl0oJ3NldF9oYW5kbGVTaXplJywgdGhpcy5fb25TZXRIYW5kbGVTaXplLCB0aGlzKTtcbiAgICAgICAgdGhpc1tvbk9yT2ZmXSgnc2V0X29yaWVudGF0aW9uJywgdGhpcy5fb25TZXRPcmllbnRhdGlvbiwgdGhpcyk7XG5cbiAgICAgICAgLy8gVE9ETyBIYW5kbGUgc2Nyb2xsd2hlZWwgZXZlbnRzXG4gICAgfVxuXG4gICAgX29uSGFuZGxlRWxlbWVudEdhaW4oKSB7XG4gICAgICAgIHRoaXMuX2Rlc3Ryb3lEcmFnSGVscGVyKCk7XG4gICAgICAgIHRoaXMuX2hhbmRsZURyYWdIZWxwZXIgPSBuZXcgRWxlbWVudERyYWdIZWxwZXIodGhpcy5faGFuZGxlUmVmZXJlbmNlLmVudGl0eS5lbGVtZW50LCB0aGlzLl9nZXRBeGlzKCkpO1xuICAgICAgICB0aGlzLl9oYW5kbGVEcmFnSGVscGVyLm9uKCdkcmFnOm1vdmUnLCB0aGlzLl9vbkhhbmRsZURyYWcsIHRoaXMpO1xuXG4gICAgICAgIHRoaXMuX3VwZGF0ZUhhbmRsZVBvc2l0aW9uQW5kU2l6ZSgpO1xuICAgIH1cblxuICAgIF9vbkhhbmRsZUVsZW1lbnRMb3NlKCkge1xuICAgICAgICB0aGlzLl9kZXN0cm95RHJhZ0hlbHBlcigpO1xuICAgIH1cblxuICAgIF9vbkhhbmRsZURyYWcocG9zaXRpb24pIHtcbiAgICAgICAgaWYgKHRoaXMuX2hhbmRsZVJlZmVyZW5jZS5lbnRpdHkgJiYgdGhpcy5lbmFibGVkICYmIHRoaXMuZW50aXR5LmVuYWJsZWQpIHtcbiAgICAgICAgICAgIHRoaXMudmFsdWUgPSB0aGlzLl9oYW5kbGVQb3NpdGlvblRvU2Nyb2xsVmFsdWUocG9zaXRpb25bdGhpcy5fZ2V0QXhpcygpXSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfb25TZXRWYWx1ZShuYW1lLCBvbGRWYWx1ZSwgbmV3VmFsdWUpIHtcbiAgICAgICAgaWYgKE1hdGguYWJzKG5ld1ZhbHVlIC0gb2xkVmFsdWUpID4gMWUtNSkge1xuICAgICAgICAgICAgdGhpcy5kYXRhLnZhbHVlID0gbWF0aC5jbGFtcChuZXdWYWx1ZSwgMCwgMSk7XG4gICAgICAgICAgICB0aGlzLl91cGRhdGVIYW5kbGVQb3NpdGlvbkFuZFNpemUoKTtcbiAgICAgICAgICAgIHRoaXMuZmlyZSgnc2V0OnZhbHVlJywgdGhpcy5kYXRhLnZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9vblNldEhhbmRsZVNpemUobmFtZSwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmIChNYXRoLmFicyhuZXdWYWx1ZSAtIG9sZFZhbHVlKSA+IDFlLTUpIHtcbiAgICAgICAgICAgIHRoaXMuZGF0YS5oYW5kbGVTaXplID0gbWF0aC5jbGFtcChuZXdWYWx1ZSwgMCwgMSk7XG4gICAgICAgICAgICB0aGlzLl91cGRhdGVIYW5kbGVQb3NpdGlvbkFuZFNpemUoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9vblNldEhhbmRsZUFsaWdubWVudCgpIHtcbiAgICAgICAgdGhpcy5fdXBkYXRlSGFuZGxlUG9zaXRpb25BbmRTaXplKCk7XG4gICAgfVxuXG4gICAgX29uU2V0T3JpZW50YXRpb24obmFtZSwgb2xkVmFsdWUsIG5ld1ZhbHVlKSB7XG4gICAgICAgIGlmIChuZXdWYWx1ZSAhPT0gb2xkVmFsdWUgJiYgdGhpcy5faGFuZGxlUmVmZXJlbmNlLmhhc0NvbXBvbmVudCgnZWxlbWVudCcpKSB7XG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVSZWZlcmVuY2UuZW50aXR5LmVsZW1lbnRbdGhpcy5fZ2V0T3Bwb3NpdGVEaW1lbnNpb24oKV0gPSAwO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgX3VwZGF0ZUhhbmRsZVBvc2l0aW9uQW5kU2l6ZSgpIHtcbiAgICAgICAgY29uc3QgaGFuZGxlRW50aXR5ID0gdGhpcy5faGFuZGxlUmVmZXJlbmNlLmVudGl0eTtcbiAgICAgICAgY29uc3QgaGFuZGxlRWxlbWVudCA9IGhhbmRsZUVudGl0eSAmJiBoYW5kbGVFbnRpdHkuZWxlbWVudDtcblxuICAgICAgICBpZiAoaGFuZGxlRW50aXR5KSB7XG4gICAgICAgICAgICBjb25zdCBwb3NpdGlvbiA9IGhhbmRsZUVudGl0eS5nZXRMb2NhbFBvc2l0aW9uKCk7XG4gICAgICAgICAgICBwb3NpdGlvblt0aGlzLl9nZXRBeGlzKCldID0gdGhpcy5fZ2V0SGFuZGxlUG9zaXRpb24oKTtcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZVJlZmVyZW5jZS5lbnRpdHkuc2V0TG9jYWxQb3NpdGlvbihwb3NpdGlvbik7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoaGFuZGxlRWxlbWVudCkge1xuICAgICAgICAgICAgaGFuZGxlRWxlbWVudFt0aGlzLl9nZXREaW1lbnNpb24oKV0gPSB0aGlzLl9nZXRIYW5kbGVMZW5ndGgoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9oYW5kbGVQb3NpdGlvblRvU2Nyb2xsVmFsdWUoaGFuZGxlUG9zaXRpb24pIHtcbiAgICAgICAgcmV0dXJuIGhhbmRsZVBvc2l0aW9uICogdGhpcy5fZ2V0U2lnbigpIC8gdGhpcy5fZ2V0VXNhYmxlVHJhY2tMZW5ndGgoKTtcbiAgICB9XG5cbiAgICBfc2Nyb2xsVmFsdWVUb0hhbmRsZVBvc2l0aW9uKHZhbHVlKSB7XG4gICAgICAgIHJldHVybiB2YWx1ZSAqIHRoaXMuX2dldFNpZ24oKSAqIHRoaXMuX2dldFVzYWJsZVRyYWNrTGVuZ3RoKCk7XG4gICAgfVxuXG4gICAgX2dldFVzYWJsZVRyYWNrTGVuZ3RoKCkge1xuICAgICAgICByZXR1cm4gTWF0aC5tYXgodGhpcy5fZ2V0VHJhY2tMZW5ndGgoKSAtIHRoaXMuX2dldEhhbmRsZUxlbmd0aCgpLCAwLjAwMSk7XG4gICAgfVxuXG4gICAgX2dldFRyYWNrTGVuZ3RoKCkge1xuICAgICAgICBpZiAodGhpcy5lbnRpdHkuZWxlbWVudCkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMub3JpZW50YXRpb24gPT09IE9SSUVOVEFUSU9OX0hPUklaT05UQUwgPyB0aGlzLmVudGl0eS5lbGVtZW50LmNhbGN1bGF0ZWRXaWR0aCA6IHRoaXMuZW50aXR5LmVsZW1lbnQuY2FsY3VsYXRlZEhlaWdodDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiAwO1xuICAgIH1cblxuICAgIF9nZXRIYW5kbGVMZW5ndGgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9nZXRUcmFja0xlbmd0aCgpICogdGhpcy5oYW5kbGVTaXplO1xuICAgIH1cblxuICAgIF9nZXRIYW5kbGVQb3NpdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Njcm9sbFZhbHVlVG9IYW5kbGVQb3NpdGlvbih0aGlzLnZhbHVlKTtcbiAgICB9XG5cbiAgICBfZ2V0U2lnbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3JpZW50YXRpb24gPT09IE9SSUVOVEFUSU9OX0hPUklaT05UQUwgPyAxIDogLTE7XG4gICAgfVxuXG4gICAgX2dldEF4aXMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm9yaWVudGF0aW9uID09PSBPUklFTlRBVElPTl9IT1JJWk9OVEFMID8gJ3gnIDogJ3knO1xuICAgIH1cblxuICAgIF9nZXREaW1lbnNpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLm9yaWVudGF0aW9uID09PSBPUklFTlRBVElPTl9IT1JJWk9OVEFMID8gJ3dpZHRoJyA6ICdoZWlnaHQnO1xuICAgIH1cblxuICAgIF9nZXRPcHBvc2l0ZURpbWVuc2lvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMub3JpZW50YXRpb24gPT09IE9SSUVOVEFUSU9OX0hPUklaT05UQUwgPyAnaGVpZ2h0JyA6ICd3aWR0aCc7XG4gICAgfVxuXG4gICAgX2Rlc3Ryb3lEcmFnSGVscGVyKCkge1xuICAgICAgICBpZiAodGhpcy5faGFuZGxlRHJhZ0hlbHBlcikge1xuICAgICAgICAgICAgdGhpcy5faGFuZGxlRHJhZ0hlbHBlci5kZXN0cm95KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfc2V0SGFuZGxlRHJhZ2dpbmdFbmFibGVkKGVuYWJsZWQpIHtcbiAgICAgICAgaWYgKHRoaXMuX2hhbmRsZURyYWdIZWxwZXIpIHtcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZURyYWdIZWxwZXIuZW5hYmxlZCA9IGVuYWJsZWQ7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbkVuYWJsZSgpIHtcbiAgICAgICAgdGhpcy5faGFuZGxlUmVmZXJlbmNlLm9uUGFyZW50Q29tcG9uZW50RW5hYmxlKCk7XG4gICAgICAgIHRoaXMuX3NldEhhbmRsZURyYWdnaW5nRW5hYmxlZCh0cnVlKTtcbiAgICB9XG5cbiAgICBvbkRpc2FibGUoKSB7XG4gICAgICAgIHRoaXMuX3NldEhhbmRsZURyYWdnaW5nRW5hYmxlZChmYWxzZSk7XG4gICAgfVxuXG4gICAgb25SZW1vdmUoKSB7XG4gICAgICAgIHRoaXMuX2Rlc3Ryb3lEcmFnSGVscGVyKCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUxpZmVjeWNsZUxpc3RlbmVycygnb2ZmJyk7XG4gICAgfVxufVxuXG5leHBvcnQgeyBTY3JvbGxiYXJDb21wb25lbnQgfTtcbiJdLCJuYW1lcyI6WyJTY3JvbGxiYXJDb21wb25lbnQiLCJDb21wb25lbnQiLCJjb25zdHJ1Y3RvciIsInN5c3RlbSIsImVudGl0eSIsIl9oYW5kbGVSZWZlcmVuY2UiLCJFbnRpdHlSZWZlcmVuY2UiLCJfb25IYW5kbGVFbGVtZW50R2FpbiIsIl9vbkhhbmRsZUVsZW1lbnRMb3NlIiwiX29uU2V0SGFuZGxlQWxpZ25tZW50IiwiX3RvZ2dsZUxpZmVjeWNsZUxpc3RlbmVycyIsIm9uT3JPZmYiLCJfb25TZXRWYWx1ZSIsIl9vblNldEhhbmRsZVNpemUiLCJfb25TZXRPcmllbnRhdGlvbiIsIl9kZXN0cm95RHJhZ0hlbHBlciIsIl9oYW5kbGVEcmFnSGVscGVyIiwiRWxlbWVudERyYWdIZWxwZXIiLCJlbGVtZW50IiwiX2dldEF4aXMiLCJvbiIsIl9vbkhhbmRsZURyYWciLCJfdXBkYXRlSGFuZGxlUG9zaXRpb25BbmRTaXplIiwicG9zaXRpb24iLCJlbmFibGVkIiwidmFsdWUiLCJfaGFuZGxlUG9zaXRpb25Ub1Njcm9sbFZhbHVlIiwibmFtZSIsIm9sZFZhbHVlIiwibmV3VmFsdWUiLCJNYXRoIiwiYWJzIiwiZGF0YSIsIm1hdGgiLCJjbGFtcCIsImZpcmUiLCJoYW5kbGVTaXplIiwiaGFzQ29tcG9uZW50IiwiX2dldE9wcG9zaXRlRGltZW5zaW9uIiwiaGFuZGxlRW50aXR5IiwiaGFuZGxlRWxlbWVudCIsImdldExvY2FsUG9zaXRpb24iLCJfZ2V0SGFuZGxlUG9zaXRpb24iLCJzZXRMb2NhbFBvc2l0aW9uIiwiX2dldERpbWVuc2lvbiIsIl9nZXRIYW5kbGVMZW5ndGgiLCJoYW5kbGVQb3NpdGlvbiIsIl9nZXRTaWduIiwiX2dldFVzYWJsZVRyYWNrTGVuZ3RoIiwiX3Njcm9sbFZhbHVlVG9IYW5kbGVQb3NpdGlvbiIsIm1heCIsIl9nZXRUcmFja0xlbmd0aCIsIm9yaWVudGF0aW9uIiwiT1JJRU5UQVRJT05fSE9SSVpPTlRBTCIsImNhbGN1bGF0ZWRXaWR0aCIsImNhbGN1bGF0ZWRIZWlnaHQiLCJkZXN0cm95IiwiX3NldEhhbmRsZURyYWdnaW5nRW5hYmxlZCIsIm9uRW5hYmxlIiwib25QYXJlbnRDb21wb25lbnRFbmFibGUiLCJvbkRpc2FibGUiLCJvblJlbW92ZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUErQkEsTUFBTUEsa0JBQU4sU0FBaUNDLFNBQWpDLENBQTJDO0FBT3ZDQyxFQUFBQSxXQUFXLENBQUNDLE1BQUQsRUFBU0MsTUFBVCxFQUFpQjtJQUN4QixLQUFNRCxDQUFBQSxNQUFOLEVBQWNDLE1BQWQsQ0FBQSxDQUFBO0lBRUEsSUFBS0MsQ0FBQUEsZ0JBQUwsR0FBd0IsSUFBSUMsZUFBSixDQUFvQixJQUFwQixFQUEwQixjQUExQixFQUEwQztBQUM5RCxNQUFBLGNBQUEsRUFBZ0IsS0FBS0Msb0JBRHlDO0FBRTlELE1BQUEsY0FBQSxFQUFnQixLQUFLQyxvQkFGeUM7QUFHOUQsTUFBQSxvQkFBQSxFQUFzQixL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
