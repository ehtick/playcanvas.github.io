/**
 * @license
 * PlayCanvas Engine v1.59.0-preview revision 797466563 (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
import { Debug } from '../../../core/debug.js';
import { Component } from '../component.js';
import { ComponentSystem } from '../system.js';
import { AudioListenerComponent } from './component.js';
import { AudioListenerComponentData } from './data.js';

const _schema = ['enabled'];

class AudioListenerComponentSystem extends ComponentSystem {
  constructor(app) {
    super(app);
    this.id = 'audiolistener';
    this.ComponentType = AudioListenerComponent;
    this.DataType = AudioListenerComponentData;
    this.schema = _schema;
    this.manager = app.soundManager;
    Debug.assert(this.manager, "AudioSourceComponentSystem cannot be created witout sound manager");
    this.current = null;
    this.app.systems.on('update', this.onUpdate, this);
  }
  initializeComponentData(component, data, properties) {
    properties = ['enabled'];
    super.initializeComponentData(component, data, properties);
  }
  onUpdate(dt) {
    if (this.current) {
      const position = this.current.getPosition();
      this.manager.listener.setPosition(position);
      const wtm = this.current.getWorldTransform();
      this.manager.listener.setOrientation(wtm);
    }
  }
  destroy() {
    super.destroy();
    this.app.systems.off('update', this.onUpdate, this);
  }
}
Component._buildAccessors(AudioListenerComponent.prototype, _schema);

export { AudioListenerComponentSystem };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3lzdGVtLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvZnJhbWV3b3JrL2NvbXBvbmVudHMvYXVkaW8tbGlzdGVuZXIvc3lzdGVtLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERlYnVnIH0gZnJvbSAnLi4vLi4vLi4vY29yZS9kZWJ1Zy5qcyc7XG5cbmltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJy4uL2NvbXBvbmVudC5qcyc7XG5pbXBvcnQgeyBDb21wb25lbnRTeXN0ZW0gfSBmcm9tICcuLi9zeXN0ZW0uanMnO1xuXG5pbXBvcnQgeyBBdWRpb0xpc3RlbmVyQ29tcG9uZW50IH0gZnJvbSAnLi9jb21wb25lbnQuanMnO1xuaW1wb3J0IHsgQXVkaW9MaXN0ZW5lckNvbXBvbmVudERhdGEgfSBmcm9tICcuL2RhdGEuanMnO1xuXG5jb25zdCBfc2NoZW1hID0gWydlbmFibGVkJ107XG5cbi8qKlxuICogQ29tcG9uZW50IFN5c3RlbSBmb3IgYWRkaW5nIGFuZCByZW1vdmluZyB7QGxpbmsgQXVkaW9Db21wb25lbnR9IG9iamVjdHMgdG8gRW50aXRpZXMuXG4gKlxuICogQGF1Z21lbnRzIENvbXBvbmVudFN5c3RlbVxuICogQGlnbm9yZVxuICovXG5jbGFzcyBBdWRpb0xpc3RlbmVyQ29tcG9uZW50U3lzdGVtIGV4dGVuZHMgQ29tcG9uZW50U3lzdGVtIHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBuZXcgQXVkaW9MaXN0ZW5lckNvbXBvbmVudFN5c3RlbSBpbnN0YW5jZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7aW1wb3J0KCcuLi8uLi9hcHAtYmFzZS5qcycpLkFwcEJhc2V9IGFwcCAtIFRoZSBhcHBsaWNhdGlvbiBtYW5hZ2luZyB0aGlzIHN5c3RlbS5cbiAgICAgKiBAaGlkZWNvbnN0cnVjdG9yXG4gICAgICovXG4gICAgY29uc3RydWN0b3IoYXBwKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG5cbiAgICAgICAgdGhpcy5pZCA9ICdhdWRpb2xpc3RlbmVyJztcblxuICAgICAgICB0aGlzLkNvbXBvbmVudFR5cGUgPSBBdWRpb0xpc3RlbmVyQ29tcG9uZW50O1xuICAgICAgICB0aGlzLkRhdGFUeXBlID0gQXVkaW9MaXN0ZW5lckNvbXBvbmVudERhdGE7XG5cbiAgICAgICAgdGhpcy5zY2hlbWEgPSBfc2NoZW1hO1xuXG4gICAgICAgIHRoaXMubWFuYWdlciA9IGFwcC5zb3VuZE1hbmFnZXI7XG4gICAgICAgIERlYnVnLmFzc2VydCh0aGlzLm1hbmFnZXIsIFwiQXVkaW9Tb3VyY2VDb21wb25lbnRTeXN0ZW0gY2Fubm90IGJlIGNyZWF0ZWQgd2l0b3V0IHNvdW5kIG1hbmFnZXJcIik7XG5cbiAgICAgICAgdGhpcy5jdXJyZW50ID0gbnVsbDtcblxuICAgICAgICB0aGlzLmFwcC5zeXN0ZW1zLm9uKCd1cGRhdGUnLCB0aGlzLm9uVXBkYXRlLCB0aGlzKTtcbiAgICB9XG5cbiAgICBpbml0aWFsaXplQ29tcG9uZW50RGF0YShjb21wb25lbnQsIGRhdGEsIHByb3BlcnRpZXMpIHtcbiAgICAgICAgcHJvcGVydGllcyA9IFsnZW5hYmxlZCddO1xuXG4gICAgICAgIHN1cGVyLmluaXRpYWxpemVDb21wb25lbnREYXRhKGNvbXBvbmVudCwgZGF0YSwgcHJvcGVydGllcyk7XG4gICAgfVxuXG4gICAgb25VcGRhdGUoZHQpIHtcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudCkge1xuICAgICAgICAgICAgY29uc3QgcG9zaXRpb24gPSB0aGlzLmN1cnJlbnQuZ2V0UG9zaXRpb24oKTtcbiAgICAgICAgICAgIHRoaXMubWFuYWdlci5saXN0ZW5lci5zZXRQb3NpdGlvbihwb3NpdGlvbik7XG5cbiAgICAgICAgICAgIGNvbnN0IHd0bSA9IHRoaXMuY3VycmVudC5nZXRXb3JsZFRyYW5zZm9ybSgpO1xuICAgICAgICAgICAgdGhpcy5tYW5hZ2VyLmxpc3RlbmVyLnNldE9yaWVudGF0aW9uKHd0bSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBkZXN0cm95KCkge1xuICAgICAgICBzdXBlci5kZXN0cm95KCk7XG5cbiAgICAgICAgdGhpcy5hcHAuc3lzdGVtcy5vZmYoJ3VwZGF0ZScsIHRoaXMub25VcGRhdGUsIHRoaXMpO1xuICAgIH1cbn1cblxuQ29tcG9uZW50Ll9idWlsZEFjY2Vzc29ycyhBdWRpb0xpc3RlbmVyQ29tcG9uZW50LnByb3RvdHlwZSwgX3NjaGVtYSk7XG5cbmV4cG9ydCB7IEF1ZGlvTGlzdGVuZXJDb21wb25lbnRTeXN0ZW0gfTtcbiJdLCJuYW1lcyI6WyJfc2NoZW1hIiwiQXVkaW9MaXN0ZW5lckNvbXBvbmVudFN5c3RlbSIsIkNvbXBvbmVudFN5c3RlbSIsImNvbnN0cnVjdG9yIiwiYXBwIiwiaWQiLCJDb21wb25lbnRUeXBlIiwiQXVkaW9MaXN0ZW5lckNvbXBvbmVudCIsIkRhdGFUeXBlIiwiQXVkaW9MaXN0ZW5lckNvbXBvbmVudERhdGEiLCJzY2hlbWEiLCJtYW5hZ2VyIiwic291bmRNYW5hZ2VyIiwiRGVidWciLCJhc3NlcnQiLCJjdXJyZW50Iiwic3lzdGVtcyIsIm9uIiwib25VcGRhdGUiLCJpbml0aWFsaXplQ29tcG9uZW50RGF0YSIsImNvbXBvbmVudCIsImRhdGEiLCJwcm9wZXJ0aWVzIiwiZHQiLCJwb3NpdGlvbiIsImdldFBvc2l0aW9uIiwibGlzdGVuZXIiLCJzZXRQb3NpdGlvbiIsInd0bSIsImdldFdvcmxkVHJhbnNmb3JtIiwic2V0T3JpZW50YXRpb24iLCJkZXN0cm95Iiwib2ZmIiwiQ29tcG9uZW50IiwiX2J1aWxkQWNjZXNzb3JzIiwicHJvdG90eXBlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQVFBLE1BQU1BLE9BQU8sR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFBOztBQVEzQixNQUFNQyw0QkFBNEIsU0FBU0MsZUFBZSxDQUFDO0VBT3ZEQyxXQUFXLENBQUNDLEdBQUcsRUFBRTtJQUNiLEtBQUssQ0FBQ0EsR0FBRyxDQUFDLENBQUE7SUFFVixJQUFJLENBQUNDLEVBQUUsR0FBRyxlQUFlLENBQUE7SUFFekIsSUFBSSxDQUFDQyxhQUFhLEdBQUdDLHNCQUFzQixDQUFBO0lBQzNDLElBQUksQ0FBQ0MsUUFBUSxHQUFHQywwQkFBMEIsQ0FBQTtJQUUxQyxJQUFJLENBQUNDLE1BQU0sR0FBR1YsT0FBTyxDQUFBO0FBRXJCLElBQUEsSUFBSSxDQUFDVyxPQUFPLEdBQUdQLEdBQUcsQ0FBQ1EsWUFBWSxDQUFBO0lBQy9CQyxLQUFLLENBQUNDLE1BQU0sQ0FBQyxJQUFJLENBQUNILE9BQU8sRUFBRSxtRUFBbUUsQ0FBQyxDQUFBO0lBRS9GLElBQUksQ0FBQ0ksT0FBTyxHQUFHLElBQUksQ0FBQTtBQUVuQixJQUFBLElBQUksQ0FBQ1gsR0FBRyxDQUFDWSxPQUFPLENBQUNDLEVBQUUsQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDQyxRQUFRLEVBQUUsSUFBSSxDQUFDLENBQUE7QUFDdEQsR0FBQTtBQUVBQyxFQUFBQSx1QkFBdUIsQ0FBQ0MsU0FBUyxFQUFFQyxJQUFJLEVBQUVDLFVBQVUsRUFBRTtJQUNqREEsVUFBVSxHQUFHLENBQUMsU0FBUyxDQUFDLENBQUE7SUFFeEIsS0FBSyxDQUFDSCx1QkFBdUIsQ0FBQ0MsU0FBUyxFQUFFQyxJQUFJLEVBQUVDLFVBQVUsQ0FBQyxDQUFBO0FBQzlELEdBQUE7RUFFQUosUUFBUSxDQUFDSyxFQUFFLEVBQUU7SUFDVCxJQUFJLElBQUksQ0FBQ1IsT0FBTyxFQUFFO0FBQ2QsTUFBQSxNQUFNUyxRQUFRLEdBQUcsSUFBSSxDQUFDVCxPQUFPLENBQUNVLFdBQVcsRUFBRSxDQUFBO01BQzNDLElBQUksQ0FBQ2QsT0FBTyxDQUFDZSxRQUFRLENBQUNDLFdBQVcsQ0FBQ0gsUUFBUSxDQUFDLENBQUE7QUFFM0MsTUFBQSxNQUFNSSxHQUFHLEdBQUcsSUFBSSxDQUFDYixPQUFPLENBQUNjLGlCQUFpQixFQUFFLENBQUE7TUFDNUMsSUFBSSxDQUFDbEIsT0FBTyxDQUFDZSxRQUFRLENBQUNJLGNBQWMsQ0FBQ0YsR0FBRyxDQUFDLENBQUE7QUFDN0MsS0FBQTtBQUNKLEdBQUE7QUFFQUcsRUFBQUEsT0FBTyxHQUFHO0lBQ04sS0FBSyxDQUFDQSxPQUFPLEVBQUUsQ0FBQTtBQUVmLElBQUEsSUFBSSxDQUFDM0IsR0FBRyxDQUFDWSxPQUFPLENBQUNnQixHQUFHLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQ2QsUUFBUSxFQUFFLElBQUksQ0FBQyxDQUFBO0FBQ3ZELEdBQUE7QUFDSixDQUFBO0FBRUFlLFNBQVMsQ0FBQ0MsZUFBZSxDQUFDM0Isc0JBQXNCLENBQUM0QixTQUFTLEVBQUVuQyxPQUFPLENBQUM7Ozs7In0=
