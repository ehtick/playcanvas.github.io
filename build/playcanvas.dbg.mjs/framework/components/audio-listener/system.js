/**
 * @license
 * PlayCanvas Engine v1.57.0 revision f1998a31e (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
import { Debug } from '../../../core/debug.js';
import { Component } from '../component.js';
import { ComponentSystem } from '../system.js';
import { AudioListenerComponent } from './component.js';
import { AudioListenerComponentData } from './data.js';

const _schema = ['enabled'];

class AudioListenerComponentSystem extends ComponentSystem {
  constructor(app) {
    super(app);
    this.id = 'audiolistener';
    this.ComponentType = AudioListenerComponent;
    this.DataType = AudioListenerComponentData;
    this.schema = _schema;
    this.manager = app.soundManager;
    Debug.assert(this.manager, "AudioSourceComponentSystem cannot be created witout sound manager");
    this.current = null;
    this.app.systems.on('update', this.onUpdate, this);
  }

  initializeComponentData(component, data, properties) {
    properties = ['enabled'];
    super.initializeComponentData(component, data, properties);
  }

  onUpdate(dt) {
    if (this.current) {
      const position = this.current.getPosition();
      this.manager.listener.setPosition(position);
      const wtm = this.current.getWorldTransform();
      this.manager.listener.setOrientation(wtm);
    }
  }

  destroy() {
    super.destroy();
    this.app.systems.off('update', this.onUpdate, this);
  }

}

Component._buildAccessors(AudioListenerComponent.prototype, _schema);

export { AudioListenerComponentSystem };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3lzdGVtLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvZnJhbWV3b3JrL2NvbXBvbmVudHMvYXVkaW8tbGlzdGVuZXIvc3lzdGVtLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERlYnVnIH0gZnJvbSAnLi4vLi4vLi4vY29yZS9kZWJ1Zy5qcyc7XG5cbmltcG9ydCB7IENvbXBvbmVudCB9IGZyb20gJy4uL2NvbXBvbmVudC5qcyc7XG5pbXBvcnQgeyBDb21wb25lbnRTeXN0ZW0gfSBmcm9tICcuLi9zeXN0ZW0uanMnO1xuXG5pbXBvcnQgeyBBdWRpb0xpc3RlbmVyQ29tcG9uZW50IH0gZnJvbSAnLi9jb21wb25lbnQuanMnO1xuaW1wb3J0IHsgQXVkaW9MaXN0ZW5lckNvbXBvbmVudERhdGEgfSBmcm9tICcuL2RhdGEuanMnO1xuXG4vKiogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vLi4vc291bmQvbWFuYWdlci5qcycpLlNvdW5kTWFuYWdlcn0gU291bmRNYW5hZ2VyICovXG4vKiogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vYXBwLWJhc2UuanMnKS5BcHBCYXNlfSBBcHBCYXNlICovXG5cbmNvbnN0IF9zY2hlbWEgPSBbJ2VuYWJsZWQnXTtcblxuLyoqXG4gKiBDb21wb25lbnQgU3lzdGVtIGZvciBhZGRpbmcgYW5kIHJlbW92aW5nIHtAbGluayBBdWRpb0NvbXBvbmVudH0gb2JqZWN0cyB0byBFbnRpdGllcy5cbiAqXG4gKiBAYXVnbWVudHMgQ29tcG9uZW50U3lzdGVtXG4gKiBAaWdub3JlXG4gKi9cbmNsYXNzIEF1ZGlvTGlzdGVuZXJDb21wb25lbnRTeXN0ZW0gZXh0ZW5kcyBDb21wb25lbnRTeXN0ZW0ge1xuICAgIC8qKlxuICAgICAqIENyZWF0ZSBhIG5ldyBBdWRpb0xpc3RlbmVyQ29tcG9uZW50U3lzdGVtIGluc3RhbmNlLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtBcHBCYXNlfSBhcHAgLSBUaGUgYXBwbGljYXRpb24gbWFuYWdpbmcgdGhpcyBzeXN0ZW0uXG4gICAgICogQGhpZGVjb25zdHJ1Y3RvclxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKGFwcCkge1xuICAgICAgICBzdXBlcihhcHApO1xuXG4gICAgICAgIHRoaXMuaWQgPSAnYXVkaW9saXN0ZW5lcic7XG5cbiAgICAgICAgdGhpcy5Db21wb25lbnRUeXBlID0gQXVkaW9MaXN0ZW5lckNvbXBvbmVudDtcbiAgICAgICAgdGhpcy5EYXRhVHlwZSA9IEF1ZGlvTGlzdGVuZXJDb21wb25lbnREYXRhO1xuXG4gICAgICAgIHRoaXMuc2NoZW1hID0gX3NjaGVtYTtcblxuICAgICAgICB0aGlzLm1hbmFnZXIgPSBhcHAuc291bmRNYW5hZ2VyO1xuICAgICAgICBEZWJ1Zy5hc3NlcnQodGhpcy5tYW5hZ2VyLCBcIkF1ZGlvU291cmNlQ29tcG9uZW50U3lzdGVtIGNhbm5vdCBiZSBjcmVhdGVkIHdpdG91dCBzb3VuZCBtYW5hZ2VyXCIpO1xuXG4gICAgICAgIHRoaXMuY3VycmVudCA9IG51bGw7XG5cbiAgICAgICAgdGhpcy5hcHAuc3lzdGVtcy5vbigndXBkYXRlJywgdGhpcy5vblVwZGF0ZSwgdGhpcyk7XG4gICAgfVxuXG4gICAgaW5pdGlhbGl6ZUNvbXBvbmVudERhdGEoY29tcG9uZW50LCBkYXRhLCBwcm9wZXJ0aWVzKSB7XG4gICAgICAgIHByb3BlcnRpZXMgPSBbJ2VuYWJsZWQnXTtcblxuICAgICAgICBzdXBlci5pbml0aWFsaXplQ29tcG9uZW50RGF0YShjb21wb25lbnQsIGRhdGEsIHByb3BlcnRpZXMpO1xuICAgIH1cblxuICAgIG9uVXBkYXRlKGR0KSB7XG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gdGhpcy5jdXJyZW50LmdldFBvc2l0aW9uKCk7XG4gICAgICAgICAgICB0aGlzLm1hbmFnZXIubGlzdGVuZXIuc2V0UG9zaXRpb24ocG9zaXRpb24pO1xuXG4gICAgICAgICAgICBjb25zdCB3dG0gPSB0aGlzLmN1cnJlbnQuZ2V0V29ybGRUcmFuc2Zvcm0oKTtcbiAgICAgICAgICAgIHRoaXMubWFuYWdlci5saXN0ZW5lci5zZXRPcmllbnRhdGlvbih3dG0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZGVzdHJveSgpIHtcbiAgICAgICAgc3VwZXIuZGVzdHJveSgpO1xuXG4gICAgICAgIHRoaXMuYXBwLnN5c3RlbXMub2ZmKCd1cGRhdGUnLCB0aGlzLm9uVXBkYXRlLCB0aGlzKTtcbiAgICB9XG59XG5cbkNvbXBvbmVudC5fYnVpbGRBY2Nlc3NvcnMoQXVkaW9MaXN0ZW5lckNvbXBvbmVudC5wcm90b3R5cGUsIF9zY2hlbWEpO1xuXG5leHBvcnQgeyBBdWRpb0xpc3RlbmVyQ29tcG9uZW50U3lzdGVtIH07XG4iXSwibmFtZXMiOlsiX3NjaGVtYSIsIkF1ZGlvTGlzdGVuZXJDb21wb25lbnRTeXN0ZW0iLCJDb21wb25lbnRTeXN0ZW0iLCJjb25zdHJ1Y3RvciIsImFwcCIsImlkIiwiQ29tcG9uZW50VHlwZSIsIkF1ZGlvTGlzdGVuZXJDb21wb25lbnQiLCJEYXRhVHlwZSIsIkF1ZGlvTGlzdGVuZXJDb21wb25lbnREYXRhIiwic2NoZW1hIiwibWFuYWdlciIsInNvdW5kTWFuYWdlciIsIkRlYnVnIiwiYXNzZXJ0IiwiY3VycmVudCIsInN5c3RlbXMiLCJvbiIsIm9uVXBkYXRlIiwiaW5pdGlhbGl6ZUNvbXBvbmVudERhdGEiLCJjb21wb25lbnQiLCJkYXRhIiwicHJvcGVydGllcyIsImR0IiwicG9zaXRpb24iLCJnZXRQb3NpdGlvbiIsImxpc3RlbmVyIiwic2V0UG9zaXRpb24iLCJ3dG0iLCJnZXRXb3JsZFRyYW5zZm9ybSIsInNldE9yaWVudGF0aW9uIiwiZGVzdHJveSIsIm9mZiIsIkNvbXBvbmVudCIsIl9idWlsZEFjY2Vzc29ycyIsInByb3RvdHlwZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFXQSxNQUFNQSxPQUFPLEdBQUcsQ0FBQyxTQUFELENBQWhCLENBQUE7O0FBUUEsTUFBTUMsNEJBQU4sU0FBMkNDLGVBQTNDLENBQTJEO0VBT3ZEQyxXQUFXLENBQUNDLEdBQUQsRUFBTTtBQUNiLElBQUEsS0FBQSxDQUFNQSxHQUFOLENBQUEsQ0FBQTtJQUVBLElBQUtDLENBQUFBLEVBQUwsR0FBVSxlQUFWLENBQUE7SUFFQSxJQUFLQyxDQUFBQSxhQUFMLEdBQXFCQyxzQkFBckIsQ0FBQTtJQUNBLElBQUtDLENBQUFBLFFBQUwsR0FBZ0JDLDBCQUFoQixDQUFBO0lBRUEsSUFBS0MsQ0FBQUEsTUFBTCxHQUFjVixPQUFkLENBQUE7QUFFQSxJQUFBLElBQUEsQ0FBS1csT0FBTCxHQUFlUCxHQUFHLENBQUNRLFlBQW5CLENBQUE7QUFDQUMsSUFBQUEsS0FBSyxDQUFDQyxNQUFOLENBQWEsSUFBS0gsQ0FBQUEsT0FBbEIsRUFBMkIsbUVBQTNCLENBQUEsQ0FBQTtJQUVBLElBQUtJLENBQUFBLE9BQUwsR0FBZSxJQUFmLENBQUE7SUFFQSxJQUFLWCxDQUFBQSxHQUFMLENBQVNZLE9BQVQsQ0FBaUJDLEVBQWpCLENBQW9CLFFBQXBCLEVBQThCLElBQUEsQ0FBS0MsUUFBbkMsRUFBNkMsSUFBN0MsQ0FBQSxDQUFBO0FBQ0gsR0FBQTs7QUFFREMsRUFBQUEsdUJBQXVCLENBQUNDLFNBQUQsRUFBWUMsSUFBWixFQUFrQkMsVUFBbEIsRUFBOEI7SUFDakRBLFVBQVUsR0FBRyxDQUFDLFNBQUQsQ0FBYixDQUFBO0FBRUEsSUFBQSxLQUFBLENBQU1ILHVCQUFOLENBQThCQyxTQUE5QixFQUF5Q0MsSUFBekMsRUFBK0NDLFVBQS9DLENBQUEsQ0FBQTtBQUNILEdBQUE7O0VBRURKLFFBQVEsQ0FBQ0ssRUFBRCxFQUFLO0lBQ1QsSUFBSSxJQUFBLENBQUtSLE9BQVQsRUFBa0I7QUFDZCxNQUFBLE1BQU1TLFFBQVEsR0FBRyxJQUFBLENBQUtULE9BQUwsQ0FBYVUsV0FBYixFQUFqQixDQUFBO0FBQ0EsTUFBQSxJQUFBLENBQUtkLE9BQUwsQ0FBYWUsUUFBYixDQUFzQkMsV0FBdEIsQ0FBa0NILFFBQWxDLENBQUEsQ0FBQTtBQUVBLE1BQUEsTUFBTUksR0FBRyxHQUFHLElBQUEsQ0FBS2IsT0FBTCxDQUFhYyxpQkFBYixFQUFaLENBQUE7QUFDQSxNQUFBLElBQUEsQ0FBS2xCLE9BQUwsQ0FBYWUsUUFBYixDQUFzQkksY0FBdEIsQ0FBcUNGLEdBQXJDLENBQUEsQ0FBQTtBQUNILEtBQUE7QUFDSixHQUFBOztBQUVERyxFQUFBQSxPQUFPLEdBQUc7QUFDTixJQUFBLEtBQUEsQ0FBTUEsT0FBTixFQUFBLENBQUE7SUFFQSxJQUFLM0IsQ0FBQUEsR0FBTCxDQUFTWSxPQUFULENBQWlCZ0IsR0FBakIsQ0FBcUIsUUFBckIsRUFBK0IsSUFBQSxDQUFLZCxRQUFwQyxFQUE4QyxJQUE5QyxDQUFBLENBQUE7QUFDSCxHQUFBOztBQTdDc0QsQ0FBQTs7QUFnRDNEZSxTQUFTLENBQUNDLGVBQVYsQ0FBMEIzQixzQkFBc0IsQ0FBQzRCLFNBQWpELEVBQTREbkMsT0FBNUQsQ0FBQTs7OzsifQ==
