/**
 * @license
 * PlayCanvas Engine v1.57.0 revision f1998a31e (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
import { Vec2 } from '../../../math/vec2.js';
import { Vec4 } from '../../../math/vec4.js';
import { ORIENTATION_HORIZONTAL } from '../../../scene/constants.js';
import { FITTING_NONE } from './constants.js';
import { Component } from '../component.js';
import { LayoutCalculator } from './layout-calculator.js';

function getElement(entity) {
  return entity.element;
}

function isEnabledAndHasEnabledElement(entity) {
  return entity.enabled && entity.element && entity.element.enabled;
}

class LayoutGroupComponent extends Component {
  constructor(system, entity) {
    super(system, entity);
    this._orientation = ORIENTATION_HORIZONTAL;
    this._reverseX = false;
    this._reverseY = true;
    this._alignment = new Vec2(0, 1);
    this._padding = new Vec4();
    this._spacing = new Vec2();
    this._widthFitting = FITTING_NONE;
    this._heightFitting = FITTING_NONE;
    this._wrap = false;
    this._layoutCalculator = new LayoutCalculator();

    this._listenForReflowEvents(this.entity, 'on');

    this.entity.children.forEach(child => {
      this._listenForReflowEvents(child, 'on');
    });
    this.entity.on('childinsert', this._onChildInsert, this);
    this.entity.on('childremove', this._onChildRemove, this);
    system.app.systems.element.on('add', this._onElementOrLayoutComponentAdd, this);
    system.app.systems.element.on('beforeremove', this._onElementOrLayoutComponentRemove, this);
    system.app.systems.layoutchild.on('add', this._onElementOrLayoutComponentAdd, this);
    system.app.systems.layoutchild.on('beforeremove', this._onElementOrLayoutComponentRemove, this);
  }

  set orientation(value) {
    if (value !== this._orientation) {
      this._orientation = value;

      this._scheduleReflow();
    }
  }

  get orientation() {
    return this._orientation;
  }

  set reverseX(value) {
    if (value !== this._reverseX) {
      this._reverseX = value;

      this._scheduleReflow();
    }
  }

  get reverseX() {
    return this._reverseX;
  }

  set reverseY(value) {
    if (value !== this._reverseY) {
      this._reverseY = value;

      this._scheduleReflow();
    }
  }

  get reverseY() {
    return this._reverseY;
  }

  set alignment(value) {
    if (!value.equals(this._alignment)) {
      this._alignment.copy(value);

      this._scheduleReflow();
    }
  }

  get alignment() {
    return this._alignment;
  }

  set padding(value) {
    if (!value.equals(this._padding)) {
      this._padding.copy(value);

      this._scheduleReflow();
    }
  }

  get padding() {
    return this._padding;
  }

  set spacing(value) {
    if (!value.equals(this._spacing)) {
      this._spacing.copy(value);

      this._scheduleReflow();
    }
  }

  get spacing() {
    return this._spacing;
  }

  set widthFitting(value) {
    if (value !== this._widthFitting) {
      this._widthFitting = value;

      this._scheduleReflow();
    }
  }

  get widthFitting() {
    return this._widthFitting;
  }

  set heightFitting(value) {
    if (value !== this._heightFitting) {
      this._heightFitting = value;

      this._scheduleReflow();
    }
  }

  get heightFitting() {
    return this._heightFitting;
  }

  set wrap(value) {
    if (value !== this._wrap) {
      this._wrap = value;

      this._scheduleReflow();
    }
  }

  get wrap() {
    return this._wrap;
  }

  _isSelfOrChild(entity) {
    return entity === this.entity || this.entity.children.indexOf(entity) !== -1;
  }

  _listenForReflowEvents(target, onOff) {
    if (target.element) {
      target.element[onOff]('enableelement', this._scheduleReflow, this);
      target.element[onOff]('disableelement', this._scheduleReflow, this);
      target.element[onOff]('resize', this._scheduleReflow, this);
      target.element[onOff]('set:pivot', this._scheduleReflow, this);
    }

    if (target.layoutchild) {
      target.layoutchild[onOff]('set_enabled', this._scheduleReflow, this);
      target.layoutchild[onOff]('resize', this._scheduleReflow, this);
    }
  }

  _onElementOrLayoutComponentAdd(entity) {
    if (this._isSelfOrChild(entity)) {
      this._listenForReflowEvents(entity, 'on');

      this._scheduleReflow();
    }
  }

  _onElementOrLayoutComponentRemove(entity) {
    if (this._isSelfOrChild(entity)) {
      this._listenForReflowEvents(entity, 'off');

      this._scheduleReflow();
    }
  }

  _onChildInsert(child) {
    this._listenForReflowEvents(child, 'on');

    this._scheduleReflow();
  }

  _onChildRemove(child) {
    this._listenForReflowEvents(child, 'off');

    this._scheduleReflow();
  }

  _scheduleReflow() {
    if (this.enabled && this.entity && this.entity.enabled && !this._isPerformingReflow) {
      this.system.scheduleReflow(this);
    }
  }

  reflow() {
    const container = getElement(this.entity);
    const elements = this.entity.children.filter(isEnabledAndHasEnabledElement).map(getElement);

    if (!container || elements.length === 0) {
      return;
    }

    const containerWidth = Math.max(container.calculatedWidth, 0);
    const containerHeight = Math.max(container.calculatedHeight, 0);
    const options = {
      orientation: this._orientation,
      reverseX: this._reverseX,
      reverseY: this._reverseY,
      alignment: this._alignment,
      padding: this._padding,
      spacing: this._spacing,
      widthFitting: this._widthFitting,
      heightFitting: this._heightFitting,
      wrap: this._wrap,
      containerSize: new Vec2(containerWidth, containerHeight)
    };
    this._isPerformingReflow = true;

    const layoutInfo = this._layoutCalculator.calculateLayout(elements, options);

    this._isPerformingReflow = false;
    this.fire('reflow', layoutInfo);
  }

  onEnable() {
    this._scheduleReflow();
  }

  onRemove() {
    this.entity.off('childinsert', this._onChildInsert, this);
    this.entity.off('childremove', this._onChildRemove, this);

    this._listenForReflowEvents(this.entity, 'off');

    this.entity.children.forEach(child => {
      this._listenForReflowEvents(child, 'off');
    });
    this.system.app.systems.element.off('add', this._onElementOrLayoutComponentAdd, this);
    this.system.app.systems.element.off('beforeremove', this._onElementOrLayoutComponentRemove, this);
    this.system.app.systems.layoutchild.off('add', this._onElementOrLayoutComponentAdd, this);
    this.system.app.systems.layoutchild.off('beforeremove', this._onElementOrLayoutComponentRemove, this);
  }

}

export { LayoutGroupComponent };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9uZW50LmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvZnJhbWV3b3JrL2NvbXBvbmVudHMvbGF5b3V0LWdyb3VwL2NvbXBvbmVudC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBWZWMyIH0gZnJvbSAnLi4vLi4vLi4vbWF0aC92ZWMyLmpzJztcbmltcG9ydCB7IFZlYzQgfSBmcm9tICcuLi8uLi8uLi9tYXRoL3ZlYzQuanMnO1xuXG5pbXBvcnQgeyBPUklFTlRBVElPTl9IT1JJWk9OVEFMIH0gZnJvbSAnLi4vLi4vLi4vc2NlbmUvY29uc3RhbnRzLmpzJztcblxuaW1wb3J0IHsgRklUVElOR19OT05FIH0gZnJvbSAnLi9jb25zdGFudHMuanMnO1xuaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAnLi4vY29tcG9uZW50LmpzJztcbmltcG9ydCB7IExheW91dENhbGN1bGF0b3IgfSBmcm9tICcuL2xheW91dC1jYWxjdWxhdG9yLmpzJztcblxuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJy4uLy4uL2VudGl0eS5qcycpLkVudGl0eX0gRW50aXR5ICovXG4vKiogQHR5cGVkZWYge2ltcG9ydCgnLi9zeXN0ZW0uanMnKS5MYXlvdXRHcm91cENvbXBvbmVudFN5c3RlbX0gTGF5b3V0R3JvdXBDb21wb25lbnRTeXN0ZW0gKi9cblxuZnVuY3Rpb24gZ2V0RWxlbWVudChlbnRpdHkpIHtcbiAgICByZXR1cm4gZW50aXR5LmVsZW1lbnQ7XG59XG5cbmZ1bmN0aW9uIGlzRW5hYmxlZEFuZEhhc0VuYWJsZWRFbGVtZW50KGVudGl0eSkge1xuICAgIHJldHVybiBlbnRpdHkuZW5hYmxlZCAmJiBlbnRpdHkuZWxlbWVudCAmJiBlbnRpdHkuZWxlbWVudC5lbmFibGVkO1xufVxuXG4vKipcbiAqIEEgTGF5b3V0R3JvdXBDb21wb25lbnQgZW5hYmxlcyB0aGUgRW50aXR5IHRvIHBvc2l0aW9uIGFuZCBzY2FsZSBjaGlsZCB7QGxpbmsgRWxlbWVudENvbXBvbmVudH1zXG4gKiBhY2NvcmRpbmcgdG8gY29uZmlndXJhYmxlIGxheW91dCBydWxlcy5cbiAqXG4gKiBAYXVnbWVudHMgQ29tcG9uZW50XG4gKi9cbmNsYXNzIExheW91dEdyb3VwQ29tcG9uZW50IGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgICAvKipcbiAgICAgKiBDcmVhdGUgYSBuZXcgTGF5b3V0R3JvdXBDb21wb25lbnQgaW5zdGFuY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge0xheW91dEdyb3VwQ29tcG9uZW50U3lzdGVtfSBzeXN0ZW0gLSBUaGUgQ29tcG9uZW50U3lzdGVtIHRoYXQgY3JlYXRlZCB0aGlzXG4gICAgICogQ29tcG9uZW50LlxuICAgICAqIEBwYXJhbSB7RW50aXR5fSBlbnRpdHkgLSBUaGUgRW50aXR5IHRoYXQgdGhpcyBDb21wb25lbnQgaXMgYXR0YWNoZWQgdG8uXG4gICAgICovXG4gICAgY29uc3RydWN0b3Ioc3lzdGVtLCBlbnRpdHkpIHtcbiAgICAgICAgc3VwZXIoc3lzdGVtLCBlbnRpdHkpO1xuXG4gICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuICAgICAgICB0aGlzLl9vcmllbnRhdGlvbiA9IE9SSUVOVEFUSU9OX0hPUklaT05UQUw7XG4gICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuICAgICAgICB0aGlzLl9yZXZlcnNlWCA9IGZhbHNlO1xuICAgICAgICAvKiogQHByaXZhdGUgKi9cbiAgICAgICAgdGhpcy5fcmV2ZXJzZVkgPSB0cnVlO1xuICAgICAgICAvKiogQHByaXZhdGUgKi9cbiAgICAgICAgdGhpcy5fYWxpZ25tZW50ID0gbmV3IFZlYzIoMCwgMSk7XG4gICAgICAgIC8qKiBAcHJpdmF0ZSAqL1xuICAgICAgICB0aGlzLl9wYWRkaW5nID0gbmV3IFZlYzQoKTtcbiAgICAgICAgLyoqIEBwcml2YXRlICovXG4gICAgICAgIHRoaXMuX3NwYWNpbmcgPSBuZXcgVmVjMigpO1xuICAgICAgICAvKiogQHByaXZhdGUgKi9cbiAgICAgICAgdGhpcy5fd2lkdGhGaXR0aW5nID0gRklUVElOR19OT05FO1xuICAgICAgICAvKiogQHByaXZhdGUgKi9cbiAgICAgICAgdGhpcy5faGVpZ2h0Rml0dGluZyA9IEZJVFRJTkdfTk9ORTtcbiAgICAgICAgLyoqIEBwcml2YXRlICovXG4gICAgICAgIHRoaXMuX3dyYXAgPSBmYWxzZTtcbiAgICAgICAgLyoqIEBwcml2YXRlICovXG4gICAgICAgIHRoaXMuX2xheW91dENhbGN1bGF0b3IgPSBuZXcgTGF5b3V0Q2FsY3VsYXRvcigpO1xuXG4gICAgICAgIC8vIExpc3RlbiBmb3IgdGhlIGdyb3VwIGNvbnRhaW5lciBiZWluZyByZXNpemVkXG4gICAgICAgIHRoaXMuX2xpc3RlbkZvclJlZmxvd0V2ZW50cyh0aGlzLmVudGl0eSwgJ29uJyk7XG5cbiAgICAgICAgLy8gTGlzdGVuIHRvIGV4aXN0aW5nIGNoaWxkcmVuIGJlaW5nIHJlc2l6ZWRcbiAgICAgICAgdGhpcy5lbnRpdHkuY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2xpc3RlbkZvclJlZmxvd0V2ZW50cyhjaGlsZCwgJ29uJyk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIExpc3RlbiB0byBuZXdseSBhZGRlZCBjaGlsZHJlbiBiZWluZyByZXNpemVkXG4gICAgICAgIHRoaXMuZW50aXR5Lm9uKCdjaGlsZGluc2VydCcsIHRoaXMuX29uQ2hpbGRJbnNlcnQsIHRoaXMpO1xuICAgICAgICB0aGlzLmVudGl0eS5vbignY2hpbGRyZW1vdmUnLCB0aGlzLl9vbkNoaWxkUmVtb3ZlLCB0aGlzKTtcblxuICAgICAgICAvLyBMaXN0ZW4gZm9yIEVsZW1lbnRDb21wb25lbnRzIGFuZCBMYXlvdXRDaGlsZENvbXBvbmVudHMgYmVpbmcgYWRkZWRcbiAgICAgICAgLy8gdG8gc2VsZiBvciB0byBjaGlsZHJlbiAtIGNvdmVycyBjYXNlcyB3aGVyZSB0aGV5IGFyZSBub3QgYWxyZWFkeVxuICAgICAgICAvLyBwcmVzZW50IGF0IHRoZSBwb2ludCB3aGVuIHRoaXMgY29tcG9uZW50IGlzIGNvbnN0cnVjdGVkLlxuICAgICAgICBzeXN0ZW0uYXBwLnN5c3RlbXMuZWxlbWVudC5vbignYWRkJywgdGhpcy5fb25FbGVtZW50T3JMYXlvdXRDb21wb25lbnRBZGQsIHRoaXMpO1xuICAgICAgICBzeXN0ZW0uYXBwLnN5c3RlbXMuZWxlbWVudC5vbignYmVmb3JlcmVtb3ZlJywgdGhpcy5fb25FbGVtZW50T3JMYXlvdXRDb21wb25lbnRSZW1vdmUsIHRoaXMpO1xuICAgICAgICBzeXN0ZW0uYXBwLnN5c3RlbXMubGF5b3V0Y2hpbGQub24oJ2FkZCcsIHRoaXMuX29uRWxlbWVudE9yTGF5b3V0Q29tcG9uZW50QWRkLCB0aGlzKTtcbiAgICAgICAgc3lzdGVtLmFwcC5zeXN0ZW1zLmxheW91dGNoaWxkLm9uKCdiZWZvcmVyZW1vdmUnLCB0aGlzLl9vbkVsZW1lbnRPckxheW91dENvbXBvbmVudFJlbW92ZSwgdGhpcyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogV2hldGhlciB0aGUgbGF5b3V0IHNob3VsZCBydW4gaG9yaXpvbnRhbGx5IG9yIHZlcnRpY2FsbHkuIENhbiBiZTpcbiAgICAgKlxuICAgICAqIC0ge0BsaW5rIE9SSUVOVEFUSU9OX0hPUklaT05UQUx9XG4gICAgICogLSB7QGxpbmsgT1JJRU5UQVRJT05fVkVSVElDQUx9XG4gICAgICpcbiAgICAgKiBEZWZhdWx0cyB0byB7QGxpbmsgT1JJRU5UQVRJT05fSE9SSVpPTlRBTH0uXG4gICAgICpcbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqL1xuICAgIHNldCBvcmllbnRhdGlvbih2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgIT09IHRoaXMuX29yaWVudGF0aW9uKSB7XG4gICAgICAgICAgICB0aGlzLl9vcmllbnRhdGlvbiA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5fc2NoZWR1bGVSZWZsb3coKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldCBvcmllbnRhdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX29yaWVudGF0aW9uO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldmVyc2VzIHRoZSBvcmRlciBvZiBjaGlsZHJlbiBhbG9uZyB0aGUgeCBheGlzLiBEZWZhdWx0cyB0byBmYWxzZS5cbiAgICAgKlxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIHNldCByZXZlcnNlWCh2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgIT09IHRoaXMuX3JldmVyc2VYKSB7XG4gICAgICAgICAgICB0aGlzLl9yZXZlcnNlWCA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5fc2NoZWR1bGVSZWZsb3coKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldCByZXZlcnNlWCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JldmVyc2VYO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJldmVyc2VzIHRoZSBvcmRlciBvZiBjaGlsZHJlbiBhbG9uZyB0aGUgeSBheGlzLiBEZWZhdWx0cyB0byB0cnVlLlxuICAgICAqXG4gICAgICogQHR5cGUge2Jvb2xlYW59XG4gICAgICovXG4gICAgc2V0IHJldmVyc2VZKHZhbHVlKSB7XG4gICAgICAgIGlmICh2YWx1ZSAhPT0gdGhpcy5fcmV2ZXJzZVkpIHtcbiAgICAgICAgICAgIHRoaXMuX3JldmVyc2VZID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLl9zY2hlZHVsZVJlZmxvdygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0IHJldmVyc2VZKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcmV2ZXJzZVk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogU3BlY2lmaWVzIHRoZSBob3Jpem9udGFsIGFuZCB2ZXJ0aWNhbCBhbGlnbm1lbnQgb2YgY2hpbGQgZWxlbWVudHMuIFZhbHVlcyByYW5nZSBmcm9tIDAgdG8gMVxuICAgICAqIHdoZXJlIFswLCAwXSBpcyB0aGUgYm90dG9tIGxlZnQgYW5kIFsxLCAxXSBpcyB0aGUgdG9wIHJpZ2h0LiBEZWZhdWx0cyB0byBbMCwgMV0uXG4gICAgICpcbiAgICAgKiBAdHlwZSB7VmVjMn1cbiAgICAgKi9cbiAgICBzZXQgYWxpZ25tZW50KHZhbHVlKSB7XG4gICAgICAgIGlmICghdmFsdWUuZXF1YWxzKHRoaXMuX2FsaWdubWVudCkpIHtcbiAgICAgICAgICAgIHRoaXMuX2FsaWdubWVudC5jb3B5KHZhbHVlKTtcbiAgICAgICAgICAgIHRoaXMuX3NjaGVkdWxlUmVmbG93KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXQgYWxpZ25tZW50KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fYWxpZ25tZW50O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFBhZGRpbmcgdG8gYmUgYXBwbGllZCBpbnNpZGUgdGhlIGNvbnRhaW5lciBiZWZvcmUgcG9zaXRpb25pbmcgYW55IGNoaWxkcmVuLiBTcGVjaWZpZWQgYXNcbiAgICAgKiBsZWZ0LCBib3R0b20sIHJpZ2h0IGFuZCB0b3AgdmFsdWVzLiBEZWZhdWx0cyB0byBbMCwgMCwgMCwgMF0gKG5vIHBhZGRpbmcpLlxuICAgICAqXG4gICAgICogQHR5cGUge1ZlYzR9XG4gICAgICovXG4gICAgc2V0IHBhZGRpbmcodmFsdWUpIHtcbiAgICAgICAgaWYgKCF2YWx1ZS5lcXVhbHModGhpcy5fcGFkZGluZykpIHtcbiAgICAgICAgICAgIHRoaXMuX3BhZGRpbmcuY29weSh2YWx1ZSk7XG4gICAgICAgICAgICB0aGlzLl9zY2hlZHVsZVJlZmxvdygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0IHBhZGRpbmcoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wYWRkaW5nO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNwYWNpbmcgdG8gYmUgYXBwbGllZCBiZXR3ZWVuIGVhY2ggY2hpbGQgZWxlbWVudC4gRGVmYXVsdHMgdG8gWzAsIDBdIChubyBzcGFjaW5nKS5cbiAgICAgKlxuICAgICAqIEB0eXBlIHtWZWMyfVxuICAgICAqL1xuICAgIHNldCBzcGFjaW5nKHZhbHVlKSB7XG4gICAgICAgIGlmICghdmFsdWUuZXF1YWxzKHRoaXMuX3NwYWNpbmcpKSB7XG4gICAgICAgICAgICB0aGlzLl9zcGFjaW5nLmNvcHkodmFsdWUpO1xuICAgICAgICAgICAgdGhpcy5fc2NoZWR1bGVSZWZsb3coKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldCBzcGFjaW5nKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fc3BhY2luZztcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBGaXR0aW5nIGxvZ2ljIHRvIGJlIGFwcGxpZWQgd2hlbiBwb3NpdGlvbmluZyBhbmQgc2NhbGluZyBjaGlsZCBlbGVtZW50cy4gQ2FuIGJlOlxuICAgICAqXG4gICAgICogLSB7QGxpbmsgRklUVElOR19OT05FfTogQ2hpbGQgZWxlbWVudHMgd2lsbCBiZSByZW5kZXJlZCBhdCB0aGVpciBuYXR1cmFsIHNpemUuXG4gICAgICogLSB7QGxpbmsgRklUVElOR19TVFJFVENIfTogV2hlbiB0aGUgbmF0dXJhbCBzaXplIG9mIGFsbCBjaGlsZCBlbGVtZW50cyBkb2VzIG5vdCBmaWxsIHRoZSB3aWR0aFxuICAgICAqIG9mIHRoZSBjb250YWluZXIsIGNoaWxkcmVuIHdpbGwgYmUgc3RyZXRjaGVkIHRvIGZpdC4gVGhlIHJ1bGVzIGZvciBob3cgZWFjaCBjaGlsZCB3aWxsIGJlXG4gICAgICogc3RyZXRjaGVkIGFyZSBvdXRsaW5lZCBiZWxvdzpcbiAgICAgKiAgIDEuIFN1bSB0aGUge0BsaW5rIExheW91dENoaWxkQ29tcG9uZW50I2ZpdFdpZHRoUHJvcG9ydGlvbn0gdmFsdWVzIG9mIGVhY2ggY2hpbGQgYW5kIG5vcm1hbGl6ZVxuICAgICAqIHNvIHRoYXQgYWxsIHZhbHVlcyBzdW0gdG8gMS5cbiAgICAgKiAgIDIuIEFwcGx5IHRoZSBuYXR1cmFsIHdpZHRoIG9mIGVhY2ggY2hpbGQuXG4gICAgICogICAzLiBJZiB0aGVyZSBpcyBzcGFjZSByZW1haW5pbmcgaW4gdGhlIGNvbnRhaW5lciwgZGlzdHJpYnV0ZSBpdCB0byBlYWNoIGNoaWxkIGJhc2VkIG9uIHRoZVxuICAgICAqIG5vcm1hbGl6ZWQge0BsaW5rIExheW91dENoaWxkQ29tcG9uZW50I2ZpdFdpZHRoUHJvcG9ydGlvbn0gdmFsdWVzLCBidXQgZG8gbm90IGV4Y2VlZCB0aGVcbiAgICAgKiB7QGxpbmsgTGF5b3V0Q2hpbGRDb21wb25lbnQjbWF4V2lkdGh9IG9mIGVhY2ggY2hpbGQuXG4gICAgICogLSB7QGxpbmsgRklUVElOR19TSFJJTkt9OiBXaGVuIHRoZSBuYXR1cmFsIHNpemUgb2YgYWxsIGNoaWxkIGVsZW1lbnRzIG92ZXJmbG93cyB0aGUgd2lkdGggb2YgdGhlXG4gICAgICogY29udGFpbmVyLCBjaGlsZHJlbiB3aWxsIGJlIHNocnVuayB0byBmaXQuIFRoZSBydWxlcyBmb3IgaG93IGVhY2ggY2hpbGQgd2lsbCBiZSBzdHJldGNoZWQgYXJlXG4gICAgICogb3V0bGluZWQgYmVsb3c6XG4gICAgICogICAxLiBTdW0gdGhlIHtAbGluayBMYXlvdXRDaGlsZENvbXBvbmVudCNmaXRXaWR0aFByb3BvcnRpb259IHZhbHVlcyBvZiBlYWNoIGNoaWxkIGFuZCBub3JtYWxpemVcbiAgICAgKiBzbyB0aGF0IGFsbCB2YWx1ZXMgc3VtIHRvIDEuXG4gICAgICogICAyLiBBcHBseSB0aGUgbmF0dXJhbCB3aWR0aCBvZiBlYWNoIGNoaWxkLlxuICAgICAqICAgMy4gSWYgdGhlIG5ldyB0b3RhbCB3aWR0aCBvZiBhbGwgY2hpbGRyZW4gZXhjZWVkcyB0aGUgYXZhaWxhYmxlIHNwYWNlIG9mIHRoZSBjb250YWluZXIsIHJlZHVjZVxuICAgICAqIGVhY2ggY2hpbGQncyB3aWR0aCBwcm9wb3J0aW9uYWxseSBiYXNlZCBvbiB0aGUgbm9ybWFsaXplZCB7QGxpbmtcbiAgICAgKiBMYXlvdXRDaGlsZENvbXBvbmVudCNmaXRXaWR0aFByb3BvcnRpb259IHZhbHVlcywgYnV0IGRvIG5vdCBleGNlZWQgdGhlIHtAbGlua1xuICAgICAqIExheW91dENoaWxkQ29tcG9uZW50I21pbldpZHRofSBvZiBlYWNoIGNoaWxkLlxuICAgICAqIC0ge0BsaW5rIEZJVFRJTkdfQk9USH06IEFwcGxpZXMgYm90aCBTVFJFVENIIGFuZCBTSFJJTksgbG9naWMgYXMgbmVjZXNzYXJ5LlxuICAgICAqXG4gICAgICogRGVmYXVsdHMgdG8ge0BsaW5rIEZJVFRJTkdfTk9ORX0uXG4gICAgICpcbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqL1xuICAgIHNldCB3aWR0aEZpdHRpbmcodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlICE9PSB0aGlzLl93aWR0aEZpdHRpbmcpIHtcbiAgICAgICAgICAgIHRoaXMuX3dpZHRoRml0dGluZyA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5fc2NoZWR1bGVSZWZsb3coKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldCB3aWR0aEZpdHRpbmcoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl93aWR0aEZpdHRpbmc7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSWRlbnRpY2FsIHRvIHtAbGluayBMYXlvdXRHcm91cENvbXBvbmVudCN3aWR0aEZpdHRpbmd9IGJ1dCBmb3IgdGhlIFkgYXhpcy4gRGVmYXVsdHMgdG9cbiAgICAgKiB7QGxpbmsgRklUVElOR19OT05FfS5cbiAgICAgKlxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgc2V0IGhlaWdodEZpdHRpbmcodmFsdWUpIHtcbiAgICAgICAgaWYgKHZhbHVlICE9PSB0aGlzLl9oZWlnaHRGaXR0aW5nKSB7XG4gICAgICAgICAgICB0aGlzLl9oZWlnaHRGaXR0aW5nID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLl9zY2hlZHVsZVJlZmxvdygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0IGhlaWdodEZpdHRpbmcoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9oZWlnaHRGaXR0aW5nO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFdoZXRoZXIgb3Igbm90IHRvIHdyYXAgY2hpbGRyZW4gb250byBhIG5ldyByb3cvY29sdW1uIHdoZW4gdGhlIHNpemUgb2YgdGhlIGNvbnRhaW5lciBpc1xuICAgICAqIGV4Y2VlZGVkLiBEZWZhdWx0cyB0byBmYWxzZSwgd2hpY2ggbWVhbnMgdGhhdCBjaGlsZHJlbiB3aWxsIGJlIGJlIHJlbmRlcmVkIGluIGEgc2luZ2xlIHJvd1xuICAgICAqIChob3Jpem9udGFsIG9yaWVudGF0aW9uKSBvciBjb2x1bW4gKHZlcnRpY2FsIG9yaWVudGF0aW9uKS4gTm90ZSB0aGF0IHNldHRpbmcgd3JhcCB0byB0cnVlXG4gICAgICogbWFrZXMgaXQgaW1wb3NzaWJsZSBmb3IgdGhlIHtAbGluayBGSVRUSU5HX0JPVEh9IGZpdHRpbmcgbW9kZSB0byBvcGVyYXRlIGluIGFueSBsb2dpY2FsXG4gICAgICogbWFubmVyLiBGb3IgdGhpcyByZWFzb24sIHdoZW4gd3JhcCBpcyB0cnVlLCBhIHtAbGluayBMYXlvdXRHcm91cENvbXBvbmVudCN3aWR0aEZpdHRpbmd9IG9yXG4gICAgICoge0BsaW5rIExheW91dEdyb3VwQ29tcG9uZW50I2hlaWdodEZpdHRpbmd9IG1vZGUgb2Yge0BsaW5rIEZJVFRJTkdfQk9USH0gd2lsbCBiZSBjb2VyY2VkIHRvXG4gICAgICoge0BsaW5rIEZJVFRJTkdfU1RSRVRDSH0uXG4gICAgICpcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBzZXQgd3JhcCh2YWx1ZSkge1xuICAgICAgICBpZiAodmFsdWUgIT09IHRoaXMuX3dyYXApIHtcbiAgICAgICAgICAgIHRoaXMuX3dyYXAgPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMuX3NjaGVkdWxlUmVmbG93KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXQgd3JhcCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3dyYXA7XG4gICAgfVxuXG4gICAgX2lzU2VsZk9yQ2hpbGQoZW50aXR5KSB7XG4gICAgICAgIHJldHVybiAoZW50aXR5ID09PSB0aGlzLmVudGl0eSkgfHwgKHRoaXMuZW50aXR5LmNoaWxkcmVuLmluZGV4T2YoZW50aXR5KSAhPT0gLTEpO1xuICAgIH1cblxuICAgIF9saXN0ZW5Gb3JSZWZsb3dFdmVudHModGFyZ2V0LCBvbk9mZikge1xuICAgICAgICBpZiAodGFyZ2V0LmVsZW1lbnQpIHtcbiAgICAgICAgICAgIHRhcmdldC5lbGVtZW50W29uT2ZmXSgnZW5hYmxlZWxlbWVudCcsIHRoaXMuX3NjaGVkdWxlUmVmbG93LCB0aGlzKTtcbiAgICAgICAgICAgIHRhcmdldC5lbGVtZW50W29uT2ZmXSgnZGlzYWJsZWVsZW1lbnQnLCB0aGlzLl9zY2hlZHVsZVJlZmxvdywgdGhpcyk7XG4gICAgICAgICAgICB0YXJnZXQuZWxlbWVudFtvbk9mZl0oJ3Jlc2l6ZScsIHRoaXMuX3NjaGVkdWxlUmVmbG93LCB0aGlzKTtcbiAgICAgICAgICAgIHRhcmdldC5lbGVtZW50W29uT2ZmXSgnc2V0OnBpdm90JywgdGhpcy5fc2NoZWR1bGVSZWZsb3csIHRoaXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRhcmdldC5sYXlvdXRjaGlsZCkge1xuICAgICAgICAgICAgdGFyZ2V0LmxheW91dGNoaWxkW29uT2ZmXSgnc2V0X2VuYWJsZWQnLCB0aGlzLl9zY2hlZHVsZVJlZmxvdywgdGhpcyk7XG4gICAgICAgICAgICB0YXJnZXQubGF5b3V0Y2hpbGRbb25PZmZdKCdyZXNpemUnLCB0aGlzLl9zY2hlZHVsZVJlZmxvdywgdGhpcyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBfb25FbGVtZW50T3JMYXlvdXRDb21wb25lbnRBZGQoZW50aXR5KSB7XG4gICAgICAgIGlmICh0aGlzLl9pc1NlbGZPckNoaWxkKGVudGl0eSkpIHtcbiAgICAgICAgICAgIHRoaXMuX2xpc3RlbkZvclJlZmxvd0V2ZW50cyhlbnRpdHksICdvbicpO1xuICAgICAgICAgICAgdGhpcy5fc2NoZWR1bGVSZWZsb3coKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9vbkVsZW1lbnRPckxheW91dENvbXBvbmVudFJlbW92ZShlbnRpdHkpIHtcbiAgICAgICAgaWYgKHRoaXMuX2lzU2VsZk9yQ2hpbGQoZW50aXR5KSkge1xuICAgICAgICAgICAgdGhpcy5fbGlzdGVuRm9yUmVmbG93RXZlbnRzKGVudGl0eSwgJ29mZicpO1xuICAgICAgICAgICAgdGhpcy5fc2NoZWR1bGVSZWZsb3coKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIF9vbkNoaWxkSW5zZXJ0KGNoaWxkKSB7XG4gICAgICAgIHRoaXMuX2xpc3RlbkZvclJlZmxvd0V2ZW50cyhjaGlsZCwgJ29uJyk7XG4gICAgICAgIHRoaXMuX3NjaGVkdWxlUmVmbG93KCk7XG4gICAgfVxuXG4gICAgX29uQ2hpbGRSZW1vdmUoY2hpbGQpIHtcbiAgICAgICAgdGhpcy5fbGlzdGVuRm9yUmVmbG93RXZlbnRzKGNoaWxkLCAnb2ZmJyk7XG4gICAgICAgIHRoaXMuX3NjaGVkdWxlUmVmbG93KCk7XG4gICAgfVxuXG4gICAgX3NjaGVkdWxlUmVmbG93KCkge1xuICAgICAgICBpZiAodGhpcy5lbmFibGVkICYmIHRoaXMuZW50aXR5ICYmIHRoaXMuZW50aXR5LmVuYWJsZWQgJiYgIXRoaXMuX2lzUGVyZm9ybWluZ1JlZmxvdykge1xuICAgICAgICAgICAgdGhpcy5zeXN0ZW0uc2NoZWR1bGVSZWZsb3codGhpcyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZWZsb3coKSB7XG4gICAgICAgIGNvbnN0IGNvbnRhaW5lciA9IGdldEVsZW1lbnQodGhpcy5lbnRpdHkpO1xuICAgICAgICBjb25zdCBlbGVtZW50cyA9IHRoaXMuZW50aXR5LmNoaWxkcmVuLmZpbHRlcihpc0VuYWJsZWRBbmRIYXNFbmFibGVkRWxlbWVudCkubWFwKGdldEVsZW1lbnQpO1xuXG4gICAgICAgIGlmICghY29udGFpbmVyIHx8IGVsZW1lbnRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY29udGFpbmVyV2lkdGggPSBNYXRoLm1heChjb250YWluZXIuY2FsY3VsYXRlZFdpZHRoLCAwKTtcbiAgICAgICAgY29uc3QgY29udGFpbmVySGVpZ2h0ID0gTWF0aC5tYXgoY29udGFpbmVyLmNhbGN1bGF0ZWRIZWlnaHQsIDApO1xuXG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICAgICAgICBvcmllbnRhdGlvbjogdGhpcy5fb3JpZW50YXRpb24sXG4gICAgICAgICAgICByZXZlcnNlWDogdGhpcy5fcmV2ZXJzZVgsXG4gICAgICAgICAgICByZXZlcnNlWTogdGhpcy5fcmV2ZXJzZVksXG4gICAgICAgICAgICBhbGlnbm1lbnQ6IHRoaXMuX2FsaWdubWVudCxcbiAgICAgICAgICAgIHBhZGRpbmc6IHRoaXMuX3BhZGRpbmcsXG4gICAgICAgICAgICBzcGFjaW5nOiB0aGlzLl9zcGFjaW5nLFxuICAgICAgICAgICAgd2lkdGhGaXR0aW5nOiB0aGlzLl93aWR0aEZpdHRpbmcsXG4gICAgICAgICAgICBoZWlnaHRGaXR0aW5nOiB0aGlzLl9oZWlnaHRGaXR0aW5nLFxuICAgICAgICAgICAgd3JhcDogdGhpcy5fd3JhcCxcbiAgICAgICAgICAgIGNvbnRhaW5lclNpemU6IG5ldyBWZWMyKGNvbnRhaW5lcldpZHRoLCBjb250YWluZXJIZWlnaHQpXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gSW4gb3JkZXIgdG8gcHJldmVudCByZWN1cnNpdmUgcmVmbG93IChpLmUuIHdoZXJlYnkgc2V0dGluZyB0aGUgc2l6ZSBvZlxuICAgICAgICAvLyBhIGNoaWxkIGVsZW1lbnQgdHJpZ2dlcnMgYW5vdGhlciByZWZsb3cgb24gdGhlIG5leHQgZnJhbWUsIGFuZCBzbyBvbilcbiAgICAgICAgLy8gd2UgZmxhZyB0aGF0IGEgcmVmbG93IGlzIGN1cnJlbnRseSBpbiBwcm9ncmVzcy5cbiAgICAgICAgdGhpcy5faXNQZXJmb3JtaW5nUmVmbG93ID0gdHJ1ZTtcbiAgICAgICAgY29uc3QgbGF5b3V0SW5mbyA9IHRoaXMuX2xheW91dENhbGN1bGF0b3IuY2FsY3VsYXRlTGF5b3V0KGVsZW1lbnRzLCBvcHRpb25zKTtcbiAgICAgICAgdGhpcy5faXNQZXJmb3JtaW5nUmVmbG93ID0gZmFsc2U7XG5cbiAgICAgICAgdGhpcy5maXJlKCdyZWZsb3cnLCBsYXlvdXRJbmZvKTtcbiAgICB9XG5cbiAgICBvbkVuYWJsZSgpIHtcbiAgICAgICAgdGhpcy5fc2NoZWR1bGVSZWZsb3coKTtcbiAgICB9XG5cbiAgICBvblJlbW92ZSgpIHtcbiAgICAgICAgdGhpcy5lbnRpdHkub2ZmKCdjaGlsZGluc2VydCcsIHRoaXMuX29uQ2hpbGRJbnNlcnQsIHRoaXMpO1xuICAgICAgICB0aGlzLmVudGl0eS5vZmYoJ2NoaWxkcmVtb3ZlJywgdGhpcy5fb25DaGlsZFJlbW92ZSwgdGhpcyk7XG5cbiAgICAgICAgdGhpcy5fbGlzdGVuRm9yUmVmbG93RXZlbnRzKHRoaXMuZW50aXR5LCAnb2ZmJyk7XG5cbiAgICAgICAgdGhpcy5lbnRpdHkuY2hpbGRyZW4uZm9yRWFjaCgoY2hpbGQpID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2xpc3RlbkZvclJlZmxvd0V2ZW50cyhjaGlsZCwgJ29mZicpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLnN5c3RlbS5hcHAuc3lzdGVtcy5lbGVtZW50Lm9mZignYWRkJywgdGhpcy5fb25FbGVtZW50T3JMYXlvdXRDb21wb25lbnRBZGQsIHRoaXMpO1xuICAgICAgICB0aGlzLnN5c3RlbS5hcHAuc3lzdGVtcy5lbGVtZW50Lm9mZignYmVmb3JlcmVtb3ZlJywgdGhpcy5fb25FbGVtZW50T3JMYXlvdXRDb21wb25lbnRSZW1vdmUsIHRoaXMpO1xuICAgICAgICB0aGlzLnN5c3RlbS5hcHAuc3lzdGVtcy5sYXlvdXRjaGlsZC5vZmYoJ2FkZCcsIHRoaXMuX29uRWxlbWVudE9yTGF5b3V0Q29tcG9uZW50QWRkLCB0aGlzKTtcbiAgICAgICAgdGhpcy5zeXN0ZW0uYXBwLnN5c3RlbXMubGF5b3V0Y2hpbGQub2ZmKCdiZWZvcmVyZW1vdmUnLCB0aGlzLl9vbkVsZW1lbnRPckxheW91dENvbXBvbmVudFJlbW92ZSwgdGhpcyk7XG4gICAgfVxufVxuXG5leHBvcnQgeyBMYXlvdXRHcm91cENvbXBvbmVudCB9O1xuIl0sIm5hbWVzIjpbImdldEVsZW1lbnQiLCJlbnRpdHkiLCJlbGVtZW50IiwiaXNFbmFibGVkQW5kSGFzRW5hYmxlZEVsZW1lbnQiLCJlbmFibGVkIiwiTGF5b3V0R3JvdXBDb21wb25lbnQiLCJDb21wb25lbnQiLCJjb25zdHJ1Y3RvciIsInN5c3RlbSIsIl9vcmllbnRhdGlvbiIsIk9SSUVOVEFUSU9OX0hPUklaT05UQUwiLCJfcmV2ZXJzZVgiLCJfcmV2ZXJzZVkiLCJfYWxpZ25tZW50IiwiVmVjMiIsIl9wYWRkaW5nIiwiVmVjNCIsIl9zcGFjaW5nIiwiX3dpZHRoRml0dGluZyIsIkZJVFRJTkdfTk9ORSIsIl9oZWlnaHRGaXR0aW5nIiwiX3dyYXAiLCJfbGF5b3V0Q2FsY3VsYXRvciIsIkxheW91dENhbGN1bGF0b3IiLCJfbGlzdGVuRm9yUmVmbG93RXZlbnRzIiwiY2hpbGRyZW4iLCJmb3JFYWNoIiwiY2hpbGQiLCJvbiIsIl9vbkNoaWxkSW5zZXJ0IiwiX29uQ2hpbGRSZW1vdmUiLCJhcHAiLCJzeXN0ZW1zIiwiX29uRWxlbWVudE9yTGF5b3V0Q29tcG9uZW50QWRkIiwiX29uRWxlbWVudE9yTGF5b3V0Q29tcG9uZW50UmVtb3ZlIiwibGF5b3V0Y2hpbGQiLCJvcmllbnRhdGlvbiIsInZhbHVlIiwiX3NjaGVkdWxlUmVmbG93IiwicmV2ZXJzZVgiLCJyZXZlcnNlWSIsImFsaWdubWVudCIsImVxdWFscyIsImNvcHkiLCJwYWRkaW5nIiwic3BhY2luZyIsIndpZHRoRml0dGluZyIsImhlaWdodEZpdHRpbmciLCJ3cmFwIiwiX2lzU2VsZk9yQ2hpbGQiLCJpbmRleE9mIiwidGFyZ2V0Iiwib25PZmYiLCJfaXNQZXJmb3JtaW5nUmVmbG93Iiwic2NoZWR1bGVSZWZsb3ciLCJyZWZsb3ciLCJjb250YWluZXIiLCJlbGVtZW50cyIsImZpbHRlciIsIm1hcCIsImxlbmd0aCIsImNvbnRhaW5lcldpZHRoIiwiTWF0aCIsIm1heCIsImNhbGN1bGF0ZWRXaWR0aCIsImNvbnRhaW5lckhlaWdodCIsImNhbGN1bGF0ZWRIZWlnaHQiLCJvcHRpb25zIiwiY29udGFpbmVyU2l6ZSIsImxheW91dEluZm8iLCJjYWxjdWxhdGVMYXlvdXQiLCJmaXJlIiwib25FbmFibGUiLCJvblJlbW92ZSIsIm9mZiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBWUEsU0FBU0EsVUFBVCxDQUFvQkMsTUFBcEIsRUFBNEI7RUFDeEIsT0FBT0EsTUFBTSxDQUFDQyxPQUFkLENBQUE7QUFDSCxDQUFBOztBQUVELFNBQVNDLDZCQUFULENBQXVDRixNQUF2QyxFQUErQztBQUMzQyxFQUFBLE9BQU9BLE1BQU0sQ0FBQ0csT0FBUCxJQUFrQkgsTUFBTSxDQUFDQyxPQUF6QixJQUFvQ0QsTUFBTSxDQUFDQyxPQUFQLENBQWVFLE9BQTFELENBQUE7QUFDSCxDQUFBOztBQVFELE1BQU1DLG9CQUFOLFNBQW1DQyxTQUFuQyxDQUE2QztBQVF6Q0MsRUFBQUEsV0FBVyxDQUFDQyxNQUFELEVBQVNQLE1BQVQsRUFBaUI7SUFDeEIsS0FBTU8sQ0FBQUEsTUFBTixFQUFjUCxNQUFkLENBQUEsQ0FBQTtJQUdBLElBQUtRLENBQUFBLFlBQUwsR0FBb0JDLHNCQUFwQixDQUFBO0lBRUEsSUFBS0MsQ0FBQUEsU0FBTCxHQUFpQixLQUFqQixDQUFBO0lBRUEsSUFBS0MsQ0FBQUEsU0FBTCxHQUFpQixJQUFqQixDQUFBO0lBRUEsSUFBS0MsQ0FBQUEsVUFBTCxHQUFrQixJQUFJQyxJQUFKLENBQVMsQ0FBVCxFQUFZLENBQVosQ0FBbEIsQ0FBQTtBQUVBLElBQUEsSUFBQSxDQUFLQyxRQUFMLEdBQWdCLElBQUlDLElBQUosRUFB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
