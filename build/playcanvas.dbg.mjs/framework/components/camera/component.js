/**
 * @license
 * PlayCanvas Engine v1.57.0 revision f1998a31e (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
import { LAYERID_UI, LAYERID_DEPTH, ASPECT_AUTO } from '../../../scene/constants.js';
import { Camera } from '../../../scene/camera.js';
import { Component } from '../component.js';
import { PostEffectQueue } from './post-effect-queue.js';
import { Debug } from '../../../core/debug.js';

const properties = [{
  name: 'aspectRatio',
  readonly: false
}, {
  name: 'aspectRatioMode',
  readonly: false
}, {
  name: 'calculateProjection',
  readonly: false
}, {
  name: 'calculateTransform',
  readonly: false
}, {
  name: 'clearColor',
  readonly: false
}, {
  name: 'cullFaces',
  readonly: false
}, {
  name: 'farClip',
  readonly: false
}, {
  name: 'flipFaces',
  readonly: false
}, {
  name: 'fov',
  readonly: false
}, {
  name: 'frustumCulling',
  readonly: false
}, {
  name: 'horizontalFov',
  readonly: false
}, {
  name: 'nearClip',
  readonly: false
}, {
  name: 'orthoHeight',
  readonly: false
}, {
  name: 'projection',
  readonly: false
}, {
  name: 'scissorRect',
  readonly: false
}, {
  name: 'aperture',
  readonly: false
}, {
  name: 'shutter',
  readonly: false
}, {
  name: 'sensitivity',
  readonly: false
}];

class CameraComponent extends Component {
  constructor(system, entity) {
    super(system, entity);
    this.onPostprocessing = null;
    this.onPreRender = null;
    this.onPostRender = null;
    this._renderSceneDepthMap = 0;
    this._renderSceneColorMap = 0;
    this._camera = new Camera();
    this._camera.node = entity;
    this._priority = 0;
    this._disablePostEffectsLayer = LAYERID_UI;
    this._postEffects = new PostEffectQueue(system.app, this);
  }

  get camera() {
    return this._camera;
  }

  set clearColorBuffer(value) {
    this._camera.clearColorBuffer = value;
    this.dirtyLayerCompositionCameras();
  }

  get clearColorBuffer() {
    return this._camera.clearColorBuffer;
  }

  set clearDepthBuffer(value) {
    this._camera.clearDepthBuffer = value;
    this.dirtyLayerCompositionCameras();
  }

  get clearDepthBuffer() {
    return this._camera.clearDepthBuffer;
  }

  set clearStencilBuffer(value) {
    this._camera.clearStencilBuffer = value;
    this.dirtyLayerCompositionCameras();
  }

  get clearStencilBuffer() {
    return this._camera.clearStencilBuffer;
  }

  set disablePostEffectsLayer(layer) {
    this._disablePostEffectsLayer = layer;
    this.dirtyLayerCompositionCameras();
  }

  get disablePostEffectsLayer() {
    return this._disablePostEffectsLayer;
  }

  _enableDepthLayer(value) {
    const hasDepthLayer = this.layers.find(layerId => layerId === LAYERID_DEPTH);

    if (hasDepthLayer) {
      const depthLayer = this.system.app.scene.layers.getLayerById(LAYERID_DEPTH);

      if (value) {
        depthLayer == null ? void 0 : depthLayer.incrementCounter();
      } else {
        depthLayer == null ? void 0 : depthLayer.decrementCounter();
      }
    } else if (value) {
      return false;
    }

    return true;
  }

  requestSceneColorMap(enabled) {
    this._renderSceneColorMap += enabled ? 1 : -1;

    const ok = this._enableDepthLayer(enabled);

    if (!ok) {
      Debug.warnOnce('CameraComponent.requestSceneColorMap was called, but the camera does not have a Depth layer, ignoring.');
    }
  }

  get renderSceneColorMap() {
    return this._renderSceneColorMap > 0;
  }

  requestSceneDepthMap(enabled) {
    this._renderSceneDepthMap += enabled ? 1 : -1;

    const ok = this._enableDepthLayer(enabled);

    if (!ok) {
      Debug.warnOnce('CameraComponent.requestSceneDepthMap was called, but the camera does not have a Depth layer, ignoring.');
    }
  }

  get renderSceneDepthMap() {
    return this._renderSceneDepthMap > 0;
  }

  get frustum() {
    return this._camera.frustum;
  }

  set layers(newValue) {
    const layers = this._camera.layers;

    for (let i = 0; i < layers.length; i++) {
      const layer = this.system.app.scene.layers.getLayerById(layers[i]);
      if (!layer) continue;
      layer.removeCamera(this);
    }

    this._camera.layers = newValue;
    if (!this.enabled || !this.entity.enabled) return;

    for (let i = 0; i < newValue.length; i++) {
      const layer = this.system.app.scene.layers.getLayerById(newValue[i]);
      if (!layer) continue;
      layer.addCamera(this);
    }
  }

  get layers() {
    return this._camera.layers;
  }

  get layersSet() {
    return this._camera.layersSet;
  }

  get postEffectsEnabled() {
    return this._postEffects.enabled;
  }

  get postEffects() {
    return this._postEffects;
  }

  set priority(newValue) {
    this._priority = newValue;
    this.dirtyLayerCompositionCameras();
  }

  get priority() {
    return this._priority;
  }

  get projectionMatrix() {
    return this._camera.projectionMatrix;
  }

  set aperture(newValue) {
    this._camera.aperture = newValue;
  }

  get aperture() {
    return this._camera.aperture;
  }

  set sensitivity(newValue) {
    this._camera.sensitivity = newValue;
  }

  get sensitivity() {
    return this._camera.sensitivity;
  }

  set shutter(newValue) {
    this._camera.shutter = newValue;
  }

  get shutter() {
    return this._camera.shutter;
  }

  set rect(value) {
    this._camera.rect = value;
    this.fire('set:rect', this._camera.rect);
  }

  get rect() {
    return this._camera.rect;
  }

  set renderTarget(value) {
    this._camera.renderTarget = value;
    this.dirtyLayerCompositionCameras();
  }

  get renderTarget() {
    return this._camera.renderTarget;
  }

  get viewMatrix() {
    return this._camera.viewMatrix;
  }

  dirtyLayerCompositionCameras() {
    const layerComp = this.system.app.scene.layers;
    layerComp._dirtyCameras = true;
  }

  screenToWorld(screenx, screeny, cameraz, worldCoord) {
    const device = this.system.app.graphicsDevice;
    const w = device.clientRect.width;
    const h = device.clientRect.height;
    return this._camera.screenToWorld(screenx, screeny, cameraz, w, h, worldCoord);
  }

  worldToScreen(worldCoord, screenCoord) {
    const device = this.system.app.graphicsDevice;
    const w = device.clientRect.width;
    const h = device.clientRect.height;
    return this._camera.worldToScreen(worldCoord, w, h, screenCoord);
  }

  onAppPrerender() {
    this._camera._viewMatDirty = true;
    this._camera._viewProjMatDirty = true;
  }

  addCameraToLayers() {
    const layers = this.layers;

    for (let i = 0; i < layers.length; i++) {
      const layer = this.system.app.scene.layers.getLayerById(layers[i]);

      if (layer) {
        layer.addCamera(this);
      }
    }
  }

  removeCameraFromLayers() {
    const layers = this.layers;

    for (let i = 0; i < layers.length; i++) {
      const layer = this.system.app.scene.layers.getLayerById(layers[i]);

      if (layer) {
        layer.removeCamera(this);
      }
    }
  }

  onLayersChanged(oldComp, newComp) {
    this.addCameraToLayers();
    oldComp.off('add', this.onLayerAdded, this);
    oldComp.off('remove', this.onLayerRemoved, this);
    newComp.on('add', this.onLayerAdded, this);
    newComp.on('remove', this.onLayerRemoved, this);
  }

  onLayerAdded(layer) {
    const index = this.layers.indexOf(layer.id);
    if (index < 0) return;
    layer.addCamera(this);
  }

  onLayerRemoved(layer) {
    const index = this.layers.indexOf(layer.id);
    if (index < 0) return;
    layer.removeCamera(this);
  }

  onEnable() {
    const system = this.system;
    const scene = system.app.scene;
    const layers = scene.layers;
    system.addCamera(this);
    scene.on('set:layers', this.onLayersChanged, this);

    if (layers) {
      layers.on('add', this.onLayerAdded, this);
      layers.on('remove', this.onLayerRemoved, this);
    }

    if (this.enabled && this.entity.enabled) {
      this.addCameraToLayers();
    }

    this.postEffects.enable();
  }

  onDisable() {
    const system = this.system;
    const scene = system.app.scene;
    const layers = scene.layers;
    this.postEffects.disable();
    this.removeCameraFromLayers();
    scene.off('set:layers', this.onLayersChanged, this);

    if (layers) {
      layers.off('add', this.onLayerAdded, this);
      layers.off('remove', this.onLayerRemoved, this);
    }

    system.removeCamera(this);
  }

  onRemove() {
    this.onDisable();
    this.off();
  }

  calculateAspectRatio(rt) {
    const device = this.system.app.graphicsDevice;
    const width = rt ? rt.width : device.width;
    const height = rt ? rt.height : device.height;
    return width * this.rect.z / (height * this.rect.w);
  }

  frameUpdate(rt) {
    if (this.aspectRatioMode === ASPECT_AUTO) {
      this.aspectRatio = this.calculateAspectRatio(rt);
    }
  }

  startXr(type, spaceType, options) {
    this.system.app.xr.start(this, type, spaceType, options);
  }

  endXr(callback) {
    if (!this._camera.xr) {
      if (callback) callback(new Error('Camera is not in XR'));
      return;
    }

    this._camera.xr.end(callback);
  }

  copy(source) {
    properties.forEach(property => {
      if (!property.readonly) {
        const name = property.name;
        this[name] = source[name];
      }
    });
    this.clearColorBuffer = source.clearColorBuffer;
    this.clearDepthBuffer = source.clearDepthBuffer;
    this.clearStencilBuffer = source.clearStencilBuffer;
    this.disablePostEffectsLayer = source.disablePostEffectsLayer;
    this.layers = source.layers;
    this.priority = source.priority;
    this.renderTarget = source.renderTarget;
    this.rect = source.rect;
    this.aperture = source.aperture;
    this.sensitivity = source.sensitivity;
    this.shutter = source.shutter;
  }

}

properties.forEach(function (property) {
  const name = property.name;
  const options = {};

  options.get = function () {
    return this._camera[name];
  };

  if (!property.readonly) {
    options.set = function (newValue) {
      this._camera[name] = newValue;
    };
  }

  Object.defineProperty(CameraComponent.prototype, name, options);
});

export { CameraComponent };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29tcG9uZW50LmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvZnJhbWV3b3JrL2NvbXBvbmVudHMvY2FtZXJhL2NvbXBvbmVudC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBU1BFQ1RfQVVUTywgTEFZRVJJRF9VSSwgTEFZRVJJRF9ERVBUSCB9IGZyb20gJy4uLy4uLy4uL3NjZW5lL2NvbnN0YW50cy5qcyc7XG5pbXBvcnQgeyBDYW1lcmEgfSBmcm9tICcuLi8uLi8uLi9zY2VuZS9jYW1lcmEuanMnO1xuXG5pbXBvcnQgeyBDb21wb25lbnQgfSBmcm9tICcuLi9jb21wb25lbnQuanMnO1xuXG5pbXBvcnQgeyBQb3N0RWZmZWN0UXVldWUgfSBmcm9tICcuL3Bvc3QtZWZmZWN0LXF1ZXVlLmpzJztcbmltcG9ydCB7IERlYnVnIH0gZnJvbSAnLi4vLi4vLi4vY29yZS9kZWJ1Zy5qcyc7XG5cbi8qKiBAdHlwZWRlZiB7aW1wb3J0KCcuLi8uLi8uLi9ncmFwaGljcy9yZW5kZXItdGFyZ2V0LmpzJykuUmVuZGVyVGFyZ2V0fSBSZW5kZXJUYXJnZXQgKi9cbi8qKiBAdHlwZWRlZiB7aW1wb3J0KCcuLi8uLi8uLi9tYXRoL2NvbG9yLmpzJykuQ29sb3J9IENvbG9yICovXG4vKiogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vLi4vbWF0aC9tYXQ0LmpzJykuTWF0NH0gTWF0NCAqL1xuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJy4uLy4uLy4uL21hdGgvdmVjMy5qcycpLlZlYzN9IFZlYzMgKi9cbi8qKiBAdHlwZWRlZiB7aW1wb3J0KCcuLi8uLi8uLi9tYXRoL3ZlYzQuanMnKS5WZWM0fSBWZWM0ICovXG4vKiogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vLi4vc2NlbmUvbGF5ZXIuanMnKS5MYXllcn0gTGF5ZXIgKi9cbi8qKiBAdHlwZWRlZiB7aW1wb3J0KCcuLi8uLi8uLi9zaGFwZS9mcnVzdHVtLmpzJykuRnJ1c3R1bX0gRnJ1c3R1bSAqL1xuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJy4uLy4uLy4uL3hyL3hyLW1hbmFnZXIuanMnKS5YckVycm9yQ2FsbGJhY2t9IFhyRXJyb3JDYWxsYmFjayAqL1xuLyoqIEB0eXBlZGVmIHtpbXBvcnQoJy4uLy4uL2VudGl0eS5qcycpLkVudGl0eX0gRW50aXR5ICovXG4vKiogQHR5cGVkZWYge2ltcG9ydCgnLi9zeXN0ZW0uanMnKS5DYW1lcmFDb21wb25lbnRTeXN0ZW19IENhbWVyYUNvbXBvbmVudFN5c3RlbSAqL1xuXG4vLyBub3RlOiB3aGVuIHRoaXMgbGlzdCBpcyBtb2RpZmllZCwgdGhlIGNvcHkoKSBmdW5jdGlvbiBuZWVkcyB0byBiZSBhZGp1c3RlZFxuY29uc3QgcHJvcGVydGllcyA9IFtcbiAgICB7IG5hbWU6ICdhc3BlY3RSYXRpbycsIHJlYWRvbmx5OiBmYWxzZSB9LFxuICAgIHsgbmFtZTogJ2FzcGVjdFJhdGlvTW9kZScsIHJlYWRvbmx5OiBmYWxzZSB9LFxuICAgIHsgbmFtZTogJ2NhbGN1bGF0ZVByb2plY3Rpb24nLCByZWFkb25seTogZmFsc2UgfSxcbiAgICB7IG5hbWU6ICdjYWxjdWxhdGVUcmFuc2Zvcm0nLCByZWFkb25seTogZmFsc2UgfSxcbiAgICB7IG5hbWU6ICdjbGVhckNvbG9yJywgcmVhZG9ubHk6IGZhbHNlIH0sXG4gICAgeyBuYW1lOiAnY3VsbEZhY2VzJywgcmVhZG9ubHk6IGZhbHNlIH0sXG4gICAgeyBuYW1lOiAnZmFyQ2xpcCcsIHJlYWRvbmx5OiBmYWxzZSB9LFxuICAgIHsgbmFtZTogJ2ZsaXBGYWNlcycsIHJlYWRvbmx5OiBmYWxzZSB9LFxuICAgIHsgbmFtZTogJ2ZvdicsIHJlYWRvbmx5OiBmYWxzZSB9LFxuICAgIHsgbmFtZTogJ2ZydXN0dW1DdWxsaW5nJywgcmVhZG9ubHk6IGZhbHNlIH0sXG4gICAgeyBuYW1lOiAnaG9yaXpvbnRhbEZvdicsIHJlYWRvbmx5OiBmYWxzZSB9LFxuICAgIHsgbmFtZTogJ25lYXJDbGlwJywgcmVhZG9ubHk6IGZhbHNlIH0sXG4gICAgeyBuYW1lOiAnb3J0aG9IZWlnaHQnLCByZWFkb25seTogZmFsc2UgfSxcbiAgICB7IG5hbWU6ICdwcm9qZWN0aW9uJywgcmVhZG9ubHk6IGZhbHNlIH0sXG4gICAgeyBuYW1lOiAnc2Npc3NvclJlY3QnLCByZWFkb25seTogZmFsc2UgfSxcbiAgICB7IG5hbWU6ICdhcGVydHVyZScsIHJlYWRvbmx5OiBmYWxzZSB9LFxuICAgIHsgbmFtZTogJ3NodXR0ZXInLCByZWFkb25seTogZmFsc2UgfSxcbiAgICB7IG5hbWU6ICdzZW5zaXRpdml0eScsIHJlYWRvbmx5OiBmYWxzZSB9XG5dO1xuXG4vKipcbiAqIENhbGxiYWNrIHVzZWQgYnkge0BsaW5rIENhbWVyYUNvbXBvbmVudCNjYWxjdWxhdGVUcmFuc2Zvcm19IGFuZCB7QGxpbmsgQ2FtZXJhQ29tcG9uZW50I2NhbGN1bGF0ZVByb2plY3Rpb259LlxuICpcbiAqIEBjYWxsYmFjayBDYWxjdWxhdGVNYXRyaXhDYWxsYmFja1xuICogQHBhcmFtIHtNYXQ0fSB0cmFuc2Zvcm1NYXRyaXggLSBPdXRwdXQgb2YgdGhlIGZ1bmN0aW9uLlxuICogQHBhcmFtIHtudW1iZXJ9IHZpZXcgLSBUeXBlIG9mIHZpZXcuIENhbiBiZSB7QGxpbmsgVklFV19DRU5URVJ9LCB7QGxpbmsgVklFV19MRUZUfSBvciB7QGxpbmsgVklFV19SSUdIVH0uIExlZnQgYW5kIHJpZ2h0IGFyZSBvbmx5IHVzZWQgaW4gc3RlcmVvIHJlbmRlcmluZy5cbiAqL1xuXG4vKipcbiAqIFRoZSBDYW1lcmEgQ29tcG9uZW50IGVuYWJsZXMgYW4gRW50aXR5IHRvIHJlbmRlciB0aGUgc2NlbmUuIEEgc2NlbmUgcmVxdWlyZXMgYXQgbGVhc3Qgb25lXG4gKiBlbmFibGVkIGNhbWVyYSBjb21wb25lbnQgdG8gYmUgcmVuZGVyZWQuIE5vdGUgdGhhdCBtdWx0aXBsZSBjYW1lcmEgY29tcG9uZW50cyBjYW4gYmUgZW5hYmxlZFxuICogc2ltdWx0YW5lb3VzbHkgKGZvciBzcGxpdC1zY3JlZW4gb3Igb2Zmc2NyZWVuIHJlbmRlcmluZywgZm9yIGV4YW1wbGUpLlxuICpcbiAqIGBgYGphdmFzY3JpcHRcbiAqIC8vIEFkZCBhIHBjLkNhbWVyYUNvbXBvbmVudCB0byBhbiBlbnRpdHlcbiAqIHZhciBlbnRpdHkgPSBuZXcgcGMuRW50aXR5KCk7XG4gKiBlbnRpdHkuYWRkQ29tcG9uZW50KCdjYW1lcmEnLCB7XG4gKiAgICAgbmVhckNsaXA6IDEsXG4gKiAgICAgZmFyQ2xpcDogMTAwLFxuICogICAgIGZvdjogNTVcbiAqIH0pO1xuICpcbiAqIC8vIEdldCB0aGUgcGMuQ2FtZXJhQ29tcG9uZW50IG9uIGFuIGVudGl0eVxuICogdmFyIGNhbWVyYUNvbXBvbmVudCA9IGVudGl0eS5jYW1lcmE7XG4gKlxuICogLy8gVXBkYXRlIGEgcHJvcGVydHkgb24gYSBjYW1lcmEgY29tcG9uZW50XG4gKiBlbnRpdHkuY2FtZXJhLm5lYXJDbGlwID0gMjtcbiAqIGBgYFxuICpcbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBwcm9qZWN0aW9uIFRoZSB0eXBlIG9mIHByb2plY3Rpb24gdXNlZCB0byByZW5kZXIgdGhlIGNhbWVyYS4gQ2FuIGJlOlxuICpcbiAqIC0ge0BsaW5rIFBST0pFQ1RJT05fUEVSU1BFQ1RJVkV9OiBBIHBlcnNwZWN0aXZlIHByb2plY3Rpb24uIFRoZSBjYW1lcmEgZnJ1c3R1bVxuICogcmVzZW1ibGVzIGEgdHJ1bmNhdGVkIHB5cmFtaWQuXG4gKiAtIHtAbGluayBQUk9KRUNUSU9OX09SVEhPR1JBUEhJQ306IEFuIG9ydGhvZ3JhcGhpYyBwcm9qZWN0aW9uLiBUaGUgY2FtZXJhXG4gKiBmcnVzdHVtIGlzIGEgY3Vib2lkLlxuICpcbiAqIERlZmF1bHRzIHRvIHtAbGluayBQUk9KRUNUSU9OX1BFUlNQRUNUSVZFfS5cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBhc3BlY3RSYXRpbyBUaGUgYXNwZWN0IHJhdGlvICh3aWR0aCBkaXZpZGVkIGJ5IGhlaWdodCkgb2YgdGhlIGNhbWVyYS4gSWZcbiAqIGFzcGVjdFJhdGlvTW9kZSBpcyB7QGxpbmsgQVNQRUNUX0FVVE99LCB0aGVuIHRoaXMgdmFsdWUgd2lsbCBiZSBhdXRvbWF0aWNhbGx5IGNhbGN1bGF0ZWQgZXZlcnlcbiAqIGZyYW1lLCBhbmQgeW91IGNhbiBvbmx5IHJlYWQgaXQuIElmIGl0J3MgQVNQRUNUX01BTlVBTCwgeW91IGNhbiBzZXQgdGhlIHZhbHVlLlxuICogQHByb3BlcnR5IHtudW1iZXJ9IGFzcGVjdFJhdGlvTW9kZSBUaGUgYXNwZWN0IHJhdGlvIG1vZGUgb2YgdGhlIGNhbWVyYS4gQ2FuIGJlOlxuICpcbiAqIC0ge0BsaW5rIEFTUEVDVF9BVVRPfTogYXNwZWN0IHJhdGlvIHdpbGwgYmUgY2FsY3VsYXRlZCBmcm9tIHRoZSBjdXJyZW50IHJlbmRlclxuICogdGFyZ2V0J3Mgd2lkdGggZGl2aWRlZCBieSBoZWlnaHQuXG4gKiAtIHtAbGluayBBU1BFQ1RfTUFOVUFMfTogdXNlIHRoZSBhc3BlY3RSYXRpbyB2YWx1ZS5cbiAqXG4gKiBEZWZhdWx0cyB0byB7QGxpbmsgQVNQRUNUX0FVVE99LlxuICogQHByb3BlcnR5IHtDb2xvcn0gY2xlYXJDb2xvciBUaGUgY29sb3IgdXNlZCB0byBjbGVhciB0aGUgY2FudmFzIHRvIGJlZm9yZSB0aGUgY2FtZXJhIHN0YXJ0cyB0b1xuICogcmVuZGVyLiBEZWZhdWx0cyB0byBbMC43NSwgMC43NSwgMC43NSwgMV0uXG4gKiBAcHJvcGVydHkge251bWJlcn0gZmFyQ2xpcCBUaGUgZGlzdGFuY2UgZnJvbSB0aGUgY2FtZXJhIGFmdGVyIHdoaWNoIG5vIHJlbmRlcmluZyB3aWxsIHRha2VcbiAqIHBsYWNlLiBEZWZhdWx0cyB0byAxMDAwLlxuICogQHByb3BlcnR5IHtudW1iZXJ9IGZvdiBUaGUgZmllbGQgb2YgdmlldyBvZiB0aGUgY2FtZXJhIGluIGRlZ3JlZXMuIFVzdWFsbHkgdGhpcyBpcyB0aGUgWS1heGlzXG4gKiBmaWVsZCBvZiB2aWV3LCBzZWUge0BsaW5rIENhbWVyYUNvbXBvbmVudCNob3Jpem9udGFsRm92fS4gVXNlZCBmb3JcbiAqIHtAbGluayBQUk9KRUNUSU9OX1BFUlNQRUNUSVZFfSBjYW1lcmFzIG9ubHkuIERlZmF1bHRzIHRvIDQ1LlxuICogQHByb3BlcnR5IHtib29sZWFufSBob3Jpem9udGFsRm92IFNldCB3aGljaCBheGlzIHRvIHVzZSBmb3IgdGhlIEZpZWxkIG9mIFZpZXcgY2FsY3VsYXRpb24uXG4gKiBEZWZhdWx0cyB0byBmYWxzZS5cbiAqIEBwcm9wZXJ0eSB7bnVtYmVyfSBuZWFyQ2xpcCBUaGUgZGlzdGFuY2UgZnJvbSB0aGUgY2FtZXJhIGJlZm9yZSB3aGljaCBubyByZW5kZXJpbmcgd2lsbCB0YWtlXG4gKiBwbGFjZS4gRGVmYXVsdHMgdG8gMC4xLlxuICogQHByb3BlcnR5IHtudW1iZXJ9IG9ydGhvSGVpZ2h0IFRoZSBoYWxmLWhlaWdodCBvZiB0aGUgb3J0aG9ncmFwaGljIHZpZXcgd2luZG93IChpbiB0aGUgWS1heGlzKS5cbiAqIFVzZWQgZm9yIHtAbGluayBQUk9KRUNUSU9OX09SVEhPR1JBUEhJQ30gY2FtZXJhcyBvbmx5LiBEZWZhdWx0cyB0byAxMC5cbiAqIEBwcm9wZXJ0eSB7VmVjNH0gc2Npc3NvclJlY3QgQ2xpcHMgYWxsIHBpeGVscyB3aGljaCBhcmUgbm90IGluIHRoZSByZWN0YW5nbGUuIFRoZSBvcmRlciBvZiB0aGVcbiAqIHZhbHVlcyBpcyBbeCwgeSwgd2lkdGgsIGhlaWdodF0uIERlZmF1bHRzIHRvIFswLCAwLCAxLCAxXS5cbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gZnJ1c3R1bUN1bGxpbmcgQ29udHJvbHMgdGhlIGN1bGxpbmcgb2YgbWVzaCBpbnN0YW5jZXMgYWdhaW5zdCB0aGUgY2FtZXJhXG4gKiBmcnVzdHVtLCBpLmUuIGlmIG9iamVjdHMgb3V0c2lkZSBvZiBjYW1lcmEgc2hvdWxkIGJlIG9taXR0ZWQgZnJvbSByZW5kZXJpbmcuIElmIGZhbHNlLCBhbGwgbWVzaFxuICogaW5zdGFuY2VzIGluIHRoZSBzY2VuZSBhcmUgcmVuZGVyZWQgYnkgdGhlIGNhbWVyYSwgcmVnYXJkbGVzcyBvZiB2aXNpYmlsaXR5LiBEZWZhdWx0cyB0byBmYWxzZS5cbiAqIEBwcm9wZXJ0eSB7Q2FsY3VsYXRlTWF0cml4Q2FsbGJhY2t9IGNhbGN1bGF0ZVRyYW5zZm9ybSBDdXN0b20gZnVuY3Rpb24geW91IGNhbiBwcm92aWRlIHRvXG4gKiBjYWxjdWxhdGUgdGhlIGNhbWVyYSB0cmFuc2Zvcm1hdGlvbiBtYXRyaXggbWFudWFsbHkuIENhbiBiZSB1c2VkIGZvciBjb21wbGV4IGVmZmVjdHMgbGlrZVxuICogcmVmbGVjdGlvbnMuIEZ1bmN0aW9uIGlzIGNhbGxlZCB1c2luZyBjb21wb25lbnQncyBzY29wZS4gQXJndW1lbnRzOlxuICpcbiAqIC0ge0BsaW5rIE1hdDR9IHRyYW5zZm9ybU1hdHJpeDogb3V0cHV0IG9mIHRoZSBmdW5jdGlvbi5cbiAqIC0gdmlldzogVHlwZSBvZiB2aWV3LiBDYW4gYmUge0BsaW5rIFZJRVdfQ0VOVEVSfSwge0BsaW5rIFZJRVdfTEVGVH0gb3Ige0BsaW5rIFZJRVdfUklHSFR9LlxuICpcbiAqIExlZnQgYW5kIHJpZ2h0IGFyZSBvbmx5IHVzZWQgaW4gc3RlcmVvIHJlbmRlcmluZy5cbiAqIEBwcm9wZXJ0eSB7Q2FsY3VsYXRlTWF0cml4Q2FsbGJhY2t9IGNhbGN1bGF0ZVByb2plY3Rpb24gQ3VzdG9tIGZ1bmN0aW9uIHlvdSBjYW4gcHJvdmlkZSB0b1xuICogY2FsY3VsYXRlIHRoZSBjYW1lcmEgcHJvamVjdGlvbiBtYXRyaXggbWFudWFsbHkuIENhbiBiZSB1c2VkIGZvciBjb21wbGV4IGVmZmVjdHMgbGlrZSBkb2luZ1xuICogb2JsaXF1ZSBwcm9qZWN0aW9uLiBGdW5jdGlvbiBpcyBjYWxsZWQgdXNpbmcgY29tcG9uZW50J3Mgc2NvcGUuIEFyZ3VtZW50czpcbiAqXG4gKiAtIHtAbGluayBNYXQ0fSB0cmFuc2Zvcm1NYXRyaXg6IG91dHB1dCBvZiB0aGUgZnVuY3Rpb25cbiAqIC0gdmlldzogVHlwZSBvZiB2aWV3LiBDYW4gYmUge0BsaW5rIFZJRVdfQ0VOVEVSfSwge0BsaW5rIFZJRVdfTEVGVH0gb3Ige0BsaW5rIFZJRVdfUklHSFR9LlxuICpcbiAqIExlZnQgYW5kIHJpZ2h0IGFyZSBvbmx5IHVzZWQgaW4gc3RlcmVvIHJlbmRlcmluZy5cbiAqIEBwcm9wZXJ0eSB7Ym9vbGVhbn0gY3VsbEZhY2VzIElmIHRydWUgdGhlIGNhbWVyYSB3aWxsIHRha2UgbWF0ZXJpYWwuY3VsbCBpbnRvIGFjY291bnQuIE90aGVyd2lzZVxuICogYm90aCBmcm9udCBhbmQgYmFjayBmYWNlcyB3aWxsIGJlIHJlbmRlcmVkLiBEZWZhdWx0cyB0byB0cnVlLlxuICogQHByb3BlcnR5IHtib29sZWFufSBmbGlwRmFjZXMgSWYgdHJ1ZSB0aGUgY2FtZXJhIHdpbGwgaW52ZXJ0IGZyb250IGFuZCBiYWNrIGZhY2VzLiBDYW4gYmUgdXNlZnVsXG4gKiBmb3IgcmVmbGVjdGlvbiByZW5kZXJpbmcuIERlZmF1bHRzIHRvIGZhbHNlLlxuICogQGF1Z21lbnRzIENvbXBvbmVudFxuICovXG5jbGFzcyBDYW1lcmFDb21wb25lbnQgZXh0ZW5kcyBDb21wb25lbnQge1xuICAgIC8qKlxuICAgICAqIEN1c3RvbSBmdW5jdGlvbiB0aGF0IGlzIGNhbGxlZCB3aGVuIHBvc3Rwcm9jZXNzaW5nIHNob3VsZCBleGVjdXRlLlxuICAgICAqXG4gICAgICogQHR5cGUge0Z1bmN0aW9ufVxuICAgICAqIEBpZ25vcmVcbiAgICAgKi9cbiAgICBvblBvc3Rwcm9jZXNzaW5nID0gbnVsbDtcblxuICAgIC8qKlxuICAgICAqIEN1c3RvbSBmdW5jdGlvbiB0aGF0IGlzIGNhbGxlZCBiZWZvcmUgdGhlIGNhbWVyYSByZW5kZXJzIHRoZSBzY2VuZS5cbiAgICAgKlxuICAgICAqIEB0eXBlIHtGdW5jdGlvbn1cbiAgICAgKi9cbiAgICBvblByZVJlbmRlciA9IG51bGw7XG5cbiAgICAvKipcbiAgICAgKiBDdXN0b20gZnVuY3Rpb24gdGhhdCBpcyBjYWxsZWQgYWZ0ZXIgdGhlIGNhbWVyYSByZW5kZXJzIHRoZSBzY2VuZS5cbiAgICAgKlxuICAgICAqIEB0eXBlIHtGdW5jdGlvbn1cbiAgICAgKi9cbiAgICBvblBvc3RSZW5kZXIgPSBudWxsO1xuXG4gICAgLyoqXG4gICAgICogQSBjb3VudGVyIG9mIHJlcXVlc3RzIG9mIGRlcHRoIG1hcCByZW5kZXJpbmcuXG4gICAgICpcbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3JlbmRlclNjZW5lRGVwdGhNYXAgPSAwO1xuXG4gICAgLyoqXG4gICAgICogQSBjb3VudGVyIG9mIHJlcXVlc3RzIG9mIGNvbG9yIG1hcCByZW5kZXJpbmcuXG4gICAgICpcbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX3JlbmRlclNjZW5lQ29sb3JNYXAgPSAwO1xuXG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgbmV3IENhbWVyYUNvbXBvbmVudCBpbnN0YW5jZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7Q2FtZXJhQ29tcG9uZW50U3lzdGVtfSBzeXN0ZW0gLSBUaGUgQ29tcG9uZW50U3lzdGVtIHRoYXQgY3JlYXRlZCB0aGlzIENvbXBvbmVudC5cbiAgICAgKiBAcGFyYW0ge0VudGl0eX0gZW50aXR5IC0gVGhlIEVudGl0eSB0aGF0IHRoaXMgQ29tcG9uZW50IGlzIGF0dGFjaGVkIHRvLlxuICAgICAqL1xuICAgIGNvbnN0cnVjdG9yKHN5c3RlbSwgZW50aXR5KSB7XG4gICAgICAgIHN1cGVyKHN5c3RlbSwgZW50aXR5KTtcblxuICAgICAgICB0aGlzLl9jYW1lcmEgPSBuZXcgQ2FtZXJhKCk7XG4gICAgICAgIHRoaXMuX2NhbWVyYS5ub2RlID0gZW50aXR5O1xuXG4gICAgICAgIHRoaXMuX3ByaW9yaXR5ID0gMDtcblxuICAgICAgICAvLyBsYXllciBpZCBhdCB3aGljaCB0aGUgcG9zdHByb2Nlc3Npbmcgc3RvcHMgZm9yIHRoZSBjYW1lcmFcbiAgICAgICAgdGhpcy5fZGlzYWJsZVBvc3RFZmZlY3RzTGF5ZXIgPSBMQVlFUklEX1VJO1xuXG4gICAgICAgIC8vIHBvc3Rwcm9jZXNzaW5nIG1hbmFnZW1lbnRcbiAgICAgICAgdGhpcy5fcG9zdEVmZmVjdHMgPSBuZXcgUG9zdEVmZmVjdFF1ZXVlKHN5c3RlbS5hcHAsIHRoaXMpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFF1ZXJpZXMgdGhlIGNhbWVyYSBjb21wb25lbnQncyB1bmRlcmx5aW5nIENhbWVyYSBpbnN0YW5jZS5cbiAgICAgKlxuICAgICAqIEB0eXBlIHtDYW1lcmF9XG4gICAgICogQGlnbm9yZVxuICAgICAqL1xuICAgIGdldCBjYW1lcmEoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYW1lcmE7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogSWYgdHJ1ZSB0aGUgY2FtZXJhIHdpbGwgY2xlYXIgdGhlIGNvbG9yIGJ1ZmZlciB0byB0aGUgY29sb3Igc2V0IGluIGNsZWFyQ29sb3IuIERlZmF1bHRzIHRvIHRydWUuXG4gICAgICpcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBzZXQgY2xlYXJDb2xvckJ1ZmZlcih2YWx1ZSkge1xuICAgICAgICB0aGlzLl9jYW1lcmEuY2xlYXJDb2xvckJ1ZmZlciA9IHZhbHVlO1xuICAgICAgICB0aGlzLmRpcnR5TGF5ZXJDb21wb3NpdGlvbkNhbWVyYXMoKTtcbiAgICB9XG5cbiAgICBnZXQgY2xlYXJDb2xvckJ1ZmZlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhbWVyYS5jbGVhckNvbG9yQnVmZmVyO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIElmIHRydWUgdGhlIGNhbWVyYSB3aWxsIGNsZWFyIHRoZSBkZXB0aCBidWZmZXIuIERlZmF1bHRzIHRvIHRydWUuXG4gICAgICpcbiAgICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICAgKi9cbiAgICBzZXQgY2xlYXJEZXB0aEJ1ZmZlcih2YWx1ZSkge1xuICAgICAgICB0aGlzLl9jYW1lcmEuY2xlYXJEZXB0aEJ1ZmZlciA9IHZhbHVlO1xuICAgICAgICB0aGlzLmRpcnR5TGF5ZXJDb21wb3NpdGlvbkNhbWVyYXMoKTtcbiAgICB9XG5cbiAgICBnZXQgY2xlYXJEZXB0aEJ1ZmZlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhbWVyYS5jbGVhckRlcHRoQnVmZmVyO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIElmIHRydWUgdGhlIGNhbWVyYSB3aWxsIGNsZWFyIHRoZSBzdGVuY2lsIGJ1ZmZlci4gRGVmYXVsdHMgdG8gdHJ1ZS5cbiAgICAgKlxuICAgICAqIEB0eXBlIHtib29sZWFufVxuICAgICAqL1xuICAgIHNldCBjbGVhclN0ZW5jaWxCdWZmZXIodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fY2FtZXJhLmNsZWFyU3RlbmNpbEJ1ZmZlciA9IHZhbHVlO1xuICAgICAgICB0aGlzLmRpcnR5TGF5ZXJDb21wb3NpdGlvbkNhbWVyYXMoKTtcbiAgICB9XG5cbiAgICBnZXQgY2xlYXJTdGVuY2lsQnVmZmVyKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY2FtZXJhLmNsZWFyU3RlbmNpbEJ1ZmZlcjtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBMYXllciBJRCBvZiBhIGxheWVyIG9uIHdoaWNoIHRoZSBwb3N0cHJvY2Vzc2luZyBvZiB0aGUgY2FtZXJhIHN0b3BzIGJlaW5nIGFwcGxpZWQgdG8uXG4gICAgICogRGVmYXVsdHMgdG8gTEFZRVJJRF9VSSwgd2hpY2ggY2F1c2VzIHBvc3QgcHJvY2Vzc2luZyB0byBub3QgYmUgYXBwbGllZCB0byBVSSBsYXllciBhbmQgYW55XG4gICAgICogZm9sbG93aW5nIGxheWVycyBmb3IgdGhlIGNhbWVyYS4gU2V0IHRvIHVuZGVmaW5lZCBmb3IgcG9zdC1wcm9jZXNzaW5nIHRvIGJlIGFwcGxpZWQgdG8gYWxsXG4gICAgICogbGF5ZXJzIG9mIHRoZSBjYW1lcmEuXG4gICAgICpcbiAgICAgKiBAdHlwZSB7bnVtYmVyfVxuICAgICAqL1xuICAgIHNldCBkaXNhYmxlUG9zdEVmZmVjdHNMYXllcihsYXllcikge1xuICAgICAgICB0aGlzLl9kaXNhYmxlUG9zdEVmZmVjdHNMYXllciA9IGxheWVyO1xuICAgICAgICB0aGlzLmRpcnR5TGF5ZXJDb21wb3NpdGlvbkNhbWVyYXMoKTtcbiAgICB9XG5cbiAgICBnZXQgZGlzYWJsZVBvc3RFZmZlY3RzTGF5ZXIoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9kaXNhYmxlUG9zdEVmZmVjdHNMYXllcjtcbiAgICB9XG5cbiAgICAvLyBiYXNlZCBvbiB0aGUgdmFsdWUsIHRoZSBkZXB0aCBsYXllcidzIGVuYWJsZSBjb3VudGVyIGlzIGluY3JlbWVudGVkIG9yIGRlY3JlbWVudGVkXG4gICAgX2VuYWJsZURlcHRoTGF5ZXIodmFsdWUpIHtcbiAgICAgICAgY29uc3QgaGFzRGVwdGhMYXllciA9IHRoaXMubGF5ZXJzLmZpbmQobGF5ZXJJZCA9PiBsYXllcklkID09PSBMQVlFUklEX0RFUFRIKTtcbiAgICAgICAgaWYgKGhhc0RlcHRoTGF5ZXIpIHtcblxuICAgICAgICAgICAgLyoqIEB0eXBlIHtMYXllcn0gKi9cbiAgICAgICAgICAgIGNvbnN0IGRlcHRoTGF5ZXIgPSB0aGlzLnN5c3RlbS5hcHAuc2NlbmUubGF5ZXJzLmdldExheWVyQnlJZChMQVlFUklEX0RFUFRIKTtcblxuICAgICAgICAgICAgaWYgKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgZGVwdGhMYXllcj8uaW5jcmVtZW50Q291bnRlcigpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBkZXB0aExheWVyPy5kZWNyZW1lbnRDb3VudGVyKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlcXVlc3QgdGhlIHNjZW5lIHRvIGdlbmVyYXRlIGEgdGV4dHVyZSBjb250YWluaW5nIHRoZSBzY2VuZSBjb2xvciBtYXAuIE5vdGUgdGhhdCB0aGlzIGNhbGxcbiAgICAgKiBpcyBhY2N1bW11bGF0aXZlLCBhbmQgZm9yIGVhY2ggZW5hYmxlIHJlcXVlc3QsIGEgZGlzYWJsZSByZXF1ZXN0IG5lZWQgdG8gYmUgY2FsbGVkLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtib29sZWFufSBlbmFibGVkIC0gVHJ1ZSB0byByZXF1ZXN0IHRoZSBnZW5lcmF0aW9uLCBmYWxzZSB0byBkaXNhYmxlIGl0LlxuICAgICAqL1xuICAgIHJlcXVlc3RTY2VuZUNvbG9yTWFwKGVuYWJsZWQpIHtcbiAgICAgICAgdGhpcy5fcmVuZGVyU2NlbmVDb2xvck1hcCArPSBlbmFibGVkID8gMSA6IC0xO1xuICAgICAgICBjb25zdCBvayA9IHRoaXMuX2VuYWJsZURlcHRoTGF5ZXIoZW5hYmxlZCk7XG4gICAgICAgIGlmICghb2spIHtcbiAgICAgICAgICAgIERlYnVnLndhcm5PbmNlKCdDYW1lcmFDb21wb25lbnQucmVxdWVzdFNjZW5lQ29sb3JNYXAgd2FzIGNhbGxlZCwgYnV0IHRoZSBjYW1lcmEgZG9lcyBub3QgaGF2ZSBhIERlcHRoIGxheWVyLCBpZ25vcmluZy4nKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldCByZW5kZXJTY2VuZUNvbG9yTWFwKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fcmVuZGVyU2NlbmVDb2xvck1hcCA+IDA7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVxdWVzdCB0aGUgc2NlbmUgdG8gZ2VuZXJhdGUgYSB0ZXh0dXJlIGNvbnRhaW5pbmcgdGhlIHNjZW5lIGRlcHRoIG1hcC4gTm90ZSB0aGF0IHRoaXMgY2FsbFxuICAgICAqIGlzIGFjY3VtbXVsYXRpdmUsIGFuZCBmb3IgZWFjaCBlbmFibGUgcmVxdWVzdCwgYSBkaXNhYmxlIHJlcXVlc3QgbmVlZCB0byBiZSBjYWxsZWQuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGVuYWJsZWQgLSBUcnVlIHRvIHJlcXVlc3QgdGhlIGdlbmVyYXRpb24sIGZhbHNlIHRvIGRpc2FibGUgaXQuXG4gICAgICovXG4gICAgcmVxdWVzdFNjZW5lRGVwdGhNYXAoZW5hYmxlZCkge1xuICAgICAgICB0aGlzLl9yZW5kZXJTY2VuZURlcHRoTWFwICs9IGVuYWJsZWQgPyAxIDogLTE7XG4gICAgICAgIGNvbnN0IG9rID0gdGhpcy5fZW5hYmxlRGVwdGhMYXllcihlbmFibGVkKTtcbiAgICAgICAgaWYgKCFvaykge1xuICAgICAgICAgICAgRGVidWcud2Fybk9uY2UoJ0NhbWVyYUNvbXBvbmVudC5yZXF1ZXN0U2NlbmVEZXB0aE1hcCB3YXMgY2FsbGVkLCBidXQgdGhlIGNhbWVyYSBkb2VzIG5vdCBoYXZlIGEgRGVwdGggbGF5ZXIsIGlnbm9yaW5nLicpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0IHJlbmRlclNjZW5lRGVwdGhNYXAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9yZW5kZXJTY2VuZURlcHRoTWFwID4gMDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBRdWVyaWVzIHRoZSBjYW1lcmEncyBmcnVzdHVtIHNoYXBlLlxuICAgICAqXG4gICAgICogQHR5cGUge0ZydXN0dW19XG4gICAgICovXG4gICAgZ2V0IGZydXN0dW0oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYW1lcmEuZnJ1c3R1bTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBbiBhcnJheSBvZiBsYXllciBJRHMgKHtAbGluayBMYXllciNpZH0pIHRvIHdoaWNoIHRoaXMgY2FtZXJhIHNob3VsZCBiZWxvbmcuIERvbid0IHB1c2gsXG4gICAgICogcG9wLCBzcGxpY2Ugb3IgbW9kaWZ5IHRoaXMgYXJyYXksIGlmIHlvdSB3YW50IHRvIGNoYW5nZSBpdCwgc2V0IGEgbmV3IG9uZSBpbnN0ZWFkLiBEZWZhdWx0c1xuICAgICAqIHRvIFtMQVlFUklEX1dPUkxELCBMQVlFUklEX0RFUFRILCBMQVlFUklEX1NLWUJPWCwgTEFZRVJJRF9VSSwgTEFZRVJJRF9JTU1FRElBVEVdLlxuICAgICAqXG4gICAgICogQHR5cGUge251bWJlcltdfVxuICAgICAqL1xuICAgIHNldCBsYXllcnMobmV3VmFsdWUpIHtcbiAgICAgICAgY29uc3QgbGF5ZXJzID0gdGhpcy5fY2FtZXJhLmxheWVycztcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsYXllcnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGxheWVyID0gdGhpcy5zeXN0ZW0uYXBwLnNjZW5lLmxheWVycy5nZXRMYXllckJ5SWQobGF5ZXJzW2ldKTtcbiAgICAgICAgICAgIGlmICghbGF5ZXIpIGNvbnRpbnVlO1xuICAgICAgICAgICAgbGF5ZXIucmVtb3ZlQ2FtZXJhKHRoaXMpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fY2FtZXJhLmxheWVycyA9IG5ld1ZhbHVlO1xuXG4gICAgICAgIGlmICghdGhpcy5lbmFibGVkIHx8ICF0aGlzLmVudGl0eS5lbmFibGVkKSByZXR1cm47XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuZXdWYWx1ZS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgbGF5ZXIgPSB0aGlzLnN5c3RlbS5hcHAuc2NlbmUubGF5ZXJzLmdldExheWVyQnlJZChuZXdWYWx1ZVtpXSk7XG4gICAgICAgICAgICBpZiAoIWxheWVyKSBjb250aW51ZTtcbiAgICAgICAgICAgIGxheWVyLmFkZENhbWVyYSh0aGlzKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldCBsYXllcnMoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYW1lcmEubGF5ZXJzO1xuICAgIH1cblxuICAgIGdldCBsYXllcnNTZXQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYW1lcmEubGF5ZXJzU2V0O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFRoZSBwb3N0IGVmZmVjdHMgcXVldWUgZm9yIHRoaXMgY2FtZXJhLiBVc2UgdGhpcyB0byBhZGQgb3IgcmVtb3ZlIHBvc3QgZWZmZWN0cyBmcm9tIHRoZSBjYW1lcmEuXG4gICAgICpcbiAgICAgKiBAdHlwZSB7UG9zdEVmZmVjdFF1ZXVlfVxuICAgICAqL1xuICAgIGdldCBwb3N0RWZmZWN0c0VuYWJsZWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9wb3N0RWZmZWN0cy5lbmFibGVkO1xuICAgIH1cblxuICAgIGdldCBwb3N0RWZmZWN0cygpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3Bvc3RFZmZlY3RzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvbnRyb2xzIHRoZSBvcmRlciBpbiB3aGljaCBjYW1lcmFzIGFyZSByZW5kZXJlZC4gQ2FtZXJhcyB3aXRoIHNtYWxsZXIgdmFsdWVzIGZvciBwcmlvcml0eVxuICAgICAqIGFyZSByZW5kZXJlZCBmaXJzdC4gRGVmYXVsdHMgdG8gMC5cbiAgICAgKlxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgc2V0IHByaW9yaXR5KG5ld1ZhbHVlKSB7XG4gICAgICAgIHRoaXMuX3ByaW9yaXR5ID0gbmV3VmFsdWU7XG4gICAgICAgIHRoaXMuZGlydHlMYXllckNvbXBvc2l0aW9uQ2FtZXJhcygpO1xuICAgIH1cblxuICAgIGdldCBwcmlvcml0eSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ByaW9yaXR5O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFF1ZXJpZXMgdGhlIGNhbWVyYSdzIHByb2plY3Rpb24gbWF0cml4LlxuICAgICAqXG4gICAgICogQHR5cGUge01hdDR9XG4gICAgICovXG4gICAgZ2V0IHByb2plY3Rpb25NYXRyaXgoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYW1lcmEucHJvamVjdGlvbk1hdHJpeDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgY2FtZXJhIGFwZXJ0dXJlIGluIGYtc3RvcHMsIHRoZSBkZWZhdWx0IHZhbHVlIGlzIDE2LjAuIEhpZ2hlciB2YWx1ZSBtZWFucyBsZXNzIGV4cG9zdXJlLlxuICAgICAqXG4gICAgICogQHR5cGUge251bWJlcn1cbiAgICAgKi9cbiAgICBzZXQgYXBlcnR1cmUobmV3VmFsdWUpIHtcbiAgICAgICAgdGhpcy5fY2FtZXJhLmFwZXJ0dXJlID0gbmV3VmFsdWU7XG4gICAgfVxuXG4gICAgZ2V0IGFwZXJ0dXJlKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY2FtZXJhLmFwZXJ0dXJlO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFNldCBjYW1lcmEgc2Vuc2l0aXZpdHkgaW4gSVNPLCB0aGUgZGVmYXVsdCB2YWx1ZSBpcyAxMDAwLiBIaWdoZXIgdmFsdWUgbWVhbnMgbW9yZSBleHBvc3VyZS5cbiAgICAgKlxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgc2V0IHNlbnNpdGl2aXR5KG5ld1ZhbHVlKSB7XG4gICAgICAgIHRoaXMuX2NhbWVyYS5zZW5zaXRpdml0eSA9IG5ld1ZhbHVlO1xuICAgIH1cblxuICAgIGdldCBzZW5zaXRpdml0eSgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhbWVyYS5zZW5zaXRpdml0eTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZXQgY2FtZXJhIHNodXR0ZXIgc3BlZWQgaW4gc2Vjb25kcywgdGhlIGRlZmF1bHQgdmFsdWUgaXMgMS8xMDAwcy4gTG9uZ2VyIHNodXR0ZXIgbWVhbnMgbW9yZSBleHBvc3VyZS5cbiAgICAgKlxuICAgICAqIEB0eXBlIHtudW1iZXJ9XG4gICAgICovXG4gICAgc2V0IHNodXR0ZXIobmV3VmFsdWUpIHtcbiAgICAgICAgdGhpcy5fY2FtZXJhLnNodXR0ZXIgPSBuZXdWYWx1ZTtcbiAgICB9XG5cbiAgICBnZXQgc2h1dHRlcigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhbWVyYS5zaHV0dGVyO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvbnRyb2xzIHdoZXJlIG9uIHRoZSBzY3JlZW4gdGhlIGNhbWVyYSB3aWxsIGJlIHJlbmRlcmVkIGluIG5vcm1hbGl6ZWQgc2NyZWVuIGNvb3JkaW5hdGVzLlxuICAgICAqIERlZmF1bHRzIHRvIFswLCAwLCAxLCAxXS5cbiAgICAgKlxuICAgICAqIEB0eXBlIHtWZWM0fVxuICAgICAqL1xuICAgIHNldCByZWN0KHZhbHVlKSB7XG4gICAgICAgIHRoaXMuX2NhbWVyYS5yZWN0ID0gdmFsdWU7XG4gICAgICAgIHRoaXMuZmlyZSgnc2V0OnJlY3QnLCB0aGlzLl9jYW1lcmEucmVjdCk7XG4gICAgfVxuXG4gICAgZ2V0IHJlY3QoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYW1lcmEucmVjdDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBSZW5kZXIgdGFyZ2V0IHRvIHdoaWNoIHJlbmRlcmluZyBvZiB0aGUgY2FtZXJhcyBpcyBwZXJmb3JtZWQuIElmIG5vdCBzZXQsIGl0IHdpbGwgcmVuZGVyXG4gICAgICogc2ltcGx5IHRvIHRoZSBzY3JlZW4uXG4gICAgICpcbiAgICAgKiBAdHlwZSB7UmVuZGVyVGFyZ2V0fVxuICAgICAqL1xuICAgIHNldCByZW5kZXJUYXJnZXQodmFsdWUpIHtcbiAgICAgICAgdGhpcy5fY2FtZXJhLnJlbmRlclRhcmdldCA9IHZhbHVlO1xuICAgICAgICB0aGlzLmRpcnR5TGF5ZXJDb21wb3NpdGlvbkNhbWVyYXMoKTtcbiAgICB9XG5cbiAgICBnZXQgcmVuZGVyVGFyZ2V0KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY2FtZXJhLnJlbmRlclRhcmdldDtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBRdWVyaWVzIHRoZSBjYW1lcmEncyB2aWV3IG1hdHJpeC5cbiAgICAgKlxuICAgICAqIEB0eXBlIHtNYXQ0fVxuICAgICAqL1xuICAgIGdldCB2aWV3TWF0cml4KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fY2FtZXJhLnZpZXdNYXRyaXg7XG4gICAgfVxuXG4gICAgZGlydHlMYXllckNvbXBvc2l0aW9uQ2FtZXJhcygpIHtcbiAgICAgICAgLy8gbGF5ZXIgY29tcG9zaXRpb24gbmVlZHMgdG8gdXBkYXRlIG9yZGVyXG4gICAgICAgIGNvbnN0IGxheWVyQ29tcCA9IHRoaXMuc3lzdGVtLmFwcC5zY2VuZS5sYXllcnM7XG4gICAgICAgIGxheWVyQ29tcC5fZGlydHlDYW1lcmFzID0gdHJ1ZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb252ZXJ0IGEgcG9pbnQgZnJvbSAyRCBzY3JlZW4gc3BhY2UgdG8gM0Qgd29ybGQgc3BhY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge251bWJlcn0gc2NyZWVueCAtIFggY29vcmRpbmF0ZSBvbiBQbGF5Q2FudmFzJyBjYW52YXMgZWxlbWVudC4gU2hvdWxkIGJlIGluIHRoZSByYW5nZVxuICAgICAqIDAgdG8gYGNhbnZhcy5vZmZzZXRXaWR0aGAgb2YgdGhlIGFwcGxpY2F0aW9uJ3MgY2FudmFzIGVsZW1lbnQuXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IHNjcmVlbnkgLSBZIGNvb3JkaW5hdGUgb24gUGxheUNhbnZhcycgY2FudmFzIGVsZW1lbnQuIFNob3VsZCBiZSBpbiB0aGUgcmFuZ2VcbiAgICAgKiAwIHRvIGBjYW52YXMub2Zmc2V0SGVpZ2h0YCBvZiB0aGUgYXBwbGljYXRpb24ncyBjYW52YXMgZWxlbWVudC5cbiAgICAgKiBAcGFyYW0ge251bWJlcn0gY2FtZXJheiAtIFRoZSBkaXN0YW5jZSBmcm9tIHRoZSBjYW1lcmEgaW4gd29ybGQgc3BhY2UgdG8gY3JlYXRlIHRoZSBuZXdcbiAgICAgKiBwb2ludC5cbiAgICAgKiBAcGFyYW0ge1ZlYzN9IFt3b3JsZENvb3JkXSAtIDNEIHZlY3RvciB0byByZWNlaXZlIHdvcmxkIGNvb3JkaW5hdGUgcmVzdWx0LlxuICAgICAqIEBleGFtcGxlXG4gICAgICogLy8gR2V0IHRoZSBzdGFydCBhbmQgZW5kIHBvaW50cyBvZiBhIDNEIHJheSBmaXJlZCBmcm9tIGEgc2NyZWVuIGNsaWNrIHBvc2l0aW9uXG4gICAgICogdmFyIHN0YXJ0ID0gZW50aXR5LmNhbWVyYS5zY3JlZW5Ub1dvcmxkKGNsaWNrWCwgY2xpY2tZLCBlbnRpdHkuY2FtZXJhLm5lYXJDbGlwKTtcbiAgICAgKiB2YXIgZW5kID0gZW50aXR5LmNhbWVyYS5zY3JlZW5Ub1dvcmxkKGNsaWNrWCwgY2xpY2tZLCBlbnRpdHkuY2FtZXJhLmZhckNsaXApO1xuICAgICAqXG4gICAgICogLy8gVXNlIHRoZSByYXkgY29vcmRpbmF0ZXMgdG8gcGVyZm9ybSBhIHJheWNhc3RcbiAgICAgKiBhcHAuc3lzdGVtcy5yaWdpZGJvZHkucmF5Y2FzdEZpcnN0KHN0YXJ0LCBlbmQsIGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgKiAgICAgY29uc29sZS5sb2coXCJFbnRpdHkgXCIgKyByZXN1bHQuZW50aXR5Lm5hbWUgKyBcIiB3YXMgc2VsZWN0ZWRcIik7XG4gICAgICogfSk7XG4gICAgICogQHJldHVybnMge1ZlYzN9IFRoZSB3b3JsZCBzcGFjZSBjb29yZGluYXRlLlxuICAgICAqL1xuICAgIHNjcmVlblRvV29ybGQoc2NyZWVueCwgc2NyZWVueSwgY2FtZXJheiwgd29ybGRDb29yZCkge1xuICAgICAgICBjb25zdCBkZXZpY2UgPSB0aGlzLnN5c3RlbS5hcHAuZ3JhcGhpY3NEZXZpY2U7XG4gICAgICAgIGNvbnN0IHcgPSBkZXZpY2UuY2xpZW50UmVjdC53aWR0aDtcbiAgICAgICAgY29uc3QgaCA9IGRldmljZS5jbGllbnRSZWN0LmhlaWdodDtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhbWVyYS5zY3JlZW5Ub1dvcmxkKHNjcmVlbngsIHNjcmVlbnksIGNhbWVyYXosIHcsIGgsIHdvcmxkQ29vcmQpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIENvbnZlcnQgYSBwb2ludCBmcm9tIDNEIHdvcmxkIHNwYWNlIHRvIDJEIHNjcmVlbiBzcGFjZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7VmVjM30gd29ybGRDb29yZCAtIFRoZSB3b3JsZCBzcGFjZSBjb29yZGluYXRlLlxuICAgICAqIEBwYXJhbSB7VmVjM30gW3NjcmVlbkNvb3JkXSAtIDNEIHZlY3RvciB0byByZWNlaXZlIHNjcmVlbiBjb29yZGluYXRlIHJlc3VsdC5cbiAgICAgKiBAcmV0dXJucyB7VmVjM30gVGhlIHNjcmVlbiBzcGFjZSBjb29yZGluYXRlLlxuICAgICAqL1xuICAgIHdvcmxkVG9TY3JlZW4od29ybGRDb29yZCwgc2NyZWVuQ29vcmQpIHtcbiAgICAgICAgY29uc3QgZGV2aWNlID0gdGhpcy5zeXN0ZW0uYXBwLmdyYXBoaWNzRGV2aWNlO1xuICAgICAgICBjb25zdCB3ID0gZGV2aWNlLmNsaWVudFJlY3Qud2lkdGg7XG4gICAgICAgIGNvbnN0IGggPSBkZXZpY2UuY2xpZW50UmVjdC5oZWlnaHQ7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYW1lcmEud29ybGRUb1NjcmVlbih3b3JsZENvb3JkLCB3LCBoLCBzY3JlZW5Db29yZCk7XG4gICAgfVxuXG4gICAgLy8gY2FsbGVkIGJlZm9yZSBhcHBsaWNhdGlvbiByZW5kZXJzIHRoZSBzY2VuZVxuICAgIG9uQXBwUHJlcmVuZGVyKCkge1xuICAgICAgICB0aGlzLl9jYW1lcmEuX3ZpZXdNYXREaXJ0eSA9IHRydWU7XG4gICAgICAgIHRoaXMuX2NhbWVyYS5fdmlld1Byb2pNYXREaXJ0eSA9IHRydWU7XG4gICAgfVxuXG4gICAgYWRkQ2FtZXJhVG9MYXllcnMoKSB7XG4gICAgICAgIGNvbnN0IGxheWVycyA9IHRoaXMubGF5ZXJzO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxheWVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3QgbGF5ZXIgPSB0aGlzLnN5c3RlbS5hcHAuc2NlbmUubGF5ZXJzLmdldExheWVyQnlJZChsYXllcnNbaV0pO1xuICAgICAgICAgICAgaWYgKGxheWVyKSB7XG4gICAgICAgICAgICAgICAgbGF5ZXIuYWRkQ2FtZXJhKHRoaXMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmVtb3ZlQ2FtZXJhRnJvbUxheWVycygpIHtcbiAgICAgICAgY29uc3QgbGF5ZXJzID0gdGhpcy5sYXllcnM7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGF5ZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBsYXllciA9IHRoaXMuc3lzdGVtLmFwcC5zY2VuZS5sYXllcnMuZ2V0TGF5ZXJCeUlkKGxheWVyc1tpXSk7XG4gICAgICAgICAgICBpZiAobGF5ZXIpIHtcbiAgICAgICAgICAgICAgICBsYXllci5yZW1vdmVDYW1lcmEodGhpcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbkxheWVyc0NoYW5nZWQob2xkQ29tcCwgbmV3Q29tcCkge1xuICAgICAgICB0aGlzLmFkZENhbWVyYVRvTGF5ZXJzKCk7XG4gICAgICAgIG9sZENvbXAub2ZmKCdhZGQnLCB0aGlzLm9uTGF5ZXJBZGRlZCwgdGhpcyk7XG4gICAgICAgIG9sZENvbXAub2ZmKCdyZW1vdmUnLCB0aGlzLm9uTGF5ZXJSZW1vdmVkLCB0aGlzKTtcbiAgICAgICAgbmV3Q29tcC5vbignYWRkJywgdGhpcy5vbkxheWVyQWRkZWQsIHRoaXMpO1xuICAgICAgICBuZXdDb21wLm9uKCdyZW1vdmUnLCB0aGlzLm9uTGF5ZXJSZW1vdmVkLCB0aGlzKTtcbiAgICB9XG5cbiAgICBvbkxheWVyQWRkZWQobGF5ZXIpIHtcbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLmxheWVycy5pbmRleE9mKGxheWVyLmlkKTtcbiAgICAgICAgaWYgKGluZGV4IDwgMCkgcmV0dXJuO1xuICAgICAgICBsYXllci5hZGRDYW1lcmEodGhpcyk7XG4gICAgfVxuXG4gICAgb25MYXllclJlbW92ZWQobGF5ZXIpIHtcbiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLmxheWVycy5pbmRleE9mKGxheWVyLmlkKTtcbiAgICAgICAgaWYgKGluZGV4IDwgMCkgcmV0dXJuO1xuICAgICAgICBsYXllci5yZW1vdmVDYW1lcmEodGhpcyk7XG4gICAgfVxuXG4gICAgb25FbmFibGUoKSB7XG4gICAgICAgIGNvbnN0IHN5c3RlbSA9IHRoaXMuc3lzdGVtO1xuICAgICAgICBjb25zdCBzY2VuZSA9IHN5c3RlbS5hcHAuc2NlbmU7XG4gICAgICAgIGNvbnN0IGxheWVycyA9IHNjZW5lLmxheWVycztcblxuICAgICAgICBzeXN0ZW0uYWRkQ2FtZXJhKHRoaXMpO1xuXG4gICAgICAgIHNjZW5lLm9uKCdzZXQ6bGF5ZXJzJywgdGhpcy5vbkxheWVyc0NoYW5nZWQsIHRoaXMpO1xuICAgICAgICBpZiAobGF5ZXJzKSB7XG4gICAgICAgICAgICBsYXllcnMub24oJ2FkZCcsIHRoaXMub25MYXllckFkZGVkLCB0aGlzKTtcbiAgICAgICAgICAgIGxheWVycy5vbigncmVtb3ZlJywgdGhpcy5vbkxheWVyUmVtb3ZlZCwgdGhpcyk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5lbmFibGVkICYmIHRoaXMuZW50aXR5LmVuYWJsZWQpIHtcbiAgICAgICAgICAgIHRoaXMuYWRkQ2FtZXJhVG9MYXllcnMoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucG9zdEVmZmVjdHMuZW5hYmxlKCk7XG4gICAgfVxuXG4gICAgb25EaXNhYmxlKCkge1xuICAgICAgICBjb25zdCBzeXN0ZW0gPSB0aGlzLnN5c3RlbTtcbiAgICAgICAgY29uc3Qgc2NlbmUgPSBzeXN0ZW0uYXBwLnNjZW5lO1xuICAgICAgICBjb25zdCBsYXllcnMgPSBzY2VuZS5sYXllcnM7XG5cbiAgICAgICAgdGhpcy5wb3N0RWZmZWN0cy5kaXNhYmxlKCk7XG5cbiAgICAgICAgdGhpcy5yZW1vdmVDYW1lcmFGcm9tTGF5ZXJzKCk7XG5cbiAgICAgICAgc2NlbmUub2ZmKCdzZXQ6bGF5ZXJzJywgdGhpcy5vbkxheWVyc0NoYW5nZWQsIHRoaXMpO1xuICAgICAgICBpZiAobGF5ZXJzKSB7XG4gICAgICAgICAgICBsYXllcnMub2ZmKCdhZGQnLCB0aGlzLm9uTGF5ZXJBZGRlZCwgdGhpcyk7XG4gICAgICAgICAgICBsYXllcnMub2ZmKCdyZW1vdmUnLCB0aGlzLm9uTGF5ZXJSZW1vdmVkLCB0aGlzKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHN5c3RlbS5yZW1vdmVDYW1lcmEodGhpcyk7XG4gICAgfVxuXG4gICAgb25SZW1vdmUoKSB7XG4gICAgICAgIHRoaXMub25EaXNhYmxlKCk7XG4gICAgICAgIHRoaXMub2ZmKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQ2FsY3VsYXRlcyBhc3BlY3QgcmF0aW8gdmFsdWUgZm9yIGEgZ2l2ZW4gcmVuZGVyIHRhcmdldC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7UmVuZGVyVGFyZ2V0fSBbcnRdIC0gT3B0aW9uYWwgcmVuZGVyIHRhcmdldC4gSWYgdW5zcGVjaWZpZWQsIHRoZSBiYWNrYnVmZmVyIGlzIHVzZWQuXG4gICAgICogQHJldHVybnMge251bWJlcn0gVGhlIGFzcGVjdCByYXRpbyBvZiB0aGUgcmVuZGVyIHRhcmdldCAob3IgYmFja2J1ZmZlcikuXG4gICAgICovXG4gICAgY2FsY3VsYXRlQXNwZWN0UmF0aW8ocnQpIHtcbiAgICAgICAgY29uc3QgZGV2aWNlID0gdGhpcy5zeXN0ZW0uYXBwLmdyYXBoaWNzRGV2aWNlO1xuICAgICAgICBjb25zdCB3aWR0aCA9IHJ0ID8gcnQud2lkdGggOiBkZXZpY2Uud2lkdGg7XG4gICAgICAgIGNvbnN0IGhlaWdodCA9IHJ0ID8gcnQuaGVpZ2h0IDogZGV2aWNlLmhlaWdodDtcbiAgICAgICAgcmV0dXJuICh3aWR0aCAqIHRoaXMucmVjdC56KSAvIChoZWlnaHQgKiB0aGlzLnJlY3Qudyk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUHJlcGFyZSB0aGUgY2FtZXJhIGZvciBmcmFtZSByZW5kZXJpbmcuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1JlbmRlclRhcmdldH0gcnQgLSBSZW5kZXIgdGFyZ2V0IHRvIHdoaWNoIHJlbmRlcmluZyB3aWxsIGJlIHBlcmZvcm1lZC4gV2lsbCBhZmZlY3RcbiAgICAgKiBjYW1lcmEncyBhc3BlY3QgcmF0aW8sIGlmIGFzcGVjdFJhdGlvTW9kZSBpcyB7QGxpbmsgQVNQRUNUX0FVVE99LlxuICAgICAqIEBpZ25vcmVcbiAgICAgKi9cbiAgICBmcmFtZVVwZGF0ZShydCkge1xuICAgICAgICBpZiAodGhpcy5hc3BlY3RSYXRpb01vZGUgPT09IEFTUEVDVF9BVVRPKSB7XG4gICAgICAgICAgICB0aGlzLmFzcGVjdFJhdGlvID0gdGhpcy5jYWxjdWxhdGVBc3BlY3RSYXRpbyhydCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBdHRlbXB0IHRvIHN0YXJ0IFhSIHNlc3Npb24gd2l0aCB0aGlzIGNhbWVyYS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSB0eXBlIC0gVGhlIHR5cGUgb2Ygc2Vzc2lvbi4gQ2FuIGJlIG9uZSBvZiB0aGUgZm9sbG93aW5nOlxuICAgICAqXG4gICAgICogLSB7QGxpbmsgWFJUWVBFX0lOTElORX06IElubGluZSAtIGFsd2F5cyBhdmFpbGFibGUgdHlwZSBvZiBzZXNzaW9uLiBJdCBoYXMgbGltaXRlZCBmZWF0dXJlXG4gICAgICogYXZhaWxhYmlsaXR5IGFuZCBpcyByZW5kZXJlZCBpbnRvIEhUTUwgZWxlbWVudC5cbiAgICAgKiAtIHtAbGluayBYUlRZUEVfVlJ9OiBJbW1lcnNpdmUgVlIgLSBzZXNzaW9uIHRoYXQgcHJvdmlkZXMgZXhjbHVzaXZlIGFjY2VzcyB0byB0aGUgVlIgZGV2aWNlXG4gICAgICogd2l0aCB0aGUgYmVzdCBhdmFpbGFibGUgdHJhY2tpbmcgZmVhdHVyZXMuXG4gICAgICogLSB7QGxpbmsgWFJUWVBFX0FSfTogSW1tZXJzaXZlIEFSIC0gc2Vzc2lvbiB0aGF0IHByb3ZpZGVzIGV4Y2x1c2l2ZSBhY2Nlc3MgdG8gdGhlIFZSL0FSXG4gICAgICogZGV2aWNlIHRoYXQgaXMgaW50ZW5kZWQgdG8gYmUgYmxlbmRlZCB3aXRoIHRoZSByZWFsLXdvcmxkIGVudmlyb25tZW50LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IHNwYWNlVHlwZSAtIFJlZmVyZW5jZSBzcGFjZSB0eXBlLiBDYW4gYmUgb25lIG9mIHRoZSBmb2xsb3dpbmc6XG4gICAgICpcbiAgICAgKiAtIHtAbGluayBYUlNQQUNFX1ZJRVdFUn06IFZpZXdlciAtIGFsd2F5cyBzdXBwb3J0ZWQgc3BhY2Ugd2l0aCBzb21lIGJhc2ljIHRyYWNraW5nXG4gICAgICogY2FwYWJpbGl0aWVzLlxuICAgICAqIC0ge0BsaW5rIFhSU1BBQ0VfTE9DQUx9OiBMb2NhbCAtIHJlcHJlc2VudHMgYSB0cmFja2luZyBzcGFjZSB3aXRoIGEgbmF0aXZlIG9yaWdpbiBuZWFyIHRoZVxuICAgICAqIHZpZXdlciBhdCB0aGUgdGltZSBvZiBjcmVhdGlvbi4gSXQgaXMgbWVhbnQgZm9yIHNlYXRlZCBvciBiYXNpYyBsb2NhbCBYUiBzZXNzaW9ucy5cbiAgICAgKiAtIHtAbGluayBYUlNQQUNFX0xPQ0FMRkxPT1J9OiBMb2NhbCBGbG9vciAtIHJlcHJlc2VudHMgYSB0cmFja2luZyBzcGFjZSB3aXRoIGEgbmF0aXZlIG9yaWdpblxuICAgICAqIGF0IHRoZSBmbG9vciBpbiBhIHNhZmUgcG9zaXRpb24gZm9yIHRoZSB1c2VyIHRvIHN0YW5kLiBUaGUgeS1heGlzIGVxdWFscyAwIGF0IGZsb29yIGxldmVsLlxuICAgICAqIEZsb29yIGxldmVsIHZhbHVlIG1pZ2h0IGJlIGVzdGltYXRlZCBieSB0aGUgdW5kZXJseWluZyBwbGF0Zm9ybS4gSXQgaXMgbWVhbnQgZm9yIHNlYXRlZCBvclxuICAgICAqIGJhc2ljIGxvY2FsIFhSIHNlc3Npb25zLlxuICAgICAqIC0ge0BsaW5rIFhSU1BBQ0VfQk9VTkRFREZMT09SfTogQm91bmRlZCBGbG9vciAtIHJlcHJlc2VudHMgYSB0cmFja2luZyBzcGFjZSB3aXRoIGl0cyBuYXRpdmVcbiAgICAgKiBvcmlnaW4gYXQgdGhlIGZsb29yLCB3aGVyZSB0aGUgdXNlciBpcyBleHBlY3RlZCB0byBtb3ZlIHdpdGhpbiBhIHByZS1lc3RhYmxpc2hlZCBib3VuZGFyeS5cbiAgICAgKiAtIHtAbGluayBYUlNQQUNFX1VOQk9VTkRFRH06IFVuYm91bmRlZCAtIHJlcHJlc2VudHMgYSB0cmFja2luZyBzcGFjZSB3aGVyZSB0aGUgdXNlciBpc1xuICAgICAqIGV4cGVjdGVkIHRvIG1vdmUgZnJlZWx5IGFyb3VuZCB0aGVpciBlbnZpcm9ubWVudCwgcG90ZW50aWFsbHkgbG9uZyBkaXN0YW5jZXMgZnJvbSB0aGVpclxuICAgICAqIHN0YXJ0aW5nIHBvaW50LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtvYmplY3R9IFtvcHRpb25zXSAtIE9iamVjdCB3aXRoIG9wdGlvbnMgZm9yIFhSIHNlc3Npb24gaW5pdGlhbGl6YXRpb24uXG4gICAgICogQHBhcmFtIHtzdHJpbmdbXX0gW29wdGlvbnMub3B0aW9uYWxGZWF0dXJlc10gLSBPcHRpb25hbCBmZWF0dXJlcyBmb3IgWFJTZXNzaW9uIHN0YXJ0LiBJdCBpc1xuICAgICAqIHVzZWQgZm9yIGdldHRpbmcgYWNjZXNzIHRvIGFkZGl0aW9uYWwgV2ViWFIgc3BlYyBleHRlbnNpb25zLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29wdGlvbnMuaW1hZ2VUcmFja2luZ10gLSBTZXQgdG8gdHJ1ZSB0byBhdHRlbXB0IHRvIGVuYWJsZSB7QGxpbmsgWHJJbWFnZVRyYWNraW5nfS5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtvcHRpb25zLnBsYW5lRGV0ZWN0aW9uXSAtIFNldCB0byB0cnVlIHRvIGF0dGVtcHQgdG8gZW5hYmxlIHtAbGluayBYclBsYW5lRGV0ZWN0aW9ufS5cbiAgICAgKiBAcGFyYW0ge1hyRXJyb3JDYWxsYmFja30gW29wdGlvbnMuY2FsbGJhY2tdIC0gT3B0aW9uYWwgY2FsbGJhY2sgZnVuY3Rpb24gY2FsbGVkIG9uY2UgdGhlXG4gICAgICogc2Vzc2lvbiBpcyBzdGFydGVkLiBUaGUgY2FsbGJhY2sgaGFzIG9uZSBhcmd1bWVudCBFcnJvciAtIGl0IGlzIG51bGwgaWYgdGhlIFhSIHNlc3Npb25cbiAgICAgKiBzdGFydGVkIHN1Y2Nlc3NmdWxseS5cbiAgICAgKiBAcGFyYW0ge29iamVjdH0gW29wdGlvbnMuZGVwdGhTZW5zaW5nXSAtIE9wdGlvbmFsIG9iamVjdCB3aXRoIGRlcHRoIHNlbnNpbmcgcGFyYW1ldGVycyB0b1xuICAgICAqIGF0dGVtcHQgdG8gZW5hYmxlIHtAbGluayBYckRlcHRoU2Vuc2luZ30uXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IFtvcHRpb25zLmRlcHRoU2Vuc2luZy51c2FnZVByZWZlcmVuY2VdIC0gT3B0aW9uYWwgdXNhZ2UgcHJlZmVyZW5jZSBmb3IgZGVwdGhcbiAgICAgKiBzZW5zaW5nLCBjYW4gYmUgJ2NwdS1vcHRpbWl6ZWQnIG9yICdncHUtb3B0aW1pemVkJyAoWFJERVBUSFNFTlNJTkdVU0FHRV8qKSwgZGVmYXVsdHMgdG9cbiAgICAgKiAnY3B1LW9wdGltaXplZCcuIE1vc3QgcHJlZmVycmVkIGFuZCBzdXBwb3J0ZWQgd2lsbCBiZSBjaG9zZW4gYnkgdGhlIHVuZGVybHlpbmcgZGVwdGggc2Vuc2luZ1xuICAgICAqIHN5c3RlbS5cbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gW29wdGlvbnMuZGVwdGhTZW5zaW5nLmRhdGFGb3JtYXRQcmVmZXJlbmNlXSAtIE9wdGlvbmFsIGRhdGEgZm9ybWF0XG4gICAgICogcHJlZmVyZW5jZSBmb3IgZGVwdGggc2Vuc2luZy4gQ2FuIGJlICdsdW1pbmFuY2UtYWxwaGEnIG9yICdmbG9hdDMyJyAoWFJERVBUSFNFTlNJTkdGT1JNQVRfKiksXG4gICAgICogZGVmYXVsdHMgdG8gJ2x1bWluYW5jZS1hbHBoYScuIE1vc3QgcHJlZmVycmVkIGFuZCBzdXBwb3J0ZWQgd2lsbCBiZSBjaG9zZW4gYnkgdGhlIHVuZGVybHlpbmdcbiAgICAgKiBkZXB0aCBzZW5zaW5nIHN5c3RlbS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIE9uIGFuIGVudGl0eSB3aXRoIGEgY2FtZXJhIGNvbXBvbmVudFxuICAgICAqIHRoaXMuZW50aXR5LmNhbWVyYS5zdGFydFhyKHBjLlhSVFlQRV9WUiwgcGMuWFJTUEFDRV9MT0NBTCwge1xuICAgICAqICAgICBjYWxsYmFjazogZnVuY3Rpb24gKGVycikge1xuICAgICAqICAgICAgICAgaWYgKGVycikge1xuICAgICAqICAgICAgICAgICAgIC8vIGZhaWxlZCB0byBzdGFydCBYUiBzZXNzaW9uXG4gICAgICogICAgICAgICB9IGVsc2Uge1xuICAgICAqICAgICAgICAgICAgIC8vIGluIFhSXG4gICAgICogICAgICAgICB9XG4gICAgICogICAgIH1cbiAgICAgKiB9KTtcbiAgICAgKi9cbiAgICBzdGFydFhyKHR5cGUsIHNwYWNlVHlwZSwgb3B0aW9ucykge1xuICAgICAgICB0aGlzLnN5c3RlbS5hcHAueHIuc3RhcnQodGhpcywgdHlwZSwgc3BhY2VUeXBlLCBvcHRpb25zKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBBdHRlbXB0IHRvIGVuZCBYUiBzZXNzaW9uIG9mIHRoaXMgY2FtZXJhLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtYckVycm9yQ2FsbGJhY2t9IFtjYWxsYmFja10gLSBPcHRpb25hbCBjYWxsYmFjayBmdW5jdGlvbiBjYWxsZWQgb25jZSBzZXNzaW9uIGlzXG4gICAgICogZW5kZWQuIFRoZSBjYWxsYmFjayBoYXMgb25lIGFyZ3VtZW50IEVycm9yIC0gaXQgaXMgbnVsbCBpZiBzdWNjZXNzZnVsbHkgZW5kZWQgWFIgc2Vzc2lvbi5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIC8vIE9uIGFuIGVudGl0eSB3aXRoIGEgY2FtZXJhIGNvbXBvbmVudFxuICAgICAqIHRoaXMuZW50aXR5LmNhbWVyYS5lbmRYcihmdW5jdGlvbiAoZXJyKSB7XG4gICAgICogICAgIC8vIG5vdCBhbnltb3JlIGluIFhSXG4gICAgICogfSk7XG4gICAgICovXG4gICAgZW5kWHIoY2FsbGJhY2spIHtcbiAgICAgICAgaWYgKCF0aGlzLl9jYW1lcmEueHIpIHtcbiAgICAgICAgICAgIGlmIChjYWxsYmFjaykgY2FsbGJhY2sobmV3IEVycm9yKCdDYW1lcmEgaXMgbm90IGluIFhSJykpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5fY2FtZXJhLnhyLmVuZChjYWxsYmFjayk7XG4gICAgfVxuXG4gICAgLy8gZnVuY3Rpb24gdG8gY29weSBwcm9wZXJ0aWVzIGZyb20gdGhlIHNvdXJjZSBDYW1lcmFDb21wb25lbnQuXG4gICAgLy8gcHJvcGVydGllcyBub3QgY29waWVkOiBwb3N0RWZmZWN0c1xuICAgIC8vIGluaGVyaXRlZCBwcm9wZXJ0aWVzIG5vdCBjb3BpZWQgKGFsbCk6IHN5c3RlbSwgZW50aXR5LCBlbmFibGVkKVxuICAgIGNvcHkoc291cmNlKSB7XG5cbiAgICAgICAgLy8gY29weSBkYXRhIGRyaXZlbiBwcm9wZXJ0aWVzXG4gICAgICAgIHByb3BlcnRpZXMuZm9yRWFjaCgocHJvcGVydHkpID0+IHtcbiAgICAgICAgICAgIGlmICghcHJvcGVydHkucmVhZG9ubHkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBuYW1lID0gcHJvcGVydHkubmFtZTtcbiAgICAgICAgICAgICAgICB0aGlzW25hbWVdID0gc291cmNlW25hbWVdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBvdGhlciBwcm9wZXJ0aWVzXG4gICAgICAgIHRoaXMuY2xlYXJDb2xvckJ1ZmZlciA9IHNvdXJjZS5jbGVhckNvbG9yQnVmZmVyO1xuICAgICAgICB0aGlzLmNsZWFyRGVwdGhCdWZmZXIgPSBzb3VyY2UuY2xlYXJEZXB0aEJ1ZmZlcjtcbiAgICAgICAgdGhpcy5jbGVhclN0ZW5jaWxCdWZmZXIgPSBzb3VyY2UuY2xlYXJTdGVuY2lsQnVmZmVyO1xuICAgICAgICB0aGlzLmRpc2FibGVQb3N0RWZmZWN0c0xheWVyID0gc291cmNlLmRpc2FibGVQb3N0RWZmZWN0c0xheWVyO1xuICAgICAgICB0aGlzLmxheWVycyA9IHNvdXJjZS5sYXllcnM7XG4gICAgICAgIHRoaXMucHJpb3JpdHkgPSBzb3VyY2UucHJpb3JpdHk7XG4gICAgICAgIHRoaXMucmVuZGVyVGFyZ2V0ID0gc291cmNlLnJlbmRlclRhcmdldDtcbiAgICAgICAgdGhpcy5yZWN0ID0gc291cmNlLnJlY3Q7XG4gICAgICAgIHRoaXMuYXBlcnR1cmUgPSBzb3VyY2UuYXBlcnR1cmU7XG4gICAgICAgIHRoaXMuc2Vuc2l0aXZpdHkgPSBzb3VyY2Uuc2Vuc2l0aXZpdHk7XG4gICAgICAgIHRoaXMuc2h1dHRlciA9IHNvdXJjZS5zaHV0dGVyO1xuICAgIH1cbn1cblxuLy8gZm9yIGNvbW1vbiBwcm9wZXJ0aWVzLCBjcmVhdGUgZ2V0dGVycyBhbmQgc2V0dGVycyB3aGljaCB1c2UgdGhpcy5fY2FtZXJhIGFzIGEgc3RvcmFnZSBmb3IgdGhlaXIgdmFsdWVzXG5wcm9wZXJ0aWVzLmZvckVhY2goZnVuY3Rpb24gKHByb3BlcnR5KSB7XG4gICAgY29uc3QgbmFtZSA9IHByb3BlcnR5Lm5hbWU7XG4gICAgY29uc3Qgb3B0aW9ucyA9IHt9O1xuXG4gICAgLy8gZ2V0dGVyXG4gICAgb3B0aW9ucy5nZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9jYW1lcmFbbmFtZV07XG4gICAgfTtcblxuICAgIC8vIHNldHRlclxuICAgIGlmICghcHJvcGVydHkucmVhZG9ubHkpIHtcbiAgICAgICAgb3B0aW9ucy5zZXQgPSBmdW5jdGlvbiAobmV3VmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuX2NhbWVyYVtuYW1lXSA9IG5ld1ZhbHVlO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShDYW1lcmFDb21wb25lbnQucHJvdG90eXBlLCBuYW1lLCBvcHRpb25zKTtcbn0pO1xuXG5leHBvcnQgeyBDYW1lcmFDb21wb25lbnQgfTtcbiJdLCJuYW1lcyI6WyJwcm9wZXJ0aWVzIiwibmFtZSIsInJlYWRvbmx5IiwiQ2FtZXJhQ29tcG9uZW50IiwiQ29tcG9uZW50IiwiY29uc3RydWN0b3IiLCJzeXN0ZW0iLCJlbnRpdHkiLCJvblBvc3Rwcm9jZXNzaW5nIiwib25QcmVSZW5kZXIiLCJvblBvc3RSZW5kZXIiLCJfcmVuZGVyU2NlbmVEZXB0aE1hcCIsIl9yZW5kZXJTY2VuZUNvbG9yTWFwIiwiX2NhbWVyYSIsIkNhbWVyYSIsIm5vZGUiLCJfcHJpb3JpdHkiLCJfZGlzYWJsZVBvc3RFZmZlY3RzTGF5ZXIiLCJMQVlFUklEX1VJIiwiX3Bvc3RFZmZlY3RzIiwiUG9zdEVmZmVjdFF1ZXVlIiwiYXBwIiwiY2FtZXJhIiwiY2xlYXJDb2xvckJ1ZmZlciIsInZhbHVlIiwiZGlydHlMYXllckNvbXBvc2l0aW9uQ2FtZXJhcyIsImNsZWFyRGVwdGhCdWZmZXIiLCJjbGVhclN0ZW5jaWxCdWZmZXIiLCJkaXNhYmxlUG9zdEVmZmVjdHNMYXllciIsImxheWVyIiwiX2VuYWJsZURlcHRoTGF5ZXIiLCJoYXNEZXB0aExheWVyIiwibGF5ZXJzIiwiZmluZCIsImxheWVySWQiLCJMQVlFUklEX0RFUFRIIiwiZGVwdGhMYXllciIsInNjZW5lIiwiZ2V0TGF5ZXJCeUlkIiwiaW5jcmVtZW50Q291bnRlciIsImRlY3JlbWVudENvdW50ZXIiLCJyZXF1ZXN0U2NlbmVDb2xvck1hcCIsImVuYWJsZWQiLCJvayIsIkRlYnVnIiwid2Fybk9uY2UiLCJyZW5kZXJTY2VuZUNvbG9yTWFwIiwicmVxdWVzdFNjZW5lRGVwdGhNYXAiLCJyZW5kZXJTY2VuZURlcHRoTWFwIiwiZnJ1c3R1bSIsIm5ld1ZhbHVlIiwiaSIsImxlbmd0aCIsInJlbW92ZUNhbWVyYSIsImFkZENhbWVyYSIsImxheWVyc1NldCIsInBvc3RFZmZlY3RzRW5hYmxlZCIsInBvc3RFZmZlY3RzIiwicHJpb3JpdHkiLCJwcm9qZWN0aW9uTWF0cml4IiwiYXBlcnR1cmUiLCJzZW5zaXRpdml0eSIsInNodXR0ZXIiLCJyZWN0IiwiZmlyZSIsInJlbmRlclRhcmdldCIsInZpZXdNYXRyaXgiLCJsYXllckNvbXAiLCJfZGlydHlDYW1lcmFzIiwic2NyZWVuVG9Xb3JsZCIsInNjcmVlbngiLCJzY3JlZW55IiwiY2FtZXJheiIsIndvcmxkQ29vcmQiLCJkZXZpY2UiLCJncmFwaGljc0RldmljZSIsInciLCJjbGllbnRSZWN0Iiwid2lkdGgiLCJoIiwiaGVpZ2h0Iiwid29ybGRUb1NjcmVlbiIsInNjcmVlbkNvb3JkIiwib25BcHBQcmVyZW5kZXIiLCJfdmlld01hdERpcnR5IiwiX3ZpZXdQcm9qTWF0RGlydHkiLCJhZGRDYW1lcmFUb0xheWVycyIsInJlbW92ZUNhbWVyYUZyb21MYXllcnMiLCJvbkxheWVyc0NoYW5nZWQiLCJvbGRDb21wIiwibmV3Q29tcCIsIm9mZiIsIm9uTGF5ZXJBZGRlZCIsIm9uTGF5ZXJSZW1vdmVkIiwib24iLCJpbmRleCIsImluZGV4T2YiLCJpZCIsIm9uRW5hYmxlIiwiZW5hYmxlIiwib25EaXNhYmxlIiwiZGlzYWJsZSIsIm9uUmVtb3ZlIiwiY2FsY3VsYXRlQXNwZWN0UmF0aW8iLCJydCIsInoiLCJmcmFtZVVwZGF0ZSIsImFzcGVjdFJhdGlvTW9kZSIsIkFTUEVDVF9BVVRPIiwiYXNwZWN0UmF0aW8iLCJzdGFydFhyIiwidHlwZSIsInNwYWNlVHlwZSIsIm9wdGlvbnMiLCJ4ciIsInN0YXJ0IiwiZW5kWHIiLCJjYWxsYmFjayIsIkVycm9yIiwiZW5kIiwiY29weSIsInNvdXJjZSIsImZvckVhY2giLCJwcm9wZXJ0eSIsImdldCIsInNldCIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwicHJvdG90eXBlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQW9CQSxNQUFNQSxVQUFVLEdBQUcsQ0FDZjtBQUFFQyxFQUFBQSxJQUFJLEVBQUUsYUFBUjtBQUF1QkMsRUFBQUEsUUFBUSxFQUFFLEtBQUE7QUFBakMsQ0FEZSxFQUVmO0FBQUVELEVBQUFBLElBQUksRUFBRSxpQkFBUjtBQUEyQkMs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
