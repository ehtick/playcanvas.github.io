/**
 * @license
 * PlayCanvas Engine v1.63.0-dev revision 9f3635a4e (DEBUG PROFILER)
 * Copyright 2011-2023 PlayCanvas Ltd. All rights reserved.
 */
import { Debug } from '../../../core/debug.js';
import { TEXHINT_ASSET, ADDRESS_CLAMP_TO_EDGE, ADDRESS_REPEAT, PIXELFORMAT_DXT1, PIXELFORMAT_DXT3, PIXELFORMAT_DXT5, PIXELFORMAT_ETC1, PIXELFORMAT_ETC2_RGB, PIXELFORMAT_ETC2_RGBA, PIXELFORMAT_PVRTC_4BPP_RGB_1, PIXELFORMAT_PVRTC_2BPP_RGB_1, PIXELFORMAT_PVRTC_4BPP_RGBA_1, PIXELFORMAT_PVRTC_2BPP_RGBA_1, PIXELFORMAT_RGB8, PIXELFORMAT_RGBA8, PIXELFORMAT_SRGB, PIXELFORMAT_SRGBA, PIXELFORMAT_111110F, PIXELFORMAT_RGB16F, PIXELFORMAT_RGBA16F } from '../../../platform/graphics/constants.js';
import { Texture } from '../../../platform/graphics/texture.js';
import { Asset } from '../../asset/asset.js';

/** @typedef {import('../../handlers/texture.js').TextureParser} TextureParser */

// Defined here: https://www.khronos.org/opengles/sdk/tools/KTX/file_format_spec/
const IDENTIFIER = [0x58544BAB, 0xBB313120, 0x0A1A0A0D]; // «KTX 11»\r\n\x1A\n

const KNOWN_FORMATS = {
  // compressed formats
  0x83F0: PIXELFORMAT_DXT1,
  0x83F2: PIXELFORMAT_DXT3,
  0x83F3: PIXELFORMAT_DXT5,
  0x8D64: PIXELFORMAT_ETC1,
  0x9274: PIXELFORMAT_ETC2_RGB,
  0x9278: PIXELFORMAT_ETC2_RGBA,
  0x8C00: PIXELFORMAT_PVRTC_4BPP_RGB_1,
  0x8C01: PIXELFORMAT_PVRTC_2BPP_RGB_1,
  0x8C02: PIXELFORMAT_PVRTC_4BPP_RGBA_1,
  0x8C03: PIXELFORMAT_PVRTC_2BPP_RGBA_1,
  // uncompressed formats
  0x8051: PIXELFORMAT_RGB8,
  // GL_RGB8
  0x8058: PIXELFORMAT_RGBA8,
  // GL_RGBA8
  0x8C41: PIXELFORMAT_SRGB,
  // GL_SRGB8
  0x8C43: PIXELFORMAT_SRGBA,
  // GL_SRGB8_ALPHA8
  0x8C3A: PIXELFORMAT_111110F,
  // GL_R11F_G11F_B10F
  0x881B: PIXELFORMAT_RGB16F,
  // GL_RGB16F
  0x881A: PIXELFORMAT_RGBA16F // GL_RGBA16F
};

function createContainer(pixelFormat, buffer, byteOffset, byteSize) {
  return pixelFormat === PIXELFORMAT_111110F ? new Uint32Array(buffer, byteOffset, byteSize / 4) : new Uint8Array(buffer, byteOffset, byteSize);
}

/**
 * Texture parser for ktx files.
 *
 * @implements {TextureParser}
 * @ignore
 */
class KtxParser {
  constructor(registry) {
    this.maxRetries = 0;
  }
  load(url, callback, asset) {
    Asset.fetchArrayBuffer(url.load, callback, asset, this.maxRetries);
  }
  open(url, data, device) {
    const textureData = this.parse(data);
    if (!textureData) {
      return null;
    }
    const texture = new Texture(device, {
      name: url,
      profilerHint: TEXHINT_ASSET,
      addressU: textureData.cubemap ? ADDRESS_CLAMP_TO_EDGE : ADDRESS_REPEAT,
      addressV: textureData.cubemap ? ADDRESS_CLAMP_TO_EDGE : ADDRESS_REPEAT,
      width: textureData.width,
      height: textureData.height,
      format: textureData.format,
      cubemap: textureData.cubemap,
      levels: textureData.levels
    });
    texture.upload();
    return texture;
  }
  parse(data) {
    const dataU32 = new Uint32Array(data);

    // check magic bits
    if (IDENTIFIER[0] !== dataU32[0] || IDENTIFIER[1] !== dataU32[1] || IDENTIFIER[2] !== dataU32[2]) {
      Debug.warn('Invalid definition header found in KTX file. Expected 0xAB4B5458, 0x203131BB, 0x0D0A1A0A');
      return null;
    }

    // unpack header info
    const header = {
      endianness: dataU32[3],
      // todo: Use this information
      glType: dataU32[4],
      glTypeSize: dataU32[5],
      glFormat: dataU32[6],
      glInternalFormat: dataU32[7],
      glBaseInternalFormat: dataU32[8],
      pixelWidth: dataU32[9],
      pixelHeight: dataU32[10],
      pixelDepth: dataU32[11],
      numberOfArrayElements: dataU32[12],
      numberOfFaces: dataU32[13],
      numberOfMipmapLevels: dataU32[14],
      bytesOfKeyValueData: dataU32[15]
    };

    // don't support volume textures
    if (header.pixelDepth > 1) {
      Debug.warn('More than 1 pixel depth not supported!');
      return null;
    }

    // don't support texture arrays
    if (header.numberOfArrayElements !== 0) {
      Debug.warn('Array texture not supported!');
      return null;
    }
    const format = KNOWN_FORMATS[header.glInternalFormat];

    // only support subset of pixel formats
    if (format === undefined) {
      Debug.warn('Unknown glInternalFormat: ' + header.glInternalFormat);
      return null;
    }

    // offset locating the first byte of texture level data
    let offset = 16 + header.bytesOfKeyValueData / 4;
    const isCubemap = header.numberOfFaces > 1;
    const levels = [];
    for (let mipmapLevel = 0; mipmapLevel < (header.numberOfMipmapLevels || 1); mipmapLevel++) {
      const imageSizeInBytes = dataU32[offset++];
      if (isCubemap) {
        levels.push([]);
      }
      const target = isCubemap ? levels[mipmapLevel] : levels;
      for (let face = 0; face < (isCubemap ? 6 : 1); ++face) {
        target.push(createContainer(format, data, offset * 4, imageSizeInBytes));
        offset += imageSizeInBytes + 3 >> 2;
      }
    }
    return {
      format: format,
      width: header.pixelWidth,
      height: header.pixelHeight,
      levels: levels,
      cubemap: isCubemap
    };
  }
}

export { KtxParser };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoia3R4LmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvZnJhbWV3b3JrL3BhcnNlcnMvdGV4dHVyZS9rdHguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRGVidWcgfSBmcm9tICcuLi8uLi8uLi9jb3JlL2RlYnVnLmpzJztcblxuaW1wb3J0IHtcbiAgICBBRERSRVNTX0NMQU1QX1RPX0VER0UsIEFERFJFU1NfUkVQRUFULFxuICAgIFBJWEVMRk9STUFUX0RYVDEsIFBJWEVMRk9STUFUX0RYVDMsIFBJWEVMRk9STUFUX0RYVDUsXG4gICAgUElYRUxGT1JNQVRfRVRDMSwgUElYRUxGT1JNQVRfRVRDMl9SR0IsIFBJWEVMRk9STUFUX0VUQzJfUkdCQSxcbiAgICBQSVhFTEZPUk1BVF9QVlJUQ180QlBQX1JHQl8xLCBQSVhFTEZPUk1BVF9QVlJUQ18yQlBQX1JHQl8xLCBQSVhFTEZPUk1BVF9QVlJUQ180QlBQX1JHQkFfMSwgUElYRUxGT1JNQVRfUFZSVENfMkJQUF9SR0JBXzEsXG4gICAgUElYRUxGT1JNQVRfUkdCOCwgUElYRUxGT1JNQVRfUkdCQTgsIFBJWEVMRk9STUFUX1NSR0IsIFBJWEVMRk9STUFUX1NSR0JBLFxuICAgIFBJWEVMRk9STUFUXzExMTExMEYsIFBJWEVMRk9STUFUX1JHQjE2RiwgUElYRUxGT1JNQVRfUkdCQTE2RixcbiAgICBURVhISU5UX0FTU0VUXG59IGZyb20gJy4uLy4uLy4uL3BsYXRmb3JtL2dyYXBoaWNzL2NvbnN0YW50cy5qcyc7XG5pbXBvcnQgeyBUZXh0dXJlIH0gZnJvbSAnLi4vLi4vLi4vcGxhdGZvcm0vZ3JhcGhpY3MvdGV4dHVyZS5qcyc7XG5cbmltcG9ydCB7IEFzc2V0IH0gZnJvbSAnLi4vLi4vYXNzZXQvYXNzZXQuanMnO1xuXG4vKiogQHR5cGVkZWYge2ltcG9ydCgnLi4vLi4vaGFuZGxlcnMvdGV4dHVyZS5qcycpLlRleHR1cmVQYXJzZXJ9IFRleHR1cmVQYXJzZXIgKi9cblxuLy8gRGVmaW5lZCBoZXJlOiBodHRwczovL3d3dy5raHJvbm9zLm9yZy9vcGVuZ2xlcy9zZGsvdG9vbHMvS1RYL2ZpbGVfZm9ybWF0X3NwZWMvXG5jb25zdCBJREVOVElGSUVSID0gWzB4NTg1NDRCQUIsIDB4QkIzMTMxMjAsIDB4MEExQTBBMERdOyAvLyDCq0tUWCAxMcK7XFxyXFxuXFx4MUFcXG5cblxuY29uc3QgS05PV05fRk9STUFUUyA9IHtcbiAgICAvLyBjb21wcmVzc2VkIGZvcm1hdHNcbiAgICAweDgzRjA6IFBJWEVMRk9STUFUX0RYVDEsXG4gICAgMHg4M0YyOiBQSVhFTEZPUk1BVF9EWFQzLFxuICAgIDB4ODNGMzogUElYRUxGT1JNQVRfRFhUNSxcbiAgICAweDhENjQ6IFBJWEVMRk9STUFUX0VUQzEsXG4gICAgMHg5Mjc0OiBQSVhFTEZPUk1BVF9FVEMyX1JHQixcbiAgICAweDkyNzg6IFBJWEVMRk9STUFUX0VUQzJfUkdCQSxcbiAgICAweDhDMDA6IFBJWEVMRk9STUFUX1BWUlRDXzRCUFBfUkdCXzEsXG4gICAgMHg4QzAxOiBQSVhFTEZPUk1BVF9QVlJUQ18yQlBQX1JHQl8xLFxuICAgIDB4OEMwMjogUElYRUxGT1JNQVRfUFZSVENfNEJQUF9SR0JBXzEsXG4gICAgMHg4QzAzOiBQSVhFTEZPUk1BVF9QVlJUQ18yQlBQX1JHQkFfMSxcblxuICAgIC8vIHVuY29tcHJlc3NlZCBmb3JtYXRzXG4gICAgMHg4MDUxOiBQSVhFTEZPUk1BVF9SR0I4LCAgICAgICAvLyBHTF9SR0I4XG4gICAgMHg4MDU4OiBQSVhFTEZPUk1BVF9SR0JBOCwgICAgLy8gR0xfUkdCQThcbiAgICAweDhDNDE6IFBJWEVMRk9STUFUX1NSR0IsICAgICAgICAgICAvLyBHTF9TUkdCOFxuICAgIDB4OEM0MzogUElYRUxGT1JNQVRfU1JHQkEsICAgICAgICAgIC8vIEdMX1NSR0I4X0FMUEhBOFxuICAgIDB4OEMzQTogUElYRUxGT1JNQVRfMTExMTEwRiwgICAgICAgIC8vIEdMX1IxMUZfRzExRl9CMTBGXG4gICAgMHg4ODFCOiBQSVhFTEZPUk1BVF9SR0IxNkYsICAgICAgICAgLy8gR0xfUkdCMTZGXG4gICAgMHg4ODFBOiBQSVhFTEZPUk1BVF9SR0JBMTZGICAgICAgICAgLy8gR0xfUkdCQTE2RlxufTtcblxuZnVuY3Rpb24gY3JlYXRlQ29udGFpbmVyKHBpeGVsRm9ybWF0LCBidWZmZXIsIGJ5dGVPZmZzZXQsIGJ5dGVTaXplKSB7XG4gICAgcmV0dXJuIChwaXhlbEZvcm1hdCA9PT0gUElYRUxGT1JNQVRfMTExMTEwRikgP1xuICAgICAgICBuZXcgVWludDMyQXJyYXkoYnVmZmVyLCBieXRlT2Zmc2V0LCBieXRlU2l6ZSAvIDQpIDpcbiAgICAgICAgbmV3IFVpbnQ4QXJyYXkoYnVmZmVyLCBieXRlT2Zmc2V0LCBieXRlU2l6ZSk7XG59XG5cbi8qKlxuICogVGV4dHVyZSBwYXJzZXIgZm9yIGt0eCBmaWxlcy5cbiAqXG4gKiBAaW1wbGVtZW50cyB7VGV4dHVyZVBhcnNlcn1cbiAqIEBpZ25vcmVcbiAqL1xuY2xhc3MgS3R4UGFyc2VyIHtcbiAgICBjb25zdHJ1Y3RvcihyZWdpc3RyeSkge1xuICAgICAgICB0aGlzLm1heFJldHJpZXMgPSAwO1xuICAgIH1cblxuICAgIGxvYWQodXJsLCBjYWxsYmFjaywgYXNzZXQpIHtcbiAgICAgICAgQXNzZXQuZmV0Y2hBcnJheUJ1ZmZlcih1cmwubG9hZCwgY2FsbGJhY2ssIGFzc2V0LCB0aGlzLm1heFJldHJpZXMpO1xuICAgIH1cblxuICAgIG9wZW4odXJsLCBkYXRhLCBkZXZpY2UpIHtcbiAgICAgICAgY29uc3QgdGV4dHVyZURhdGEgPSB0aGlzLnBhcnNlKGRhdGEpO1xuXG4gICAgICAgIGlmICghdGV4dHVyZURhdGEpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgdGV4dHVyZSA9IG5ldyBUZXh0dXJlKGRldmljZSwge1xuICAgICAgICAgICAgbmFtZTogdXJsLFxuICAgICAgICAgICAgLy8gI2lmIF9QUk9GSUxFUlxuICAgICAgICAgICAgcHJvZmlsZXJIaW50OiBURVhISU5UX0FTU0VULFxuICAgICAgICAgICAgLy8gI2VuZGlmXG4gICAgICAgICAgICBhZGRyZXNzVTogdGV4dHVyZURhdGEuY3ViZW1hcCA/IEFERFJFU1NfQ0xBTVBfVE9fRURHRSA6IEFERFJFU1NfUkVQRUFULFxuICAgICAgICAgICAgYWRkcmVzc1Y6IHRleHR1cmVEYXRhLmN1YmVtYXAgPyBBRERSRVNTX0NMQU1QX1RPX0VER0UgOiBBRERSRVNTX1JFUEVBVCxcbiAgICAgICAgICAgIHdpZHRoOiB0ZXh0dXJlRGF0YS53aWR0aCxcbiAgICAgICAgICAgIGhlaWdodDogdGV4dHVyZURhdGEuaGVpZ2h0LFxuICAgICAgICAgICAgZm9ybWF0OiB0ZXh0dXJlRGF0YS5mb3JtYXQsXG4gICAgICAgICAgICBjdWJlbWFwOiB0ZXh0dXJlRGF0YS5jdWJlbWFwLFxuICAgICAgICAgICAgbGV2ZWxzOiB0ZXh0dXJlRGF0YS5sZXZlbHNcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGV4dHVyZS51cGxvYWQoKTtcblxuICAgICAgICByZXR1cm4gdGV4dHVyZTtcbiAgICB9XG5cbiAgICBwYXJzZShkYXRhKSB7XG4gICAgICAgIGNvbnN0IGRhdGFVMzIgPSBuZXcgVWludDMyQXJyYXkoZGF0YSk7XG5cbiAgICAgICAgLy8gY2hlY2sgbWFnaWMgYml0c1xuICAgICAgICBpZiAoSURFTlRJRklFUlswXSAhPT0gZGF0YVUzMlswXSB8fFxuICAgICAgICAgICAgSURFTlRJRklFUlsxXSAhPT0gZGF0YVUzMlsxXSB8fFxuICAgICAgICAgICAgSURFTlRJRklFUlsyXSAhPT0gZGF0YVUzMlsyXSkge1xuICAgICAgICAgICAgRGVidWcud2FybignSW52YWxpZCBkZWZpbml0aW9uIGhlYWRlciBmb3VuZCBpbiBLVFggZmlsZS4gRXhwZWN0ZWQgMHhBQjRCNTQ1OCwgMHgyMDMxMzFCQiwgMHgwRDBBMUEwQScpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICAvLyB1bnBhY2sgaGVhZGVyIGluZm9cbiAgICAgICAgY29uc3QgaGVhZGVyID0ge1xuICAgICAgICAgICAgZW5kaWFubmVzczogZGF0YVUzMlszXSwgLy8gdG9kbzogVXNlIHRoaXMgaW5mb3JtYXRpb25cbiAgICAgICAgICAgIGdsVHlwZTogZGF0YVUzMls0XSxcbiAgICAgICAgICAgIGdsVHlwZVNpemU6IGRhdGFVMzJbNV0sXG4gICAgICAgICAgICBnbEZvcm1hdDogZGF0YVUzMls2XSxcbiAgICAgICAgICAgIGdsSW50ZXJuYWxGb3JtYXQ6IGRhdGFVMzJbN10sXG4gICAgICAgICAgICBnbEJhc2VJbnRlcm5hbEZvcm1hdDogZGF0YVUzMls4XSxcbiAgICAgICAgICAgIHBpeGVsV2lkdGg6IGRhdGFVMzJbOV0sXG4gICAgICAgICAgICBwaXhlbEhlaWdodDogZGF0YVUzMlsxMF0sXG4gICAgICAgICAgICBwaXhlbERlcHRoOiBkYXRhVTMyWzExXSxcbiAgICAgICAgICAgIG51bWJlck9mQXJyYXlFbGVtZW50czogZGF0YVUzMlsxMl0sXG4gICAgICAgICAgICBudW1iZXJPZkZhY2VzOiBkYXRhVTMyWzEzXSxcbiAgICAgICAgICAgIG51bWJlck9mTWlwbWFwTGV2ZWxzOiBkYXRhVTMyWzE0XSxcbiAgICAgICAgICAgIGJ5dGVzT2ZLZXlWYWx1ZURhdGE6IGRhdGFVMzJbMTVdXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gZG9uJ3Qgc3VwcG9ydCB2b2x1bWUgdGV4dHVyZXNcbiAgICAgICAgaWYgKGhlYWRlci5waXhlbERlcHRoID4gMSkge1xuICAgICAgICAgICAgRGVidWcud2FybignTW9yZSB0aGFuIDEgcGl4ZWwgZGVwdGggbm90IHN1cHBvcnRlZCEnKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gZG9uJ3Qgc3VwcG9ydCB0ZXh0dXJlIGFycmF5c1xuICAgICAgICBpZiAoaGVhZGVyLm51bWJlck9mQXJyYXlFbGVtZW50cyAhPT0gMCkge1xuICAgICAgICAgICAgRGVidWcud2FybignQXJyYXkgdGV4dHVyZSBub3Qgc3VwcG9ydGVkIScpO1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBmb3JtYXQgPSBLTk9XTl9GT1JNQVRTW2hlYWRlci5nbEludGVybmFsRm9ybWF0XTtcblxuICAgICAgICAvLyBvbmx5IHN1cHBvcnQgc3Vic2V0IG9mIHBpeGVsIGZvcm1hdHNcbiAgICAgICAgaWYgKGZvcm1hdCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICBEZWJ1Zy53YXJuKCdVbmtub3duIGdsSW50ZXJuYWxGb3JtYXQ6ICcgKyBoZWFkZXIuZ2xJbnRlcm5hbEZvcm1hdCk7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIG9mZnNldCBsb2NhdGluZyB0aGUgZmlyc3QgYnl0ZSBvZiB0ZXh0dXJlIGxldmVsIGRhdGFcbiAgICAgICAgbGV0IG9mZnNldCA9IDE2ICsgaGVhZGVyLmJ5dGVzT2ZLZXlWYWx1ZURhdGEgLyA0O1xuXG4gICAgICAgIGNvbnN0IGlzQ3ViZW1hcCA9IChoZWFkZXIubnVtYmVyT2ZGYWNlcyA+IDEpO1xuICAgICAgICBjb25zdCBsZXZlbHMgPSBbXTtcbiAgICAgICAgZm9yIChsZXQgbWlwbWFwTGV2ZWwgPSAwOyBtaXBtYXBMZXZlbCA8IChoZWFkZXIubnVtYmVyT2ZNaXBtYXBMZXZlbHMgfHwgMSk7IG1pcG1hcExldmVsKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGltYWdlU2l6ZUluQnl0ZXMgPSBkYXRhVTMyW29mZnNldCsrXTtcblxuICAgICAgICAgICAgaWYgKGlzQ3ViZW1hcCkge1xuICAgICAgICAgICAgICAgIGxldmVscy5wdXNoKFtdKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgdGFyZ2V0ID0gaXNDdWJlbWFwID8gbGV2ZWxzW21pcG1hcExldmVsXSA6IGxldmVscztcblxuICAgICAgICAgICAgZm9yIChsZXQgZmFjZSA9IDA7IGZhY2UgPCAoaXNDdWJlbWFwID8gNiA6IDEpOyArK2ZhY2UpIHtcbiAgICAgICAgICAgICAgICB0YXJnZXQucHVzaChjcmVhdGVDb250YWluZXIoZm9ybWF0LCBkYXRhLCBvZmZzZXQgKiA0LCBpbWFnZVNpemVJbkJ5dGVzKSk7XG4gICAgICAgICAgICAgICAgb2Zmc2V0ICs9IChpbWFnZVNpemVJbkJ5dGVzICsgMykgPj4gMjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBmb3JtYXQ6IGZvcm1hdCxcbiAgICAgICAgICAgIHdpZHRoOiBoZWFkZXIucGl4ZWxXaWR0aCxcbiAgICAgICAgICAgIGhlaWdodDogaGVhZGVyLnBpeGVsSGVpZ2h0LFxuICAgICAgICAgICAgbGV2ZWxzOiBsZXZlbHMsXG4gICAgICAgICAgICBjdWJlbWFwOiBpc0N1YmVtYXBcbiAgICAgICAgfTtcbiAgICB9XG59XG5cbmV4cG9ydCB7IEt0eFBhcnNlciB9O1xuIl0sIm5hbWVzIjpbIklERU5USUZJRVIiLCJLTk9XTl9GT1JNQVRTIiwiUElYRUxGT1JNQVRfRFhUMSIsIlBJWEVMRk9STUFUX0RYVDMiLCJQSVhFTEZPUk1BVF9EWFQ1IiwiUElYRUxGT1JNQVRfRVRDMSIsIlBJWEVMRk9STUFUX0VUQzJfUkdCIiwiUElYRUxGT1JNQVRfRVRDMl9SR0JBIiwiUElYRUxGT1JNQVRfUFZSVENfNEJQUF9SR0JfMSIsIlBJWEVMRk9STUFUX1BWUlRDXzJCUFBfUkdCXzEiLCJQSVhFTEZPUk1BVF9QVlJUQ180QlBQX1JHQkFfMSIsIlBJWEVMRk9STUFUX1BWUlRDXzJCUFBfUkdCQV8xIiwiUElYRUxGT1JNQVRfUkdCOCIsIlBJWEVMRk9STUFUX1JHQkE4IiwiUElYRUxGT1JNQVRfU1JHQiIsIlBJWEVMRk9STUFUX1NSR0JBIiwiUElYRUxGT1JNQVRfMTExMTEwRiIsIlBJWEVMRk9STUFUX1JHQjE2RiIsIlBJWEVMRk9STUFUX1JHQkExNkYiLCJjcmVhdGVDb250YWluZXIiLCJwaXhlbEZvcm1hdCIsImJ1ZmZlciIsImJ5dGVPZmZzZXQiLCJieXRlU2l6ZSIsIlVpbnQzMkFycmF5IiwiVWludDhBcnJheSIsIkt0eFBhcnNlciIsImNvbnN0cnVjdG9yIiwicmVnaXN0cnkiLCJtYXhSZXRyaWVzIiwibG9hZCIsInVybCIsImNhbGxiYWNrIiwiYXNzZXQiLCJBc3NldCIsImZldGNoQXJyYXlCdWZmZXIiLCJvcGVuIiwiZGF0YSIsImRldmljZSIsInRleHR1cmVEYXRhIiwicGFyc2UiLCJ0ZXh0dXJlIiwiVGV4dHVyZSIsIm5hbWUiLCJwcm9maWxlckhpbnQiLCJURVhISU5UX0FTU0VUIiwiYWRkcmVzc1UiLCJjdWJlbWFwIiwiQUREUkVTU19DTEFNUF9UT19FREdFIiwiQUREUkVTU19SRVBFQVQiLCJhZGRyZXNzViIsIndpZHRoIiwiaGVpZ2h0IiwiZm9ybWF0IiwibGV2ZWxzIiwidXBsb2FkIiwiZGF0YVUzMiIsIkRlYnVnIiwid2FybiIsImhlYWRlciIsImVuZGlhbm5lc3MiLCJnbFR5cGUiLCJnbFR5cGVTaXplIiwiZ2xGb3JtYXQiLCJnbEludGVybmFsRm9ybWF0IiwiZ2xCYXNlSW50ZXJuYWxGb3JtYXQiLCJwaXhlbFdpZHRoIiwicGl4ZWxIZWlnaHQiLCJwaXhlbERlcHRoIiwibnVtYmVyT2ZBcnJheUVsZW1lbnRzIiwibnVtYmVyT2ZGYWNlcyIsIm51bWJlck9mTWlwbWFwTGV2ZWxzIiwiYnl0ZXNPZktleVZhbHVlRGF0YSIsInVuZGVmaW5lZCIsIm9mZnNldCIsImlzQ3ViZW1hcCIsIm1pcG1hcExldmVsIiwiaW1hZ2VTaXplSW5CeXRlcyIsInB1c2giLCJ0YXJnZXQiLCJmYWNlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBZUE7O0FBRUE7QUFDQSxNQUFNQSxVQUFVLEdBQUcsQ0FBQyxVQUFVLEVBQUUsVUFBVSxFQUFFLFVBQVUsQ0FBQyxDQUFDOztBQUV4RCxNQUFNQyxhQUFhLEdBQUc7QUFDbEI7QUFDQSxFQUFB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
