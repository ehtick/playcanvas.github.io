/**
 * @license
 * PlayCanvas Engine v1.57.0 revision f1998a31e (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
class EventHandler {
  constructor() {
    this._callbacks = {};
    this._callbackActive = {};
  }

  initEventHandler() {
    this._callbacks = {};
    this._callbackActive = {};
  }

  _addCallback(name, callback, scope, once = false) {
    if (!name || typeof name !== 'string' || !callback) return;
    if (!this._callbacks[name]) this._callbacks[name] = [];
    if (this._callbackActive[name] && this._callbackActive[name] === this._callbacks[name]) this._callbackActive[name] = this._callbackActive[name].slice();

    this._callbacks[name].push({
      callback: callback,
      scope: scope || this,
      once: once
    });
  }

  on(name, callback, scope) {
    this._addCallback(name, callback, scope, false);

    return this;
  }

  off(name, callback, scope) {
    if (name) {
      if (this._callbackActive[name] && this._callbackActive[name] === this._callbacks[name]) this._callbackActive[name] = this._callbackActive[name].slice();
    } else {
      for (const key in this._callbackActive) {
        if (!this._callbacks[key]) continue;
        if (this._callbacks[key] !== this._callbackActive[key]) continue;
        this._callbackActive[key] = this._callbackActive[key].slice();
      }
    }

    if (!name) {
      this._callbacks = {};
    } else if (!callback) {
      if (this._callbacks[name]) this._callbacks[name] = [];
    } else {
      const events = this._callbacks[name];
      if (!events) return this;
      let count = events.length;

      for (let i = 0; i < count; i++) {
        if (events[i].callback !== callback) continue;
        if (scope && events[i].scope !== scope) continue;
        events[i--] = events[--count];
      }

      events.length = count;
    }

    return this;
  }

  fire(name, arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8) {
    if (!name || !this._callbacks[name]) return this;
    let callbacks;

    if (!this._callbackActive[name]) {
      this._callbackActive[name] = this._callbacks[name];
    } else {
      if (this._callbackActive[name] === this._callbacks[name]) this._callbackActive[name] = this._callbackActive[name].slice();
      callbacks = this._callbacks[name].slice();
    }

    for (let i = 0; (callbacks || this._callbackActive[name]) && i < (callbacks || this._callbackActive[name]).length; i++) {
      const evt = (callbacks || this._callbackActive[name])[i];
      evt.callback.call(evt.scope, arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8);

      if (evt.once) {
        const existingCallback = this._callbacks[name];
        const ind = existingCallback ? existingCallback.indexOf(evt) : -1;

        if (ind !== -1) {
          if (this._callbackActive[name] === existingCallback) this._callbackActive[name] = this._callbackActive[name].slice();

          this._callbacks[name].splice(ind, 1);
        }
      }
    }

    if (!callbacks) this._callbackActive[name] = null;
    return this;
  }

  once(name, callback, scope) {
    this._addCallback(name, callback, scope, true);

    return this;
  }

  hasEvent(name) {
    return this._callbacks[name] && this._callbacks[name].length !== 0 || false;
  }

}

export { EventHandler };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZXZlbnQtaGFuZGxlci5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2NvcmUvZXZlbnQtaGFuZGxlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENhbGxiYWNrIHVzZWQgYnkge0BsaW5rIEV2ZW50SGFuZGxlcn0gZnVuY3Rpb25zLiBOb3RlIHRoZSBjYWxsYmFjayBpcyBsaW1pdGVkIHRvIDggYXJndW1lbnRzLlxuICpcbiAqIEBjYWxsYmFjayBIYW5kbGVFdmVudENhbGxiYWNrXG4gKiBAcGFyYW0geyp9IFthcmcxXSAtIEZpcnN0IGFyZ3VtZW50IHRoYXQgaXMgcGFzc2VkIGZyb20gY2FsbGVyLlxuICogQHBhcmFtIHsqfSBbYXJnMl0gLSBTZWNvbmQgYXJndW1lbnQgdGhhdCBpcyBwYXNzZWQgZnJvbSBjYWxsZXIuXG4gKiBAcGFyYW0geyp9IFthcmczXSAtIFRoaXJkIGFyZ3VtZW50IHRoYXQgaXMgcGFzc2VkIGZyb20gY2FsbGVyLlxuICogQHBhcmFtIHsqfSBbYXJnNF0gLSBGb3VydGggYXJndW1lbnQgdGhhdCBpcyBwYXNzZWQgZnJvbSBjYWxsZXIuXG4gKiBAcGFyYW0geyp9IFthcmc1XSAtIEZpZnRoIGFyZ3VtZW50IHRoYXQgaXMgcGFzc2VkIGZyb20gY2FsbGVyLlxuICogQHBhcmFtIHsqfSBbYXJnNl0gLSBTaXh0aCBhcmd1bWVudCB0aGF0IGlzIHBhc3NlZCBmcm9tIGNhbGxlci5cbiAqIEBwYXJhbSB7Kn0gW2FyZzddIC0gU2V2ZW50aCBhcmd1bWVudCB0aGF0IGlzIHBhc3NlZCBmcm9tIGNhbGxlci5cbiAqIEBwYXJhbSB7Kn0gW2FyZzhdIC0gRWlnaHRoIGFyZ3VtZW50IHRoYXQgaXMgcGFzc2VkIGZyb20gY2FsbGVyLlxuICovXG5cbi8qKlxuICogQWJzdHJhY3QgYmFzZSBjbGFzcyB0aGF0IGltcGxlbWVudHMgZnVuY3Rpb25hbGl0eSBmb3IgZXZlbnQgaGFuZGxpbmcuXG4gKi9cbmNsYXNzIEV2ZW50SGFuZGxlciB7XG4gICAgLyoqXG4gICAgICogQ3JlYXRlIGEgbmV3IEV2ZW50SGFuZGxlciBpbnN0YW5jZS5cbiAgICAgKlxuICAgICAqIEBleGFtcGxlXG4gICAgICogdmFyIG9iaiA9IG5ldyBFdmVudEhhbmRsZXJTdWJjbGFzcygpO1xuICAgICAqXG4gICAgICogLy8gc3Vic2NyaWJlIHRvIGFuIGV2ZW50XG4gICAgICogb2JqLm9uKCdoZWxsbycsIGZ1bmN0aW9uIChzdHIpIHtcbiAgICAgKiAgICAgY29uc29sZS5sb2coJ2V2ZW50IGhlbGxvIGlzIGZpcmVkJywgc3RyKTtcbiAgICAgKiB9KTtcbiAgICAgKlxuICAgICAqIC8vIGZpcmUgZXZlbnRcbiAgICAgKiBvYmouZmlyZSgnaGVsbG8nLCAnd29ybGQnKTtcbiAgICAgKi9cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgLyoqXG4gICAgICAgICAqIEB0eXBlIHtvYmplY3R9XG4gICAgICAgICAqIEBwcml2YXRlXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLl9jYWxsYmFja3MgPSB7IH07XG4gICAgICAgIC8qKlxuICAgICAgICAgKiBAdHlwZSB7b2JqZWN0fVxuICAgICAgICAgKiBAcHJpdmF0ZVxuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5fY2FsbGJhY2tBY3RpdmUgPSB7IH07XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogUmVpbml0aWFsaXplIHRoZSBldmVudCBoYW5kbGVyLlxuICAgICAqXG4gICAgICogQHByaXZhdGVcbiAgICAgKi9cbiAgICBpbml0RXZlbnRIYW5kbGVyKCkge1xuICAgICAgICB0aGlzLl9jYWxsYmFja3MgPSB7IH07XG4gICAgICAgIHRoaXMuX2NhbGxiYWNrQWN0aXZlID0geyB9O1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIFJlZ2lzdGVycyBhIG5ldyBldmVudCBoYW5kbGVyLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgLSBOYW1lIG9mIHRoZSBldmVudCB0byBiaW5kIHRoZSBjYWxsYmFjayB0by5cbiAgICAgKiBAcGFyYW0ge0hhbmRsZUV2ZW50Q2FsbGJhY2t9IGNhbGxiYWNrIC0gRnVuY3Rpb24gdGhhdCBpcyBjYWxsZWQgd2hlbiBldmVudCBpcyBmaXJlZC4gTm90ZVxuICAgICAqIHRoZSBjYWxsYmFjayBpcyBsaW1pdGVkIHRvIDggYXJndW1lbnRzLlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBbc2NvcGVdIC0gT2JqZWN0IHRvIHVzZSBhcyAndGhpcycgd2hlbiB0aGUgZXZlbnQgaXMgZmlyZWQsIGRlZmF1bHRzIHRvXG4gICAgICogY3VycmVudCB0aGlzLlxuICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW29uY2U9ZmFsc2VdIC0gSWYgdHJ1ZSwgdGhlIGNhbGxiYWNrIHdpbGwgYmUgdW5ib3VuZCBhZnRlciBiZWluZyBmaXJlZCBvbmNlLlxuICAgICAqIEBwcml2YXRlXG4gICAgICovXG4gICAgX2FkZENhbGxiYWNrKG5hbWUsIGNhbGxiYWNrLCBzY29wZSwgb25jZSA9IGZhbHNlKSB7XG4gICAgICAgIGlmICghbmFtZSB8fCB0eXBlb2YgbmFtZSAhPT0gJ3N0cmluZycgfHwgIWNhbGxiYWNrKVxuICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgIGlmICghdGhpcy5fY2FsbGJhY2tzW25hbWVdKVxuICAgICAgICAgICAgdGhpcy5fY2FsbGJhY2tzW25hbWVdID0gW107XG5cbiAgICAgICAgaWYgKHRoaXMuX2NhbGxiYWNrQWN0aXZlW25hbWVdICYmIHRoaXMuX2NhbGxiYWNrQWN0aXZlW25hbWVdID09PSB0aGlzLl9jYWxsYmFja3NbbmFtZV0pXG4gICAgICAgICAgICB0aGlzLl9jYWxsYmFja0FjdGl2ZVtuYW1lXSA9IHRoaXMuX2NhbGxiYWNrQWN0aXZlW25hbWVdLnNsaWNlKCk7XG5cbiAgICAgICAgdGhpcy5fY2FsbGJhY2tzW25hbWVdLnB1c2goe1xuICAgICAgICAgICAgY2FsbGJhY2s6IGNhbGxiYWNrLFxuICAgICAgICAgICAgc2NvcGU6IHNjb3BlIHx8IHRoaXMsXG4gICAgICAgICAgICBvbmNlOiBvbmNlXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEF0dGFjaCBhbiBldmVudCBoYW5kbGVyIHRvIGFuIGV2ZW50LlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgLSBOYW1lIG9mIHRoZSBldmVudCB0byBiaW5kIHRoZSBjYWxsYmFjayB0by5cbiAgICAgKiBAcGFyYW0ge0hhbmRsZUV2ZW50Q2FsbGJhY2t9IGNhbGxiYWNrIC0gRnVuY3Rpb24gdGhhdCBpcyBjYWxsZWQgd2hlbiBldmVudCBpcyBmaXJlZC4gTm90ZVxuICAgICAqIHRoZSBjYWxsYmFjayBpcyBsaW1pdGVkIHRvIDggYXJndW1lbnRzLlxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBbc2NvcGVdIC0gT2JqZWN0IHRvIHVzZSBhcyAndGhpcycgd2hlbiB0aGUgZXZlbnQgaXMgZmlyZWQsIGRlZmF1bHRzIHRvXG4gICAgICogY3VycmVudCB0aGlzLlxuICAgICAqIEByZXR1cm5zIHtFdmVudEhhbmRsZXJ9IFNlbGYgZm9yIGNoYWluaW5nLlxuICAgICAqIEBleGFtcGxlXG4gICAgICogb2JqLm9uKCd0ZXN0JywgZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgKiAgICAgY29uc29sZS5sb2coYSArIGIpO1xuICAgICAqIH0pO1xuICAgICAqIG9iai5maXJlKCd0ZXN0JywgMSwgMik7IC8vIHByaW50cyAzIHRvIHRoZSBjb25zb2xlXG4gICAgICovXG4gICAgb24obmFtZSwgY2FsbGJhY2ssIHNjb3BlKSB7XG4gICAgICAgIHRoaXMuX2FkZENhbGxiYWNrKG5hbWUsIGNhbGxiYWNrLCBzY29wZSwgZmFsc2UpO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIERldGFjaCBhbiBldmVudCBoYW5kbGVyIGZyb20gYW4gZXZlbnQuIElmIGNhbGxiYWNrIGlzIG5vdCBwcm92aWRlZCB0aGVuIGFsbCBjYWxsYmFja3MgYXJlXG4gICAgICogdW5ib3VuZCBmcm9tIHRoZSBldmVudCwgaWYgc2NvcGUgaXMgbm90IHByb3ZpZGVkIHRoZW4gYWxsIGV2ZW50cyB3aXRoIHRoZSBjYWxsYmFjayB3aWxsIGJlXG4gICAgICogdW5ib3VuZC5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbbmFtZV0gLSBOYW1lIG9mIHRoZSBldmVudCB0byB1bmJpbmQuXG4gICAgICogQHBhcmFtIHtIYW5kbGVFdmVudENhbGxiYWNrfSBbY2FsbGJhY2tdIC0gRnVuY3Rpb24gdG8gYmUgdW5ib3VuZC5cbiAgICAgKiBAcGFyYW0ge29iamVjdH0gW3Njb3BlXSAtIFNjb3BlIHRoYXQgd2FzIHVzZWQgYXMgdGhlIHRoaXMgd2hlbiB0aGUgZXZlbnQgaXMgZmlyZWQuXG4gICAgICogQHJldHVybnMge0V2ZW50SGFuZGxlcn0gU2VsZiBmb3IgY2hhaW5pbmcuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiB2YXIgaGFuZGxlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgKiB9O1xuICAgICAqIG9iai5vbigndGVzdCcsIGhhbmRsZXIpO1xuICAgICAqXG4gICAgICogb2JqLm9mZigpOyAvLyBSZW1vdmVzIGFsbCBldmVudHNcbiAgICAgKiBvYmoub2ZmKCd0ZXN0Jyk7IC8vIFJlbW92ZXMgYWxsIGV2ZW50cyBjYWxsZWQgJ3Rlc3QnXG4gICAgICogb2JqLm9mZigndGVzdCcsIGhhbmRsZXIpOyAvLyBSZW1vdmVzIGFsbCBoYW5kbGVyIGZ1bmN0aW9ucywgY2FsbGVkICd0ZXN0J1xuICAgICAqIG9iai5vZmYoJ3Rlc3QnLCBoYW5kbGVyLCB0aGlzKTsgLy8gUmVtb3ZlcyBhbGwgaGFuZGxlciBmdW5jdGlvbnMsIGNhbGxlZCAndGVzdCcgd2l0aCBzY29wZSB0aGlzXG4gICAgICovXG4gICAgb2ZmKG5hbWUsIGNhbGxiYWNrLCBzY29wZSkge1xuICAgICAgICBpZiAobmFtZSkge1xuICAgICAgICAgICAgaWYgKHRoaXMuX2NhbGxiYWNrQWN0aXZlW25hbWVdICYmIHRoaXMuX2NhbGxiYWNrQWN0aXZlW25hbWVdID09PSB0aGlzLl9jYWxsYmFja3NbbmFtZV0pXG4gICAgICAgICAgICAgICAgdGhpcy5fY2FsbGJhY2tBY3RpdmVbbmFtZV0gPSB0aGlzLl9jYWxsYmFja0FjdGl2ZVtuYW1lXS5zbGljZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZm9yIChjb25zdCBrZXkgaW4gdGhpcy5fY2FsbGJhY2tBY3RpdmUpIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMuX2NhbGxiYWNrc1trZXldKVxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9jYWxsYmFja3Nba2V5XSAhPT0gdGhpcy5fY2FsbGJhY2tBY3RpdmVba2V5XSlcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9jYWxsYmFja0FjdGl2ZVtrZXldID0gdGhpcy5fY2FsbGJhY2tBY3RpdmVba2V5XS5zbGljZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFuYW1lKSB7XG4gICAgICAgICAgICB0aGlzLl9jYWxsYmFja3MgPSB7IH07XG4gICAgICAgIH0gZWxzZSBpZiAoIWNhbGxiYWNrKSB7XG4gICAgICAgICAgICBpZiAodGhpcy5fY2FsbGJhY2tzW25hbWVdKVxuICAgICAgICAgICAgICAgIHRoaXMuX2NhbGxiYWNrc1tuYW1lXSA9IFtdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZXZlbnRzID0gdGhpcy5fY2FsbGJhY2tzW25hbWVdO1xuICAgICAgICAgICAgaWYgKCFldmVudHMpXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG5cbiAgICAgICAgICAgIGxldCBjb3VudCA9IGV2ZW50cy5sZW5ndGg7XG5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY291bnQ7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChldmVudHNbaV0uY2FsbGJhY2sgIT09IGNhbGxiYWNrKVxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcblxuICAgICAgICAgICAgICAgIGlmIChzY29wZSAmJiBldmVudHNbaV0uc2NvcGUgIT09IHNjb3BlKVxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcblxuICAgICAgICAgICAgICAgIGV2ZW50c1tpLS1dID0gZXZlbnRzWy0tY291bnRdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZXZlbnRzLmxlbmd0aCA9IGNvdW50O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogRmlyZSBhbiBldmVudCwgYWxsIGFkZGl0aW9uYWwgYXJndW1lbnRzIGFyZSBwYXNzZWQgb24gdG8gdGhlIGV2ZW50IGxpc3RlbmVyLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUgLSBOYW1lIG9mIGV2ZW50IHRvIGZpcmUuXG4gICAgICogQHBhcmFtIHsqfSBbYXJnMV0gLSBGaXJzdCBhcmd1bWVudCB0aGF0IGlzIHBhc3NlZCB0byB0aGUgZXZlbnQgaGFuZGxlci5cbiAgICAgKiBAcGFyYW0geyp9IFthcmcyXSAtIFNlY29uZCBhcmd1bWVudCB0aGF0IGlzIHBhc3NlZCB0byB0aGUgZXZlbnQgaGFuZGxlci5cbiAgICAgKiBAcGFyYW0geyp9IFthcmczXSAtIFRoaXJkIGFyZ3VtZW50IHRoYXQgaXMgcGFzc2VkIHRvIHRoZSBldmVudCBoYW5kbGVyLlxuICAgICAqIEBwYXJhbSB7Kn0gW2FyZzRdIC0gRm91cnRoIGFyZ3VtZW50IHRoYXQgaXMgcGFzc2VkIHRvIHRoZSBldmVudCBoYW5kbGVyLlxuICAgICAqIEBwYXJhbSB7Kn0gW2FyZzVdIC0gRmlmdGggYXJndW1lbnQgdGhhdCBpcyBwYXNzZWQgdG8gdGhlIGV2ZW50IGhhbmRsZXIuXG4gICAgICogQHBhcmFtIHsqfSBbYXJnNl0gLSBTaXh0aCBhcmd1bWVudCB0aGF0IGlzIHBhc3NlZCB0byB0aGUgZXZlbnQgaGFuZGxlci5cbiAgICAgKiBAcGFyYW0geyp9IFthcmc3XSAtIFNldmVudGggYXJndW1lbnQgdGhhdCBpcyBwYXNzZWQgdG8gdGhlIGV2ZW50IGhhbmRsZXIuXG4gICAgICogQHBhcmFtIHsqfSBbYXJnOF0gLSBFaWdodGggYXJndW1lbnQgdGhhdCBpcyBwYXNzZWQgdG8gdGhlIGV2ZW50IGhhbmRsZXIuXG4gICAgICogQHJldHVybnMge0V2ZW50SGFuZGxlcn0gU2VsZiBmb3IgY2hhaW5pbmcuXG4gICAgICogQGV4YW1wbGVcbiAgICAgKiBvYmouZmlyZSgndGVzdCcsICdUaGlzIGlzIHRoZSBtZXNzYWdlJyk7XG4gICAgICovXG4gICAgZmlyZShuYW1lLCBhcmcxLCBhcmcyLCBhcmczLCBhcmc0LCBhcmc1LCBhcmc2LCBhcmc3LCBhcmc4KSB7XG4gICAgICAgIGlmICghbmFtZSB8fCAhdGhpcy5fY2FsbGJhY2tzW25hbWVdKVxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG5cbiAgICAgICAgbGV0IGNhbGxiYWNrcztcblxuICAgICAgICBpZiAoIXRoaXMuX2NhbGxiYWNrQWN0aXZlW25hbWVdKSB7XG4gICAgICAgICAgICB0aGlzLl9jYWxsYmFja0FjdGl2ZVtuYW1lXSA9IHRoaXMuX2NhbGxiYWNrc1tuYW1lXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGlmICh0aGlzLl9jYWxsYmFja0FjdGl2ZVtuYW1lXSA9PT0gdGhpcy5fY2FsbGJhY2tzW25hbWVdKVxuICAgICAgICAgICAgICAgIHRoaXMuX2NhbGxiYWNrQWN0aXZlW25hbWVdID0gdGhpcy5fY2FsbGJhY2tBY3RpdmVbbmFtZV0uc2xpY2UoKTtcblxuICAgICAgICAgICAgY2FsbGJhY2tzID0gdGhpcy5fY2FsbGJhY2tzW25hbWVdLnNsaWNlKCk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBUT0RPOiBXaGF0IGRvZXMgY2FsbGJhY2tzIGRvIGhlcmU/XG4gICAgICAgIC8vIEluIHBhcnRpY3VsYXIgdGhpcyBjb25kaXRpb24gY2hlY2sgbG9va3Mgd3Jvbmc6IChpIDwgKGNhbGxiYWNrcyB8fCB0aGlzLl9jYWxsYmFja0FjdGl2ZVtuYW1lXSkubGVuZ3RoKVxuICAgICAgICAvLyBCZWNhdXNlIGNhbGxiYWNrcyBpcyBub3QgYW4gaW50ZWdlclxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5tb2RpZmllZC1sb29wLWNvbmRpdGlvblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgKGNhbGxiYWNrcyB8fCB0aGlzLl9jYWxsYmFja0FjdGl2ZVtuYW1lXSkgJiYgKGkgPCAoY2FsbGJhY2tzIHx8IHRoaXMuX2NhbGxiYWNrQWN0aXZlW25hbWVdKS5sZW5ndGgpOyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IGV2dCA9IChjYWxsYmFja3MgfHwgdGhpcy5fY2FsbGJhY2tBY3RpdmVbbmFtZV0pW2ldO1xuICAgICAgICAgICAgZXZ0LmNhbGxiYWNrLmNhbGwoZXZ0LnNjb3BlLCBhcmcxLCBhcmcyLCBhcmczLCBhcmc0LCBhcmc1LCBhcmc2LCBhcmc3LCBhcmc4KTtcblxuICAgICAgICAgICAgaWYgKGV2dC5vbmNlKSB7XG4gICAgICAgICAgICAgICAgLy8gY2hlY2sgdGhhdCBjYWxsYmFjayBzdGlsbCBleGlzdHMgYmVjYXVzZSB1c2VyIG1heSBoYXZlIHVuc3Vic2NyaWJlZFxuICAgICAgICAgICAgICAgIC8vIGluIHRoZSBldmVudCBoYW5kbGVyXG4gICAgICAgICAgICAgICAgY29uc3QgZXhpc3RpbmdDYWxsYmFjayA9IHRoaXMuX2NhbGxiYWNrc1tuYW1lXTtcbiAgICAgICAgICAgICAgICBjb25zdCBpbmQgPSBleGlzdGluZ0NhbGxiYWNrID8gZXhpc3RpbmdDYWxsYmFjay5pbmRleE9mKGV2dCkgOiAtMTtcblxuICAgICAgICAgICAgICAgIGlmIChpbmQgIT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9jYWxsYmFja0FjdGl2ZVtuYW1lXSA9PT0gZXhpc3RpbmdDYWxsYmFjaylcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2NhbGxiYWNrQWN0aXZlW25hbWVdID0gdGhpcy5fY2FsbGJhY2tBY3RpdmVbbmFtZV0uc2xpY2UoKTtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jYWxsYmFja3NbbmFtZV0uc3BsaWNlKGluZCwgMSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKCFjYWxsYmFja3MpXG4gICAgICAgICAgICB0aGlzLl9jYWxsYmFja0FjdGl2ZVtuYW1lXSA9IG51bGw7XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQXR0YWNoIGFuIGV2ZW50IGhhbmRsZXIgdG8gYW4gZXZlbnQuIFRoaXMgaGFuZGxlciB3aWxsIGJlIHJlbW92ZWQgYWZ0ZXIgYmVpbmcgZmlyZWQgb25jZS5cbiAgICAgKlxuICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIC0gTmFtZSBvZiB0aGUgZXZlbnQgdG8gYmluZCB0aGUgY2FsbGJhY2sgdG8uXG4gICAgICogQHBhcmFtIHtIYW5kbGVFdmVudENhbGxiYWNrfSBjYWxsYmFjayAtIEZ1bmN0aW9uIHRoYXQgaXMgY2FsbGVkIHdoZW4gZXZlbnQgaXMgZmlyZWQuIE5vdGVcbiAgICAgKiB0aGUgY2FsbGJhY2sgaXMgbGltaXRlZCB0byA4IGFyZ3VtZW50cy5cbiAgICAgKiBAcGFyYW0ge29iamVjdH0gW3Njb3BlXSAtIE9iamVjdCB0byB1c2UgYXMgJ3RoaXMnIHdoZW4gdGhlIGV2ZW50IGlzIGZpcmVkLCBkZWZhdWx0cyB0b1xuICAgICAqIGN1cnJlbnQgdGhpcy5cbiAgICAgKiBAcmV0dXJucyB7RXZlbnRIYW5kbGVyfSBTZWxmIGZvciBjaGFpbmluZy5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIG9iai5vbmNlKCd0ZXN0JywgZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgKiAgICAgY29uc29sZS5sb2coYSArIGIpO1xuICAgICAqIH0pO1xuICAgICAqIG9iai5maXJlKCd0ZXN0JywgMSwgMik7IC8vIHByaW50cyAzIHRvIHRoZSBjb25zb2xlXG4gICAgICogb2JqLmZpcmUoJ3Rlc3QnLCAxLCAyKTsgLy8gbm90IGdvaW5nIHRvIGdldCBoYW5kbGVkXG4gICAgICovXG4gICAgb25jZShuYW1lLCBjYWxsYmFjaywgc2NvcGUpIHtcbiAgICAgICAgdGhpcy5fYWRkQ2FsbGJhY2sobmFtZSwgY2FsbGJhY2ssIHNjb3BlLCB0cnVlKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogVGVzdCBpZiB0aGVyZSBhcmUgYW55IGhhbmRsZXJzIGJvdW5kIHRvIGFuIGV2ZW50IG5hbWUuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZSAtIFRoZSBuYW1lIG9mIHRoZSBldmVudCB0byB0ZXN0LlxuICAgICAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHRoZSBvYmplY3QgaGFzIGhhbmRsZXJzIGJvdW5kIHRvIHRoZSBzcGVjaWZpZWQgZXZlbnQgbmFtZS5cbiAgICAgKiBAZXhhbXBsZVxuICAgICAqIG9iai5vbigndGVzdCcsIGZ1bmN0aW9uICgpIHsgfSk7IC8vIGJpbmQgYW4gZXZlbnQgdG8gJ3Rlc3QnXG4gICAgICogb2JqLmhhc0V2ZW50KCd0ZXN0Jyk7IC8vIHJldHVybnMgdHJ1ZVxuICAgICAqIG9iai5oYXNFdmVudCgnaGVsbG8nKTsgLy8gcmV0dXJucyBmYWxzZVxuICAgICAqL1xuICAgIGhhc0V2ZW50KG5hbWUpIHtcbiAgICAgICAgcmV0dXJuICh0aGlzLl9jYWxsYmFja3NbbmFtZV0gJiYgdGhpcy5fY2FsbGJhY2tzW25hbWVdLmxlbmd0aCAhPT0gMCkgfHwgZmFsc2U7XG4gICAgfVxufVxuXG5leHBvcnQgeyBFdmVudEhhbmRsZXIgfTtcbiJdLCJuYW1lcyI6WyJFdmVudEhhbmRsZXIiLCJjb25zdHJ1Y3RvciIsIl9jYWxsYmFja3MiLCJfY2FsbGJhY2tBY3RpdmUiLCJpbml0RXZlbnRIYW5kbGVyIiwiX2FkZENhbGxiYWNrIiwibmFtZSIsImNhbGxiYWNrIiwic2NvcGUiLCJvbmNlIiwic2xpY2UiLCJwdXNoIiwib24iLCJvZmYiLCJrZXkiLCJldmVudHMiLCJjb3VudCIsImxlbmd0aCIsImkiLCJmaXJlIiwiYXJnMSIsImFyZzIiLCJhcmczIiwiYXJnNCIsImFyZzUiLCJhcmc2IiwiYXJnNyIsImFyZzgiLCJjYWxsYmFja3MiLCJldnQiLCJjYWxsIiwiZXhpc3RpbmdDYWxsYmFjayIsImluZCIsImluZGV4T2YiLCJzcGxpY2UiLCJoYXNFdmVudCJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFpQkEsTUFBTUEsWUFBTixDQUFtQjtBQWVmQyxFQUFBQSxXQUFXLEdBQUc7SUFLVixJQUFLQyxDQUFBQSxVQUFMLEdBQWtCLEVBQWxCLENBQUE7SUFLQSxJQUFLQyxDQUFBQSxlQUFMLEdBQXVCLEVBQXZCLENBQUE7QUFDSCxHQUFBOztBQU9EQyxFQUFBQSxnQkFBZ0IsR0FBRztJQUNmLElBQUtGLENBQUFBLFVBQUwsR0FBa0IsRUFBbEIsQ0FBQTtJQUNBLElBQUtDLENBQUFBLGVBQUwsR0FBdUIsRUFBdkIsQ0FBQTtBQUNILEdBQUE7O0VBYURFLFlBQVksQ0FBQ0MsSUFBRCxFQUFPQyxRQUFQLEVBQWlCQyxLQUFqQixFQUF3QkMsSUFBSSxHQUFHLEtBQS9CLEVBQXNDO0lBQzlDLElBQUksQ0FBQ0gsSUFBRCxJQUFTLE9BQU9BLElBQVAsS0FBZ0IsUUFBekIsSUFBcUMsQ0FBQ0MsUUFBMUMsRUFDSSxPQUFBO0FBRUosSUFBQSxJQUFJLENBQUMsSUFBQSxDQUFLTCxVQUFMLENBQWdCSSxJQUFoQixDQUFMLEVBQ0ksSUFBQSxDQUFLSixVQUFMLENBQWdCSSxJQUFoQixDQUFBLEdBQXdCLEVBQXhCLENBQUE7SUFFSixJQUFJLElBQUEsQ0FBS0gsZUFBTCxDQUFxQkcsSUFB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
