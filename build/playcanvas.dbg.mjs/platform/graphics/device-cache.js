/**
 * @license
 * PlayCanvas Engine v1.59.0-preview revision 797466563 (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
class DeviceCache {
  constructor() {
    this._cache = new Map();
  }
  get(device, onCreate) {
    if (!this._cache.has(device)) {
      this._cache.set(device, onCreate());

      device.on('destroy', () => {
        this.remove(device);
      });
    }
    return this._cache.get(device);
  }

  remove(device) {
    var _this$_cache$get;
    (_this$_cache$get = this._cache.get(device)) == null ? void 0 : _this$_cache$get.destroy();
    this._cache.delete(device);
  }
}

export { DeviceCache };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGV2aWNlLWNhY2hlLmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvcGxhdGZvcm0vZ3JhcGhpY3MvZGV2aWNlLWNhY2hlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQSBjYWNoZSBzdG9yaW5nIHNoYXJlZCByZXNvdXJjZXMgYXNzb2NpYXRlZCB3aXRoIGEgZGV2aWNlLiBUaGUgcmVzb3VyY2VzIGFyZSByZW1vdmVkXG4gKiBmcm9tIHRoZSBjYWNoZSB3aGVuIHRoZSBkZXZpY2UgaXMgZGVzdHJveWVkLlxuICpcbiAqIEBpZ25vcmVcbiAqL1xuY2xhc3MgRGV2aWNlQ2FjaGUge1xuICAgIC8qKlxuICAgICAqIENhY2hlIHN0b3JpbmcgdGhlIHJlc291cmNlIGZvciBlYWNoIEdyYXBoaWNzRGV2aWNlXG4gICAgICpcbiAgICAgKiBAdHlwZSB7TWFwPGltcG9ydCgnLi9ncmFwaGljcy1kZXZpY2UuanMnKS5HcmFwaGljc0RldmljZSwgYW55Pn1cbiAgICAgKi9cbiAgICBfY2FjaGUgPSBuZXcgTWFwKCk7XG5cbiAgICAvKipcbiAgICAgKiBSZXR1cm5zIHRoZSByZXNvdXJjZXMgZm9yIHRoZSBzdXBwbGllZCBkZXZpY2UuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge2ltcG9ydCgnLi9ncmFwaGljcy1kZXZpY2UuanMnKS5HcmFwaGljc0RldmljZX0gZGV2aWNlIC0gVGhlIGdyYXBoaWNzIGRldmljZS5cbiAgICAgKiBAcmV0dXJucyB7YW55fSBUaGUgcmVzb3VyY2UgZm9yIHRoZSBkZXZpY2UuXG4gICAgICovXG4gICAgZ2V0KGRldmljZSwgb25DcmVhdGUpIHtcblxuICAgICAgICBpZiAoIXRoaXMuX2NhY2hlLmhhcyhkZXZpY2UpKSB7XG4gICAgICAgICAgICB0aGlzLl9jYWNoZS5zZXQoZGV2aWNlLCBvbkNyZWF0ZSgpKTtcblxuICAgICAgICAgICAgLy8gd2hlbiB0aGUgZGV2aWNlIGlzIGRlc3Ryb3llZCwgZGVzdHJveSBhbmQgcmVtb3ZlIGl0cyBlbnRyeVxuICAgICAgICAgICAgZGV2aWNlLm9uKCdkZXN0cm95JywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlKGRldmljZSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLl9jYWNoZS5nZXQoZGV2aWNlKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBEZXN0cm95cyBhbmQgcmVtb3ZlcyB0aGUgY29udGVudCBvZiB0aGUgY2FjaGUgYXNzb2NpYXRlZCB3aXRoIHRoZSBkZXZpY2VcbiAgICAgKlxuICAgICAqIEBwYXJhbSB7aW1wb3J0KCcuL2dyYXBoaWNzLWRldmljZS5qcycpLkdyYXBoaWNzRGV2aWNlfSBkZXZpY2UgLSBUaGUgZ3JhcGhpY3MgZGV2aWNlLlxuICAgICAqL1xuICAgIHJlbW92ZShkZXZpY2UpIHtcbiAgICAgICAgdGhpcy5fY2FjaGUuZ2V0KGRldmljZSk/LmRlc3Ryb3koKTtcbiAgICAgICAgdGhpcy5fY2FjaGUuZGVsZXRlKGRldmljZSk7XG4gICAgfVxufVxuXG5leHBvcnQgeyBEZXZpY2VDYWNoZSB9O1xuIl0sIm5hbWVzIjpbIkRldmljZUNhY2hlIiwiX2NhY2hlIiwiTWFwIiwiZ2V0IiwiZGV2aWNlIiwib25DcmVhdGUiLCJoYXMiLCJzZXQiLCJvbiIsInJlbW92ZSIsImRlc3Ryb3kiLCJkZWxldGUiXSwibWFwcGluZ3MiOiI7Ozs7O0FBTUEsTUFBTUEsV0FBVyxDQUFDO0FBQUEsRUFBQSxXQUFBLEdBQUE7QUFBQSxJQUFBLElBQUEsQ0FNZEMsTUFBTSxHQUFHLElBQUlDLEdBQUcsRUFBRSxDQUFBO0FBQUEsR0FBQTtBQVFsQkMsRUFBQUEsR0FBRyxDQUFDQyxNQUFNLEVBQUVDLFFBQVEsRUFBRTtJQUVsQixJQUFJLENBQUMsSUFBSSxDQUFDSixNQUFNLENBQUNLLEdBQUcsQ0FBQ0YsTUFBTSxDQUFDLEVBQUU7TUFDMUIsSUFBSSxDQUFDSCxNQUFNLENBQUNNLEdBQUcsQ0FBQ0gsTUFBTSxFQUFFQyxRQUFRLEVBQUUsQ0FBQyxDQUFBOztBQUduQ0QsTUFBQUEsTUFBTSxDQUFDSSxFQUFFLENBQUMsU0FBUyxFQUFFLE1BQU07QUFDdkIsUUFBQSxJQUFJLENBQUNDLE1BQU0sQ0FBQ0wsTUFBTSxDQUFDLENBQUE7QUFDdkIsT0FBQyxDQUFDLENBQUE7QUFDTixLQUFBO0FBRUEsSUFBQSxPQUFPLElBQUksQ0FBQ0gsTUFBTSxDQUFDRSxHQUFHLENBQUNDLE1BQU0sQ0FBQyxDQUFBO0FBQ2xDLEdBQUE7O0VBT0FLLE1BQU0sQ0FBQ0wsTUFBTSxFQUFFO0FBQUEsSUFBQSxJQUFBLGdCQUFBLENBQUE7SUFDWCxDQUFJLGdCQUFBLEdBQUEsSUFBQSxDQUFDSCxNQUFNLENBQUNFLEdBQUcsQ0FBQ0MsTUFBTSxDQUFDLEtBQUEsSUFBQSxHQUFBLEtBQUEsQ0FBQSxHQUF2QixnQkFBeUJNLENBQUFBLE9BQU8sRUFBRSxDQUFBO0FBQ2xDLElBQUEsSUFBSSxDQUFDVCxNQUFNLENBQUNVLE1BQU0sQ0FBQ1AsTUFBTSxDQUFDLENBQUE7QUFDOUIsR0FBQTtBQUNKOzs7OyJ9
