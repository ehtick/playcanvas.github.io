/**
 * @license
 * PlayCanvas Engine v1.59.0-preview revision 797466563 (DEBUG PROFILER)
 * Copyright 2011-2022 PlayCanvas Ltd. All rights reserved.
 */
import { Debug, DebugHelper } from '../../../core/debug.js';
import { DEVICETYPE_WEBGPU, PIXELFORMAT_RGBA32F, PIXELFORMAT_RGBA8, PIXELFORMAT_BGRA8 } from '../constants.js';
import { GraphicsDevice } from '../graphics-device.js';
import { RenderTarget } from '../render-target.js';
import { WebgpuBindGroup } from './webgpu-bind-group.js';
import { WebgpuBindGroupFormat } from './webgpu-bind-group-format.js';
import { WebgpuIndexBuffer } from './webgpu-index-buffer.js';
import { WebgpuRenderPipeline } from './webgpu-render-pipeline.js';
import { WebgpuRenderState } from './webgpu-render-state.js';
import { WebgpuRenderTarget } from './webgpu-render-target.js';
import { WebgpuShader } from './webgpu-shader.js';
import { WebgpuTexture } from './webgpu-texture.js';
import { WebgpuUniformBuffer } from './webgpu-uniform-buffer.js';
import { WebgpuVertexBuffer } from './webgpu-vertex-buffer.js';
import { WebgpuClearRenderer } from './webgpu-clear-renderer.js';
import { DebugGraphics } from '../debug-graphics.js';

class WebgpuGraphicsDevice extends GraphicsDevice {

  constructor(canvas, options = {}) {
    super(canvas);
    this.frameBuffer = void 0;
    this.renderState = new WebgpuRenderState();
    this.renderPipeline = new WebgpuRenderPipeline(this);
    this.clearRenderer = new WebgpuClearRenderer();
    this.pipeline = void 0;
    this.bindGroupFormats = [];
    this.commandEncoder = void 0;
    this.deviceType = DEVICETYPE_WEBGPU;
    this.initDeviceCaps();
  }
  initDeviceCaps() {
    this.precision = 'highp';
    this.maxPrecision = 'highp';
    this.maxSamples = 4;
    this.maxTextures = 16;
    this.maxTextureSize = 4096;
    this.maxCubeMapSize = 4096;
    this.maxVolumeSize = 2048;
    this.maxPixelRatio = 1;
    this.supportsInstancing = true;
    this.supportsUniformBuffers = true;
    this.supportsBoneTextures = true;
    this.supportsMorphTargetTexturesCore = true;
    this.supportsAreaLights = true;
    this.extUintElement = true;
    this.extTextureFloat = true;
    this.textureFloatRenderable = true;
    this.extTextureHalfFloat = true;
    this.textureHalfFloatRenderable = true;
    this.textureHalfFloatUpdatable = true;
    this.boneLimit = 1024;
    this.supportsImageBitmap = true;
    this.extStandardDerivatives = true;
    this.areaLightLutFormat = PIXELFORMAT_RGBA32F;
    this.supportsTextureFetch = true;
  }
  async initWebGpu(glslangUrl) {
    if (!window.navigator.gpu) {
      throw new Error('Unable to retrieve GPU. Ensure you are using a browser that supports WebGPU rendering.');
    }

    Debug.log("WebgpuGraphicsDevice initialization ..");
    const loadScript = url => {
      return new Promise(function (resolve, reject) {
        const script = document.createElement('script');
        script.src = url;
        script.async = false;
        script.onload = function () {
          resolve(url);
        };
        script.onerror = function () {
          reject(new Error(`Failed to download script ${url}`));
        };
        document.body.appendChild(script);
      });
    };

    await loadScript(glslangUrl);
    this.glslang = await glslang();

    this.gpuAdapter = await window.navigator.gpu.requestAdapter();

    this.wgpu = await this.gpuAdapter.requestDevice();

    this.setResolution(window.innerWidth, window.innerHeight);
    this.gpuContext = this.canvas.getContext('webgpu');

    const preferredCanvasFormat = navigator.gpu.getPreferredCanvasFormat();
    this.framebufferFormat = preferredCanvasFormat === 'rgba8unorm' ? PIXELFORMAT_RGBA8 : PIXELFORMAT_BGRA8;

    this.canvasConfig = {
      device: this.wgpu,
      colorSpace: 'srgb',
      alphaMode: 'opaque',

      format: preferredCanvasFormat,
      usage: GPUTextureUsage.RENDER_ATTACHMENT | GPUTextureUsage.COPY_SRC,
      viewFormats: []
    };
    this.gpuContext.configure(this.canvasConfig);
    this.createFramebuffer();
    return this;
  }
  createFramebuffer() {
    this.frameBuffer = new RenderTarget({
      name: 'WebgpuFramebuffer',
      graphicsDevice: this,
      depth: true,
      samples: 4
    });
  }
  createUniformBufferImpl(uniformBuffer) {
    return new WebgpuUniformBuffer(uniformBuffer);
  }
  createVertexBufferImpl(vertexBuffer, format) {
    return new WebgpuVertexBuffer(vertexBuffer, format);
  }
  createIndexBufferImpl(indexBuffer) {
    return new WebgpuIndexBuffer(indexBuffer);
  }
  createShaderImpl(shader) {
    return new WebgpuShader(shader);
  }
  createTextureImpl(texture) {
    return new WebgpuTexture(texture);
  }
  createRenderTargetImpl(renderTarget) {
    return new WebgpuRenderTarget(renderTarget);
  }
  createBindGroupFormatImpl(bindGroupFormat) {
    return new WebgpuBindGroupFormat(bindGroupFormat);
  }
  createBindGroupImpl(bindGroup) {
    return new WebgpuBindGroup();
  }

  setBindGroup(index, bindGroup) {
    if (this.passEncoder) {
      this.passEncoder.setBindGroup(index, bindGroup.impl.bindGroup);

      this.bindGroupFormats[index] = bindGroup.format.impl;
    }
  }
  submitVertexBuffer(vertexBuffer, slot) {
    const format = vertexBuffer.format;
    const elementCount = format.elements.length;
    const vbBuffer = vertexBuffer.impl.buffer;
    for (let i = 0; i < elementCount; i++) {
      const element = format.elements[i];
      this.passEncoder.setVertexBuffer(slot + i, vbBuffer, element.offset);
    }
    return elementCount;
  }
  draw(primitive, numInstances = 1, keepBuffers) {
    if (this.shader.ready) {
      const passEncoder = this.passEncoder;

      const vb0 = this.vertexBuffers[0];
      const vbSlot = this.submitVertexBuffer(vb0, 0);
      const vb1 = this.vertexBuffers[1];
      if (vb1) {
        this.submitVertexBuffer(vb1, vbSlot);
      }
      this.vertexBuffers.length = 0;

      const pipeline = this.renderPipeline.get(primitive, vb0.format, vb1 == null ? void 0 : vb1.format, this.shader, this.renderTarget, this.bindGroupFormats, this.renderState);
      Debug.assert(pipeline);
      if (this.pipeline !== pipeline) {
        this.pipeline = pipeline;
        passEncoder.setPipeline(pipeline);
      }

      const ib = this.indexBuffer;
      if (ib) {
        passEncoder.setIndexBuffer(ib.impl.buffer, ib.impl.format);
        passEncoder.drawIndexed(ib.numIndices, numInstances, 0, 0, 0);
      } else {
        passEncoder.draw(vb0.numVertices, numInstances, 0, 0);
      }
    }
  }
  setShader(shader) {
    this.shader = shader;

    this._shaderSwitchesPerFrame++;
    return true;
  }
  setBlending(blending) {
    this.renderState.setBlending(blending);
  }
  setBlendFunction(blendSrc, blendDst) {
    this.renderState.setBlendFunction(blendSrc, blendDst);
  }
  setBlendEquation(blendEquation) {
    this.renderState.setBlendEquation(blendEquation);
  }
  setDepthFunc(func) {}
  setDepthTest(depthTest) {}
  setCullMode(cullMode) {}
  setAlphaToCoverage(state) {}
  setColorWrite(writeRed, writeGreen, writeBlue, writeAlpha) {}
  setDepthWrite(writeDepth) {}
  initializeContextCaches() {
    super.initializeContextCaches();
  }

  startPass(renderPass) {
    const rt = renderPass.renderTarget || this.frameBuffer;
    Debug.assert(rt);
    this.renderTarget = rt;
    const wrt = rt.impl;
    this.initRenderTarget(rt);

    if (rt === this.frameBuffer) {
      const outColorBuffer = this.gpuContext.getCurrentTexture();
      DebugHelper.setLabel(outColorBuffer, rt.name);
      wrt.assignColorTexture(outColorBuffer);
    }

    wrt.setupForRenderPass(renderPass);

    this.commandEncoder = this.wgpu.createCommandEncoder();
    DebugHelper.setLabel(this.commandEncoder, renderPass.name);

    this.pipeline = null;

    this.passEncoder = this.commandEncoder.beginRenderPass(wrt.renderPassDescriptor);
    DebugHelper.setLabel(this.passEncoder, renderPass.name);
  }

  endPass(renderPass) {
    this.passEncoder.end();
    this.passEncoder = null;
    this.wgpu.queue.submit([this.commandEncoder.finish()]);
    this.commandEncoder = null;
  }
  clear(options) {
    if (options.flags) {
      this.clearRenderer.clear(this, this.renderTarget, options);
    }
  }
  get width() {
    return this._width;
  }
  get height() {
    return this._height;
  }
  setDepthBias(on) {}
  setStencilTest(enable) {}
  setViewport(x, y, w, h) {
    if (this.passEncoder) {
      this.passEncoder.setViewport(x, this.renderTarget.height - y - h, w, h, 0, 1);
    }
  }
  setScissor(x, y, w, h) {
    if (this.passEncoder) {
      this.passEncoder.setScissorRect(x, this.renderTarget.height - y - h, w, h);
    }
  }

  copyRenderTarget(source, dest, color, depth) {
    var _this$commandEncoder;
    const copySize = {
      width: source ? source.width : dest.width,
      height: source ? source.height : dest.height,
      depthOrArrayLayers: 1
    };
    DebugGraphics.pushGpuMarker(this, 'COPY-RT');

    const commandEncoder = (_this$commandEncoder = this.commandEncoder) != null ? _this$commandEncoder : this.wgpu.createCommandEncoder();
    if (color) {
      const copySrc = {
        texture: source ? source.colorBuffer.impl.gpuTexture : this.renderTarget.impl.assignedColorTexture,
        mipLevel: 0
      };

      const copyDst = {
        texture: dest ? dest.colorBuffer.impl.gpuTexture : this.renderTarget.impl.assignedColorTexture,
        mipLevel: 0
      };
      Debug.assert(copySrc.texture !== null && copyDst.texture !== null);
      commandEncoder.copyTextureToTexture(copySrc, copyDst, copySize);
    }
    if (depth) {
      const sourceRT = source ? source : this.renderTarget;

      Debug.assert(source.samples <= 1, `copyRenderTarget does not currently support copy of depth from multisampled texture`, sourceRT);

      const copySrc = {
        texture: sourceRT.impl.depthTexture,
        mipLevel: 0
      };

      const copyDst = {
        texture: dest ? dest.depthBuffer.impl.gpuTexture : this.renderTarget.impl.depthTexture,
        mipLevel: 0
      };
      Debug.assert(copySrc.texture !== null && copyDst.texture !== null);
      commandEncoder.copyTextureToTexture(copySrc, copyDst, copySize);
    }

    if (!this.commandEncoder) {
      this.wgpu.queue.submit([commandEncoder.finish()]);
    }
    DebugGraphics.popGpuMarker(this);
    return true;
  }
  pushMarker(name) {
    var _this$passEncoder;
    (_this$passEncoder = this.passEncoder) == null ? void 0 : _this$passEncoder.pushDebugGroup(name);
  }
  popMarker() {
    var _this$passEncoder2;
    (_this$passEncoder2 = this.passEncoder) == null ? void 0 : _this$passEncoder2.popDebugGroup();
  }
}

export { WebgpuGraphicsDevice };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2ViZ3B1LWdyYXBoaWNzLWRldmljZS5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc3JjL3BsYXRmb3JtL2dyYXBoaWNzL3dlYmdwdS93ZWJncHUtZ3JhcGhpY3MtZGV2aWNlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERlYnVnLCBEZWJ1Z0hlbHBlciB9IGZyb20gJy4uLy4uLy4uL2NvcmUvZGVidWcuanMnO1xuXG5pbXBvcnQge1xuICAgIERFVklDRVRZUEVfV0VCR1BVLCBQSVhFTEZPUk1BVF9SR0JBMzJGLCBQSVhFTEZPUk1BVF9SR0JBOCwgUElYRUxGT1JNQVRfQkdSQThcbn0gZnJvbSAnLi4vY29uc3RhbnRzLmpzJztcbmltcG9ydCB7IEdyYXBoaWNzRGV2aWNlIH0gZnJvbSAnLi4vZ3JhcGhpY3MtZGV2aWNlLmpzJztcbmltcG9ydCB7IFJlbmRlclRhcmdldCB9IGZyb20gJy4uL3JlbmRlci10YXJnZXQuanMnO1xuXG5pbXBvcnQgeyBXZWJncHVCaW5kR3JvdXAgfSBmcm9tICcuL3dlYmdwdS1iaW5kLWdyb3VwLmpzJztcbmltcG9ydCB7IFdlYmdwdUJpbmRHcm91cEZvcm1hdCB9IGZyb20gJy4vd2ViZ3B1LWJpbmQtZ3JvdXAtZm9ybWF0LmpzJztcbmltcG9ydCB7IFdlYmdwdUluZGV4QnVmZmVyIH0gZnJvbSAnLi93ZWJncHUtaW5kZXgtYnVmZmVyLmpzJztcbmltcG9ydCB7IFdlYmdwdVJlbmRlclBpcGVsaW5lIH0gZnJvbSAnLi93ZWJncHUtcmVuZGVyLXBpcGVsaW5lLmpzJztcbmltcG9ydCB7IFdlYmdwdVJlbmRlclN0YXRlIH0gZnJvbSAnLi93ZWJncHUtcmVuZGVyLXN0YXRlLmpzJztcbmltcG9ydCB7IFdlYmdwdVJlbmRlclRhcmdldCB9IGZyb20gJy4vd2ViZ3B1LXJlbmRlci10YXJnZXQuanMnO1xuaW1wb3J0IHsgV2ViZ3B1U2hhZGVyIH0gZnJvbSAnLi93ZWJncHUtc2hhZGVyLmpzJztcbmltcG9ydCB7IFdlYmdwdVRleHR1cmUgfSBmcm9tICcuL3dlYmdwdS10ZXh0dXJlLmpzJztcbmltcG9ydCB7IFdlYmdwdVVuaWZvcm1CdWZmZXIgfSBmcm9tICcuL3dlYmdwdS11bmlmb3JtLWJ1ZmZlci5qcyc7XG5pbXBvcnQgeyBXZWJncHVWZXJ0ZXhCdWZmZXIgfSBmcm9tICcuL3dlYmdwdS12ZXJ0ZXgtYnVmZmVyLmpzJztcbmltcG9ydCB7IFdlYmdwdUNsZWFyUmVuZGVyZXIgfSBmcm9tICcuL3dlYmdwdS1jbGVhci1yZW5kZXJlci5qcyc7XG5pbXBvcnQgeyBEZWJ1Z0dyYXBoaWNzIH0gZnJvbSAnLi4vZGVidWctZ3JhcGhpY3MuanMnO1xuXG5jbGFzcyBXZWJncHVHcmFwaGljc0RldmljZSBleHRlbmRzIEdyYXBoaWNzRGV2aWNlIHtcbiAgICAvKipcbiAgICAgKiBUaGUgcmVuZGVyIHRhcmdldCByZXByZXNlbnRpbmcgdGhlIG1haW4gZnJhbWVidWZmZXIuXG4gICAgICpcbiAgICAgKiBAdHlwZSB7UmVuZGVyVGFyZ2V0fVxuICAgICAqL1xuICAgIGZyYW1lQnVmZmVyO1xuXG4gICAgLyoqXG4gICAgICogSW50ZXJuYWwgcmVwcmVzZW50YXRpb24gb2YgdGhlIGN1cnJlbnQgcmVuZGVyIHN0YXRlLCBhcyByZXF1ZXN0ZWQgYnkgdGhlIHJlbmRlcmVyLlxuICAgICAqIEluIHRoZSBmdXR1cmUgdGhpcyBjYW4gYmUgY29tcGxldGVseSByZXBsYWNlZCBieSBhIG1vcmUgb3B0aW1hbCBzb2x1dGlvbiwgd2hlcmVcbiAgICAgKiByZW5kZXIgc3RhdGVzIGFyZSBidW5kbGVkIHRvZ2V0aGVyIChEWDExIHN0eWxlKSBhbmQgc2V0IHVzaW5nIGEgc2luZ2xlIGNhbGwuXG4gICAgICovXG4gICAgcmVuZGVyU3RhdGUgPSBuZXcgV2ViZ3B1UmVuZGVyU3RhdGUoKTtcblxuICAgIC8qKlxuICAgICAqIE9iamVjdCByZXNwb25zaWJsZSBmb3IgY2FjaGluZyBhbmQgY3JlYXRpb24gb2YgcmVuZGVyIHBpcGVsaW5lcy5cbiAgICAgKi9cbiAgICByZW5kZXJQaXBlbGluZSA9IG5ldyBXZWJncHVSZW5kZXJQaXBlbGluZSh0aGlzKTtcblxuICAgIC8qKlxuICAgICAqIE9iamVjdCByZXNwb25zaWJsZSBmb3IgY2xlYXJpbmcgdGhlIHJlbmRlcmluZyBzdXJmYWNlIGJ5IHJlbmRlcmluZyBhIHF1YWQuXG4gICAgICovXG4gICAgY2xlYXJSZW5kZXJlciA9IG5ldyBXZWJncHVDbGVhclJlbmRlcmVyKCk7XG5cbiAgICAvKipcbiAgICAgKiBSZW5kZXIgcGlwZWxpbmUgY3VycmVudGx5IHNldCBvbiB0aGUgZGV2aWNlLlxuICAgICAqXG4gICAgICogLy8gdHlwZSB7R1BVUmVuZGVyUGlwZWxpbmV9XG4gICAgICovXG4gICAgcGlwZWxpbmU7XG5cbiAgICAvKipcbiAgICAgKiBBbiBhcnJheSBvZiBiaW5kIGdyb3VwIGZvcm1hdHMsIGJhc2VkIG9uIGN1cnJlbnRseSBhc3NpZ25lZCBiaW5kIGdyb3Vwc1xuICAgICAqXG4gICAgICogQHR5cGUge1dlYmdwdUJpbmRHcm91cEZvcm1hdFtdfVxuICAgICAqL1xuICAgIGJpbmRHcm91cEZvcm1hdHMgPSBbXTtcblxuICAgIC8qKlxuICAgICAqIEN1cnJlbnQgY29tbWFuZCBidWZmZXIgZW5jb2Rlci5cbiAgICAgKlxuICAgICAqIHR5cGUge0dQVUNvbW1hbmRFbmNvZGVyfVxuICAgICAqL1xuICAgIGNvbW1hbmRFbmNvZGVyO1xuXG4gICAgY29uc3RydWN0b3IoY2FudmFzLCBvcHRpb25zID0ge30pIHtcbiAgICAgICAgc3VwZXIoY2FudmFzKTtcbiAgICAgICAgdGhpcy5kZXZpY2VUeXBlID0gREVWSUNFVFlQRV9XRUJHUFU7XG5cbiAgICAgICAgdGhpcy5pbml0RGV2aWNlQ2FwcygpO1xuICAgIH1cblxuICAgIGluaXREZXZpY2VDYXBzKCkge1xuICAgICAgICB0aGlzLnByZWNpc2lvbiA9ICdoaWdocCc7XG4gICAgICAgIHRoaXMubWF4UHJlY2lzaW9uID0gJ2hpZ2hwJztcbiAgICAgICAgdGhpcy5tYXhTYW1wbGVzID0gNDtcbiAgICAgICAgdGhpcy5tYXhUZXh0dXJlcyA9IDE2O1xuICAgICAgICB0aGlzLm1heFRleHR1cmVTaXplID0gNDA5NjtcbiAgICAgICAgdGhpcy5tYXhDdWJlTWFwU2l6ZSA9IDQwOTY7XG4gICAgICAgIHRoaXMubWF4Vm9sdW1lU2l6ZSA9IDIwNDg7XG4gICAgICAgIHRoaXMubWF4UGl4ZWxSYXRpbyA9IDE7XG4gICAgICAgIHRoaXMuc3VwcG9ydHNJbnN0YW5jaW5nID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zdXBwb3J0c1VuaWZvcm1CdWZmZXJzID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5zdXBwb3J0c0JvbmVUZXh0dXJlcyA9IHRydWU7XG4gICAgICAgIHRoaXMuc3VwcG9ydHNNb3JwaFRhcmdldFRleHR1cmVzQ29yZSA9IHRydWU7XG4gICAgICAgIHRoaXMuc3VwcG9ydHNBcmVhTGlnaHRzID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5leHRVaW50RWxlbWVudCA9IHRydWU7XG4gICAgICAgIHRoaXMuZXh0VGV4dHVyZUZsb2F0ID0gdHJ1ZTtcbiAgICAgICAgdGhpcy50ZXh0dXJlRmxvYXRSZW5kZXJhYmxlID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5leHRUZXh0dXJlSGFsZkZsb2F0ID0gdHJ1ZTtcbiAgICAgICAgdGhpcy50ZXh0dXJlSGFsZkZsb2F0UmVuZGVyYWJsZSA9IHRydWU7XG4gICAgICAgIHRoaXMudGV4dHVyZUhhbGZGbG9hdFVwZGF0YWJsZSA9IHRydWU7XG4gICAgICAgIHRoaXMuYm9uZUxpbWl0ID0gMTAyNDtcbiAgICAgICAgdGhpcy5zdXBwb3J0c0ltYWdlQml0bWFwID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5leHRTdGFuZGFyZERlcml2YXRpdmVzID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5hcmVhTGlnaHRMdXRGb3JtYXQgPSBQSVhFTEZPUk1BVF9SR0JBMzJGO1xuICAgICAgICB0aGlzLnN1cHBvcnRzVGV4dHVyZUZldGNoID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBhc3luYyBpbml0V2ViR3B1KGdsc2xhbmdVcmwpIHtcblxuICAgICAgICBpZiAoIXdpbmRvdy5uYXZpZ2F0b3IuZ3B1KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1VuYWJsZSB0byByZXRyaWV2ZSBHUFUuIEVuc3VyZSB5b3UgYXJlIHVzaW5nIGEgYnJvd3NlciB0aGF0IHN1cHBvcnRzIFdlYkdQVSByZW5kZXJpbmcuJyk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyB0ZW1wb3JhcnkgbWVzc2FnZSB0byBjb25maXJtIFdlYmdwdSBpcyBiZWluZyB1c2VkXG4gICAgICAgIERlYnVnLmxvZyhcIldlYmdwdUdyYXBoaWNzRGV2aWNlIGluaXRpYWxpemF0aW9uIC4uXCIpO1xuXG4gICAgICAgIGNvbnN0IGxvYWRTY3JpcHQgPSAodXJsKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuICAgICAgICAgICAgICAgIHNjcmlwdC5zcmMgPSB1cmw7XG4gICAgICAgICAgICAgICAgc2NyaXB0LmFzeW5jID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgc2NyaXB0Lm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZSh1cmwpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgc2NyaXB0Lm9uZXJyb3IgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoYEZhaWxlZCB0byBkb3dubG9hZCBzY3JpcHQgJHt1cmx9YCkpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChzY3JpcHQpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gVE9ETzogYWRkIGxvYWRTY3JpcHQgYW5kIHJlcXVlc3RBZGFwdGVyIHRvIHByb21pc2UgbGlzdCBhbmQgd2FpdCBmb3IgYm90aC5cbiAgICAgICAgYXdhaXQgbG9hZFNjcmlwdChnbHNsYW5nVXJsKTtcblxuICAgICAgICB0aGlzLmdsc2xhbmcgPSBhd2FpdCBnbHNsYW5nKCk7XG5cbiAgICAgICAgLy8gdHlwZSB7R1BVQWRhcHRlcn1cbiAgICAgICAgdGhpcy5ncHVBZGFwdGVyID0gYXdhaXQgd2luZG93Lm5hdmlnYXRvci5ncHUucmVxdWVzdEFkYXB0ZXIoKTtcblxuICAgICAgICAvLyB0eXBlIHtHUFVEZXZpY2V9XG4gICAgICAgIHRoaXMud2dwdSA9IGF3YWl0IHRoaXMuZ3B1QWRhcHRlci5yZXF1ZXN0RGV2aWNlKCk7XG5cbiAgICAgICAgLy8gaW5pdGlhbGx5IGZpbGwgdGhlIHdpbmRvdy4gVGhpcyBuZWVkcyBpbXByb3ZlbWVudC5cbiAgICAgICAgdGhpcy5zZXRSZXNvbHV0aW9uKHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQpO1xuXG4gICAgICAgIHRoaXMuZ3B1Q29udGV4dCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoJ3dlYmdwdScpO1xuXG4gICAgICAgIC8vIHBpeGVsIGZvcm1hdCBvZiB0aGUgZnJhbWVidWZmZXIgaXMgdGhlIG1vc3QgZWZmaWNpZW50IG9uZSBvbiB0aGUgc3lzdGVtXG4gICAgICAgIGNvbnN0IHByZWZlcnJlZENhbnZhc0Zvcm1hdCA9IG5hdmlnYXRvci5ncHUuZ2V0UHJlZmVycmVkQ2FudmFzRm9ybWF0KCk7XG4gICAgICAgIHRoaXMuZnJhbWVidWZmZXJGb3JtYXQgPSBwcmVmZXJyZWRDYW52YXNGb3JtYXQgPT09ICdyZ2JhOHVub3JtJyA/IFBJWEVMRk9STUFUX1JHQkE4IDogUElYRUxGT1JNQVRfQkdSQTg7XG5cbiAgICAgICAgLy8gdGhpcyBpcyBjb25maWd1cmF0aW9uIG9mIHRoZSBtYWluIGNvbG9yZnJhbWVidWZmZXIgd2Ugb2J0YWluIHVzaW5nIGdldEN1cnJlbnRUZXh0dXJlXG4gICAgICAgIC8vIHR5cGUge0dQVUNhbnZhc0NvbmZpZ3VyYXRpb259XG4gICAgICAgIHRoaXMuY2FudmFzQ29uZmlnID0ge1xuICAgICAgICAgICAgZGV2aWNlOiB0aGlzLndncHUsXG4gICAgICAgICAgICBjb2xvclNwYWNlOiAnc3JnYicsXG4gICAgICAgICAgICBhbHBoYU1vZGU6ICdvcGFxdWUnLCAgLy8gY291bGQgYWxzbyBiZSAncHJlbXVsdGlwbGllZCdcblxuICAgICAgICAgICAgLy8gdXNlIHByZWZlcmVkIGZvcm1hdCBmb3Igb3B0aW1hbCBwZXJmb3JtYW5jZSBvbiBtb2JpbGVcbiAgICAgICAgICAgIGZvcm1hdDogcHJlZmVycmVkQ2FudmFzRm9ybWF0LFxuXG4gICAgICAgICAgICAvLyBSRU5ERVJfQVRUQUNITUVOVCBpcyByZXF1aXJlZCwgQ09QWV9TUkMgYWxsb3dzIHNjZW5lIGdyYWIgdG8gY29weSBvdXQgZnJvbSBpdFxuICAgICAgICAgICAgdXNhZ2U6IEdQVVRleHR1cmVVc2FnZS5SRU5ERVJfQVRUQUNITUVOVCB8IEdQVVRleHR1cmVVc2FnZS5DT1BZX1NSQyxcblxuICAgICAgICAgICAgLy8gZm9ybWF0cyB0aGF0IHZpZXdzIGNyZWF0ZWQgZnJvbSB0ZXh0dXJlcyByZXR1cm5lZCBieSBnZXRDdXJyZW50VGV4dHVyZSBtYXkgdXNlXG4gICAgICAgICAgICB2aWV3Rm9ybWF0czogW11cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5ncHVDb250ZXh0LmNvbmZpZ3VyZSh0aGlzLmNhbnZhc0NvbmZpZyk7XG5cbiAgICAgICAgdGhpcy5jcmVhdGVGcmFtZWJ1ZmZlcigpO1xuXG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGNyZWF0ZUZyYW1lYnVmZmVyKCkge1xuICAgICAgICB0aGlzLmZyYW1lQnVmZmVyID0gbmV3IFJlbmRlclRhcmdldCh7XG4gICAgICAgICAgICBuYW1lOiAnV2ViZ3B1RnJhbWVidWZmZXInLFxuICAgICAgICAgICAgZ3JhcGhpY3NEZXZpY2U6IHRoaXMsXG4gICAgICAgICAgICBkZXB0aDogdHJ1ZSxcbiAgICAgICAgICAgIHNhbXBsZXM6IDRcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgY3JlYXRlVW5pZm9ybUJ1ZmZlckltcGwodW5pZm9ybUJ1ZmZlcikge1xuICAgICAgICByZXR1cm4gbmV3IFdlYmdwdVVuaWZvcm1CdWZmZXIodW5pZm9ybUJ1ZmZlcik7XG4gICAgfVxuXG4gICAgY3JlYXRlVmVydGV4QnVmZmVySW1wbCh2ZXJ0ZXhCdWZmZXIsIGZvcm1hdCkge1xuICAgICAgICByZXR1cm4gbmV3IFdlYmdwdVZlcnRleEJ1ZmZlcih2ZXJ0ZXhCdWZmZXIsIGZvcm1hdCk7XG4gICAgfVxuXG4gICAgY3JlYXRlSW5kZXhCdWZmZXJJbXBsKGluZGV4QnVmZmVyKSB7XG4gICAgICAgIHJldHVybiBuZXcgV2ViZ3B1SW5kZXhCdWZmZXIoaW5kZXhCdWZmZXIpO1xuICAgIH1cblxuICAgIGNyZWF0ZVNoYWRlckltcGwoc2hhZGVyKSB7XG4gICAgICAgIHJldHVybiBuZXcgV2ViZ3B1U2hhZGVyKHNoYWRlcik7XG4gICAgfVxuXG4gICAgY3JlYXRlVGV4dHVyZUltcGwodGV4dHVyZSkge1xuICAgICAgICByZXR1cm4gbmV3IFdlYmdwdVRleHR1cmUodGV4dHVyZSk7XG4gICAgfVxuXG4gICAgY3JlYXRlUmVuZGVyVGFyZ2V0SW1wbChyZW5kZXJUYXJnZXQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBXZWJncHVSZW5kZXJUYXJnZXQocmVuZGVyVGFyZ2V0KTtcbiAgICB9XG5cbiAgICBjcmVhdGVCaW5kR3JvdXBGb3JtYXRJbXBsKGJpbmRHcm91cEZvcm1hdCkge1xuICAgICAgICByZXR1cm4gbmV3IFdlYmdwdUJpbmRHcm91cEZvcm1hdChiaW5kR3JvdXBGb3JtYXQpO1xuICAgIH1cblxuICAgIGNyZWF0ZUJpbmRHcm91cEltcGwoYmluZEdyb3VwKSB7XG4gICAgICAgIHJldHVybiBuZXcgV2ViZ3B1QmluZEdyb3VwKCk7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtudW1iZXJ9IGluZGV4IC0gSW5kZXggb2YgdGhlIGJpbmQgZ3JvdXAgc2xvdFxuICAgICAqIEBwYXJhbSB7aW1wb3J0KCcuLi9iaW5kLWdyb3VwLmpzJykuQmluZEdyb3VwfSBiaW5kR3JvdXAgLSBCaW5kIGdyb3VwIHRvIGF0dGFjaFxuICAgICAqL1xuICAgIHNldEJpbmRHcm91cChpbmRleCwgYmluZEdyb3VwKSB7XG5cbiAgICAgICAgLy8gVE9ETzogdGhpcyBjb25kaXRpb24gc2hvdWxkIGJlIHJlbW92ZWQsIGl0J3MgaGVyZSB0byBoYW5kbGUgZmFrZSBncmFiIHBhc3MsIHdoaWNoIHNob3VsZCBiZSByZWZhY3RvcmVkIGluc3RlYWRcbiAgICAgICAgaWYgKHRoaXMucGFzc0VuY29kZXIpIHtcblxuICAgICAgICAgICAgLy8gc2V0IGl0IG9uIHRoZSBkZXZpY2VcbiAgICAgICAgICAgIHRoaXMucGFzc0VuY29kZXIuc2V0QmluZEdyb3VwKGluZGV4LCBiaW5kR3JvdXAuaW1wbC5iaW5kR3JvdXApO1xuXG4gICAgICAgICAgICAvLyBzdG9yZSB0aGUgYWN0aXZlIGZvcm1hdHMsIHVzZWQgYnkgdGhlIHBpcGVsaW5lIGNyZWF0aW9uXG4gICAgICAgICAgICB0aGlzLmJpbmRHcm91cEZvcm1hdHNbaW5kZXhdID0gYmluZEdyb3VwLmZvcm1hdC5pbXBsO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgc3VibWl0VmVydGV4QnVmZmVyKHZlcnRleEJ1ZmZlciwgc2xvdCkge1xuXG4gICAgICAgIGNvbnN0IGZvcm1hdCA9IHZlcnRleEJ1ZmZlci5mb3JtYXQ7XG4gICAgICAgIGNvbnN0IGVsZW1lbnRDb3VudCA9IGZvcm1hdC5lbGVtZW50cy5sZW5ndGg7XG4gICAgICAgIGNvbnN0IHZiQnVmZmVyID0gdmVydGV4QnVmZmVyLmltcGwuYnVmZmVyO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGVsZW1lbnRDb3VudDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gZm9ybWF0LmVsZW1lbnRzW2ldO1xuICAgICAgICAgICAgdGhpcy5wYXNzRW5jb2Rlci5zZXRWZXJ0ZXhCdWZmZXIoc2xvdCArIGksIHZiQnVmZmVyLCBlbGVtZW50Lm9mZnNldCk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZWxlbWVudENvdW50O1xuICAgIH1cblxuICAgIGRyYXcocHJpbWl0aXZlLCBudW1JbnN0YW5jZXMgPSAxLCBrZWVwQnVmZmVycykge1xuXG4gICAgICAgIGlmICh0aGlzLnNoYWRlci5yZWFkeSkge1xuICAgICAgICAgICAgY29uc3QgcGFzc0VuY29kZXIgPSB0aGlzLnBhc3NFbmNvZGVyO1xuXG4gICAgICAgICAgICAvLyB2ZXJ0ZXggYnVmZmVyc1xuICAgICAgICAgICAgY29uc3QgdmIwID0gdGhpcy52ZXJ0ZXhCdWZmZXJzWzBdO1xuICAgICAgICAgICAgY29uc3QgdmJTbG90ID0gdGhpcy5zdWJtaXRWZXJ0ZXhCdWZmZXIodmIwLCAwKTtcbiAgICAgICAgICAgIGNvbnN0IHZiMSA9IHRoaXMudmVydGV4QnVmZmVyc1sxXTtcbiAgICAgICAgICAgIGlmICh2YjEpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnN1Ym1pdFZlcnRleEJ1ZmZlcih2YjEsIHZiU2xvdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLnZlcnRleEJ1ZmZlcnMubGVuZ3RoID0gMDtcblxuICAgICAgICAgICAgLy8gcmVuZGVyIHBpcGVsaW5lXG4gICAgICAgICAgICBjb25zdCBwaXBlbGluZSA9IHRoaXMucmVuZGVyUGlwZWxpbmUuZ2V0KHByaW1pdGl2ZSwgdmIwLmZvcm1hdCwgdmIxPy5mb3JtYXQsIHRoaXMuc2hhZGVyLCB0aGlzLnJlbmRlclRhcmdldCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5iaW5kR3JvdXBGb3JtYXRzLCB0aGlzLnJlbmRlclN0YXRlKTtcbiAgICAgICAgICAgIERlYnVnLmFzc2VydChwaXBlbGluZSk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLnBpcGVsaW5lICE9PSBwaXBlbGluZSkge1xuICAgICAgICAgICAgICAgIHRoaXMucGlwZWxpbmUgPSBwaXBlbGluZTtcbiAgICAgICAgICAgICAgICBwYXNzRW5jb2Rlci5zZXRQaXBlbGluZShwaXBlbGluZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGRyYXdcbiAgICAgICAgICAgIGNvbnN0IGliID0gdGhpcy5pbmRleEJ1ZmZlcjtcbiAgICAgICAgICAgIGlmIChpYikge1xuICAgICAgICAgICAgICAgIHBhc3NFbmNvZGVyLnNldEluZGV4QnVmZmVyKGliLmltcGwuYnVmZmVyLCBpYi5pbXBsLmZvcm1hdCk7XG4gICAgICAgICAgICAgICAgcGFzc0VuY29kZXIuZHJhd0luZGV4ZWQoaWIubnVtSW5kaWNlcywgbnVtSW5zdGFuY2VzLCAwLCAwLCAwKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcGFzc0VuY29kZXIuZHJhdyh2YjAubnVtVmVydGljZXMsIG51bUluc3RhbmNlcywgMCwgMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzZXRTaGFkZXIoc2hhZGVyKSB7XG5cbiAgICAgICAgdGhpcy5zaGFkZXIgPSBzaGFkZXI7XG5cbiAgICAgICAgLy8gI2lmIF9QUk9GSUxFUlxuICAgICAgICAvLyBUT0RPOiB3ZSBzaG91bGQgcHJvYmFibHkgdHJhY2sgb3RoZXIgc3RhdHMgaW5zdGVhZCwgbGlrZSBwaXBlbGluZSBzd2l0Y2hlc1xuICAgICAgICB0aGlzLl9zaGFkZXJTd2l0Y2hlc1BlckZyYW1lKys7XG4gICAgICAgIC8vICNlbmRpZlxuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHNldEJsZW5kaW5nKGJsZW5kaW5nKSB7XG4gICAgICAgIHRoaXMucmVuZGVyU3RhdGUuc2V0QmxlbmRpbmcoYmxlbmRpbmcpO1xuICAgIH1cblxuICAgIHNldEJsZW5kRnVuY3Rpb24oYmxlbmRTcmMsIGJsZW5kRHN0KSB7XG4gICAgICAgIHRoaXMucmVuZGVyU3RhdGUuc2V0QmxlbmRGdW5jdGlvbihibGVuZFNyYywgYmxlbmREc3QpO1xuICAgIH1cblxuICAgIHNldEJsZW5kRXF1YXRpb24oYmxlbmRFcXVhdGlvbikge1xuICAgICAgICB0aGlzLnJlbmRlclN0YXRlLnNldEJsZW5kRXF1YXRpb24oYmxlbmRFcXVhdGlvbik7XG4gICAgfVxuXG4gICAgc2V0RGVwdGhGdW5jKGZ1bmMpIHtcbiAgICB9XG5cbiAgICBzZXREZXB0aFRlc3QoZGVwdGhUZXN0KSB7XG4gICAgfVxuXG4gICAgc2V0Q3VsbE1vZGUoY3VsbE1vZGUpIHtcbiAgICB9XG5cbiAgICBzZXRBbHBoYVRvQ292ZXJhZ2Uoc3RhdGUpIHtcbiAgICB9XG5cbiAgICBzZXRDb2xvcldyaXRlKHdyaXRlUmVkLCB3cml0ZUdyZWVuLCB3cml0ZUJsdWUsIHdyaXRlQWxwaGEpIHtcbiAgICB9XG5cbiAgICBzZXREZXB0aFdyaXRlKHdyaXRlRGVwdGgpIHtcbiAgICB9XG5cbiAgICBpbml0aWFsaXplQ29udGV4dENhY2hlcygpIHtcbiAgICAgICAgc3VwZXIuaW5pdGlhbGl6ZUNvbnRleHRDYWNoZXMoKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTdGFydCBhIHJlbmRlciBwYXNzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtpbXBvcnQoJy4uL3JlbmRlci1wYXNzLmpzJykuUmVuZGVyUGFzc30gcmVuZGVyUGFzcyAtIFRoZSByZW5kZXIgcGFzcyB0byBzdGFydC5cbiAgICAgKiBAaWdub3JlXG4gICAgICovXG4gICAgc3RhcnRQYXNzKHJlbmRlclBhc3MpIHtcblxuICAgICAgICBjb25zdCBydCA9IHJlbmRlclBhc3MucmVuZGVyVGFyZ2V0IHx8IHRoaXMuZnJhbWVCdWZmZXI7XG4gICAgICAgIERlYnVnLmFzc2VydChydCk7XG5cbiAgICAgICAgdGhpcy5yZW5kZXJUYXJnZXQgPSBydDtcbiAgICAgICAgY29uc3Qgd3J0ID0gcnQuaW1wbDtcblxuICAgICAgICB0aGlzLmluaXRSZW5kZXJUYXJnZXQocnQpO1xuXG4gICAgICAgIC8vIGFzc2lnbiBjdXJyZW50IGZyYW1lJ3MgcmVuZGVyIHRleHR1cmUgaWYgcmVuZGVyaW5nIHRvIHRoZSBtYWluIGZyYW1lIGJ1ZmZlclxuICAgICAgICAvLyBUT0RPOiB0aGlzIHNob3VsZCBwcm9iYWJseSBiZSBkb25lIGF0IHRoZSBzdGFydCBvZiB0aGUgZnJhbWUsIHNvIHRoYXQgaXQgY2FuIGJlIHVzZWRcbiAgICAgICAgLy8gYXMgYSBkZXN0aW5hdGlvbiBvZiB0aGUgY29weSBvcGVyYXRpb25cbiAgICAgICAgaWYgKHJ0ID09PSB0aGlzLmZyYW1lQnVmZmVyKSB7XG4gICAgICAgICAgICBjb25zdCBvdXRDb2xvckJ1ZmZlciA9IHRoaXMuZ3B1Q29udGV4dC5nZXRDdXJyZW50VGV4dHVyZSgpO1xuICAgICAgICAgICAgRGVidWdIZWxwZXIuc2V0TGFiZWwob3V0Q29sb3JCdWZmZXIsIHJ0Lm5hbWUpO1xuICAgICAgICAgICAgd3J0LmFzc2lnbkNvbG9yVGV4dHVyZShvdXRDb2xvckJ1ZmZlcik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBzZXQgdXAgY2xlYXIgLyBzdG9yZSAvIGxvYWQgc2V0dGluZ3NcbiAgICAgICAgd3J0LnNldHVwRm9yUmVuZGVyUGFzcyhyZW5kZXJQYXNzKTtcblxuICAgICAgICAvLyBjcmVhdGUgYSBuZXcgZW5jb2RlciBmb3IgZWFjaCBwYXNzIHRvIGtlZXAgdGhlIEdQVSBidXN5IHdpdGggY29tbWFuZHNcbiAgICAgICAgdGhpcy5jb21tYW5kRW5jb2RlciA9IHRoaXMud2dwdS5jcmVhdGVDb21tYW5kRW5jb2RlcigpO1xuICAgICAgICBEZWJ1Z0hlbHBlci5zZXRMYWJlbCh0aGlzLmNvbW1hbmRFbmNvZGVyLCByZW5kZXJQYXNzLm5hbWUpO1xuXG4gICAgICAgIC8vIGNsZWFyIGNhY2hlZCBlbmNvZGVyIHN0YXRlXG4gICAgICAgIHRoaXMucGlwZWxpbmUgPSBudWxsO1xuXG4gICAgICAgIC8vIHN0YXJ0IHRoZSBwYXNzXG4gICAgICAgIHRoaXMucGFzc0VuY29kZXIgPSB0aGlzLmNvbW1hbmRFbmNvZGVyLmJlZ2luUmVuZGVyUGFzcyh3cnQucmVuZGVyUGFzc0Rlc2NyaXB0b3IpO1xuICAgICAgICBEZWJ1Z0hlbHBlci5zZXRMYWJlbCh0aGlzLnBhc3NFbmNvZGVyLCByZW5kZXJQYXNzLm5hbWUpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEVuZCBhIHJlbmRlciBwYXNzLlxuICAgICAqXG4gICAgICogQHBhcmFtIHtpbXBvcnQoJy4uL3JlbmRlci1wYXNzLmpzJykuUmVuZGVyUGFzc30gcmVuZGVyUGFzcyAtIFRoZSByZW5kZXIgcGFzcyB0byBlbmQuXG4gICAgICogQGlnbm9yZVxuICAgICAqL1xuICAgIGVuZFBhc3MocmVuZGVyUGFzcykge1xuXG4gICAgICAgIHRoaXMucGFzc0VuY29kZXIuZW5kKCk7XG4gICAgICAgIHRoaXMucGFzc0VuY29kZXIgPSBudWxsO1xuXG4gICAgICAgIHRoaXMud2dwdS5xdWV1ZS5zdWJtaXQoW3RoaXMuY29tbWFuZEVuY29kZXIuZmluaXNoKCldKTtcbiAgICAgICAgdGhpcy5jb21tYW5kRW5jb2RlciA9IG51bGw7XG4gICAgfVxuXG4gICAgY2xlYXIob3B0aW9ucykge1xuICAgICAgICBpZiAob3B0aW9ucy5mbGFncykge1xuICAgICAgICAgICAgdGhpcy5jbGVhclJlbmRlcmVyLmNsZWFyKHRoaXMsIHRoaXMucmVuZGVyVGFyZ2V0LCBvcHRpb25zKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldCB3aWR0aCgpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3dpZHRoO1xuICAgIH1cblxuICAgIGdldCBoZWlnaHQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLl9oZWlnaHQ7XG4gICAgfVxuXG4gICAgc2V0RGVwdGhCaWFzKG9uKSB7XG4gICAgfVxuXG4gICAgc2V0U3RlbmNpbFRlc3QoZW5hYmxlKSB7XG4gICAgfVxuXG4gICAgc2V0Vmlld3BvcnQoeCwgeSwgdywgaCkge1xuICAgICAgICAvLyBUT0RPOiBvbmx5IGV4ZWN1dGUgd2hlbiBpdCBjaGFuZ2VzLiBBbHNvLCB0aGUgdmlld3BvcnQgb2YgZW5jb2RlciAgbWF0Y2hlcyB0aGUgcmVuZGVyaW5nIGF0dGFjaG1lbnRzLFxuICAgICAgICAvLyBzbyB3ZSBjYW4gc2tpcCB0aGlzIGlmIGZ1bGxzY3JlZW5cbiAgICAgICAgLy8gVE9ETzogdGhpcyBjb25kaXRpb24gc2hvdWxkIGJlIHJlbW92ZWQsIGl0J3MgaGVyZSB0byBoYW5kbGUgZmFrZSBncmFiIHBhc3MsIHdoaWNoIHNob3VsZCBiZSByZWZhY3RvcmVkIGluc3RlYWRcbiAgICAgICAgaWYgKHRoaXMucGFzc0VuY29kZXIpIHtcbiAgICAgICAgICAgIHRoaXMucGFzc0VuY29kZXIuc2V0Vmlld3BvcnQoeCwgdGhpcy5yZW5kZXJUYXJnZXQuaGVpZ2h0IC0geSAtIGgsIHcsIGgsIDAsIDEpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgc2V0U2Npc3Nvcih4LCB5LCB3LCBoKSB7XG4gICAgICAgIC8vIFRPRE86IG9ubHkgZXhlY3V0ZSB3aGVuIGl0IGNoYW5nZXMuIEFsc28sIHRoZSB2aWV3cG9ydCBvZiBlbmNvZGVyICBtYXRjaGVzIHRoZSByZW5kZXJpbmcgYXR0YWNobWVudHMsXG4gICAgICAgIC8vIHNvIHdlIGNhbiBza2lwIHRoaXMgaWYgZnVsbHNjcmVlblxuICAgICAgICAvLyBUT0RPOiB0aGlzIGNvbmRpdGlvbiBzaG91bGQgYmUgcmVtb3ZlZCwgaXQncyBoZXJlIHRvIGhhbmRsZSBmYWtlIGdyYWIgcGFzcywgd2hpY2ggc2hvdWxkIGJlIHJlZmFjdG9yZWQgaW5zdGVhZFxuICAgICAgICBpZiAodGhpcy5wYXNzRW5jb2Rlcikge1xuICAgICAgICAgICAgdGhpcy5wYXNzRW5jb2Rlci5zZXRTY2lzc29yUmVjdCh4LCB0aGlzLnJlbmRlclRhcmdldC5oZWlnaHQgLSB5IC0gaCwgdywgaCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb3BpZXMgc291cmNlIHJlbmRlciB0YXJnZXQgaW50byBkZXN0aW5hdGlvbiByZW5kZXIgdGFyZ2V0LiBNb3N0bHkgdXNlZCBieSBwb3N0LWVmZmVjdHMuXG4gICAgICpcbiAgICAgKiBAcGFyYW0ge1JlbmRlclRhcmdldH0gW3NvdXJjZV0gLSBUaGUgc291cmNlIHJlbmRlciB0YXJnZXQuIERlZmF1bHRzIHRvIGZyYW1lIGJ1ZmZlci5cbiAgICAgKiBAcGFyYW0ge1JlbmRlclRhcmdldH0gW2Rlc3RdIC0gVGhlIGRlc3RpbmF0aW9uIHJlbmRlciB0YXJnZXQuIERlZmF1bHRzIHRvIGZyYW1lIGJ1ZmZlci5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtjb2xvcl0gLSBJZiB0cnVlIHdpbGwgY29weSB0aGUgY29sb3IgYnVmZmVyLiBEZWZhdWx0cyB0byBmYWxzZS5cbiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtkZXB0aF0gLSBJZiB0cnVlIHdpbGwgY29weSB0aGUgZGVwdGggYnVmZmVyLiBEZWZhdWx0cyB0byBmYWxzZS5cbiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB0aGUgY29weSB3YXMgc3VjY2Vzc2Z1bCwgZmFsc2Ugb3RoZXJ3aXNlLlxuICAgICAqL1xuICAgIGNvcHlSZW5kZXJUYXJnZXQoc291cmNlLCBkZXN0LCBjb2xvciwgZGVwdGgpIHtcblxuICAgICAgICAvLyB0eXBlIHtHUFVFeHRlbnQzRH1cbiAgICAgICAgY29uc3QgY29weVNpemUgPSB7XG4gICAgICAgICAgICB3aWR0aDogc291cmNlID8gc291cmNlLndpZHRoIDogZGVzdC53aWR0aCxcbiAgICAgICAgICAgIGhlaWdodDogc291cmNlID8gc291cmNlLmhlaWdodCA6IGRlc3QuaGVpZ2h0LFxuICAgICAgICAgICAgZGVwdGhPckFycmF5TGF5ZXJzOiAxXG4gICAgICAgIH07XG5cbiAgICAgICAgRGVidWdHcmFwaGljcy5wdXNoR3B1TWFya2VyKHRoaXMsICdDT1BZLVJUJyk7XG5cbiAgICAgICAgLy8gdXNlIGV4aXN0aW5nIG9yIGNyZWF0ZSBuZXcgZW5jb2RlciBpZiBiZXR3ZWVuIHJlbmRlciBwYXNzZXNcbiAgICAgICAgY29uc3QgY29tbWFuZEVuY29kZXIgPSB0aGlzLmNvbW1hbmRFbmNvZGVyID8/IHRoaXMud2dwdS5jcmVhdGVDb21tYW5kRW5jb2RlcigpO1xuXG4gICAgICAgIGlmIChjb2xvcikge1xuXG4gICAgICAgICAgICAvLyByZWFkIGZyb20gc3VwcGxpZWQgcmVuZGVyIHRhcmdldCwgb3IgZnJvbSB0aGUgZnJhbWVidWZmZXJcbiAgICAgICAgICAgIC8vIHR5cGUge0dQVUltYWdlQ29weVRleHR1cmV9XG4gICAgICAgICAgICBjb25zdCBjb3B5U3JjID0ge1xuICAgICAgICAgICAgICAgIHRleHR1cmU6IHNvdXJjZSA/IHNvdXJjZS5jb2xvckJ1ZmZlci5pbXBsLmdwdVRleHR1cmUgOiB0aGlzLnJlbmRlclRhcmdldC5pbXBsLmFzc2lnbmVkQ29sb3JUZXh0dXJlLFxuICAgICAgICAgICAgICAgIG1pcExldmVsOiAwXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAvLyB3cml0ZSB0byBzdXBwbGllZCByZW5kZXIgdGFyZ2V0LCBvciB0byB0aGUgZnJhbWVidWZmZXJcbiAgICAgICAgICAgIC8vIHR5cGUge0dQVUltYWdlQ29weVRleHR1cmV9XG4gICAgICAgICAgICBjb25zdCBjb3B5RHN0ID0ge1xuICAgICAgICAgICAgICAgIHRleHR1cmU6IGRlc3QgPyBkZXN0LmNvbG9yQnVmZmVyLmltcGwuZ3B1VGV4dHVyZSA6IHRoaXMucmVuZGVyVGFyZ2V0LmltcGwuYXNzaWduZWRDb2xvclRleHR1cmUsXG4gICAgICAgICAgICAgICAgbWlwTGV2ZWw6IDBcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIERlYnVnLmFzc2VydChjb3B5U3JjLnRleHR1cmUgIT09IG51bGwgJiYgY29weURzdC50ZXh0dXJlICE9PSBudWxsKTtcbiAgICAgICAgICAgIGNvbW1hbmRFbmNvZGVyLmNvcHlUZXh0dXJlVG9UZXh0dXJlKGNvcHlTcmMsIGNvcHlEc3QsIGNvcHlTaXplKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChkZXB0aCkge1xuXG4gICAgICAgICAgICAvLyByZWFkIGZyb20gc3VwcGxpZWQgcmVuZGVyIHRhcmdldCwgb3IgZnJvbSB0aGUgZnJhbWVidWZmZXJcbiAgICAgICAgICAgIGNvbnN0IHNvdXJjZVJUID0gc291cmNlID8gc291cmNlIDogdGhpcy5yZW5kZXJUYXJnZXQ7XG5cbiAgICAgICAgICAgIC8vIGNhbm5vdCBjb3B5IGRlcHRoIGZyb20gbXVsdGlzYW1wbGVkIGJ1ZmZlci4gT24gV2ViR1BVLCBpdCBjYW5ub3QgYmUgcmVzb2x2ZSBhdCB0aGUgZW5kIG9mIHRoZSBwYXNzIGVpdGhlcixcbiAgICAgICAgICAgIC8vIGFuZCBzbyB3ZSBuZWVkIHRvIGltcGxlbWVudCBhIGN1c3RvbSBkZXB0aCByZXNvbHZlIHNoYWRlciBiYXNlZCBjb3B5XG4gICAgICAgICAgICAvLyBUaGlzIGlzIGN1cnJlbnRseSBuZWVkZWQgZm9yIHVTY2VuZURlcHRoTWFwIHdoZW4gdGhlIGNhbWVyYSByZW5kZXJzIHRvIG11bHRpc2FtcGxlZCByZW5kZXIgdGFyZ2V0XG4gICAgICAgICAgICBEZWJ1Zy5hc3NlcnQoc291cmNlLnNhbXBsZXMgPD0gMSwgYGNvcHlSZW5kZXJUYXJnZXQgZG9lcyBub3QgY3VycmVudGx5IHN1cHBvcnQgY29weSBvZiBkZXB0aCBmcm9tIG11bHRpc2FtcGxlZCB0ZXh0dXJlYCwgc291cmNlUlQpO1xuXG4gICAgICAgICAgICAvLyB0eXBlIHtHUFVJbWFnZUNvcHlUZXh0dXJlfVxuICAgICAgICAgICAgY29uc3QgY29weVNyYyA9IHtcbiAgICAgICAgICAgICAgICB0ZXh0dXJlOiBzb3VyY2VSVC5pbXBsLmRlcHRoVGV4dHVyZSxcbiAgICAgICAgICAgICAgICBtaXBMZXZlbDogMFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy8gd3JpdGUgdG8gc3VwcGxpZWQgcmVuZGVyIHRhcmdldCwgb3IgdG8gdGhlIGZyYW1lYnVmZmVyXG4gICAgICAgICAgICAvLyB0eXBlIHtHUFVJbWFnZUNvcHlUZXh0dXJlfVxuICAgICAgICAgICAgY29uc3QgY29weURzdCA9IHtcbiAgICAgICAgICAgICAgICB0ZXh0dXJlOiBkZXN0ID8gZGVzdC5kZXB0aEJ1ZmZlci5pbXBsLmdwdVRleHR1cmUgOiB0aGlzLnJlbmRlclRhcmdldC5pbXBsLmRlcHRoVGV4dHVyZSxcbiAgICAgICAgICAgICAgICBtaXBMZXZlbDogMFxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgRGVidWcuYXNzZXJ0KGNvcHlTcmMudGV4dHVyZSAhPT0gbnVsbCAmJiBjb3B5RHN0LnRleHR1cmUgIT09IG51bGwpO1xuICAgICAgICAgICAgY29tbWFuZEVuY29kZXIuY29weVRleHR1cmVUb1RleHR1cmUoY29weVNyYywgY29weURzdCwgY29weVNpemUpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gc3VibWl0IHRoZSBlbmNvZGVkIGNvbW1hbmRzIGlmIHdlIGNyZWF0ZWQgdGhlIGVuY29kZXJcbiAgICAgICAgaWYgKCF0aGlzLmNvbW1hbmRFbmNvZGVyKSB7XG4gICAgICAgICAgICB0aGlzLndncHUucXVldWUuc3VibWl0KFtjb21tYW5kRW5jb2Rlci5maW5pc2goKV0pO1xuICAgICAgICB9XG5cbiAgICAgICAgRGVidWdHcmFwaGljcy5wb3BHcHVNYXJrZXIodGhpcyk7XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLy8gI2lmIF9ERUJVR1xuICAgIHB1c2hNYXJrZXIobmFtZSkge1xuICAgICAgICB0aGlzLnBhc3NFbmNvZGVyPy5wdXNoRGVidWdHcm91cChuYW1lKTtcbiAgICB9XG5cbiAgICBwb3BNYXJrZXIoKSB7XG4gICAgICAgIHRoaXMucGFzc0VuY29kZXI/LnBvcERlYnVnR3JvdXAoKTtcbiAgICB9XG4gICAgLy8gI2VuZGlmXG59XG5cbmV4cG9ydCB7IFdlYmdwdUdyYXBoaWNzRGV2aWNlIH07XG4iXSwibmFtZXMiOlsiV2ViZ3B1R3JhcGhpY3NEZXZpY2UiLCJHcmFwaGljc0RldmljZSIsImNvbnN0cnVjdG9yIiwiY2FudmFzIiwib3B0aW9ucyIsImZyYW1lQnVmZmVyIiwicmVuZGVyU3RhdGUiLCJXZWJncHVSZW5kZXJTdGF0ZSIsInJlbmRlclBpcGVsaW5lIiwiV2ViZ3B1UmVuZGVyUGlwZWxpbmUiLCJjbGVhclJlbmRlcmVyIiwiV2ViZ3B1Q2xlYXJSZW5kZXJlciIsInBpcGVsaW5lIiwiYmluZEdyb3VwRm9ybWF0cyIsImNvbW1hbmRFbmNvZGVyIiwiZGV2aWNlVHlwZSIsIkRFVklDRVRZUEVfV0VCR1BVIiwiaW5pdERldmljZUNhcHMiLCJwcmVjaXNpb24iLCJtYXhQcmVjaXNpb24iLCJtYXhTYW1wbGVzIiwibWF4VGV4dHVyZXMiLCJtYXhUZXh0dXJlU2l6ZSIsIm1heEN1YmVNYXBTaXplIiwibWF4Vm9sdW1lU2l6ZSIsIm1heFBpeGVsUmF0aW8iLCJzdXBwb3J0c0luc3RhbmNpbmciLCJzdXBwb3J0c1VuaWZvcm1CdWZmZXJzIiwic3VwcG9ydHNCb25lVGV4dHVyZXMiLCJzdXBwb3J0c01vcnBoVGFyZ2V0VGV4dHVyZXNDb3JlIiwic3VwcG9ydHNBcmVhTGlnaHRzIiwiZXh0VWludEVsZW1lbnQiLCJleHRUZXh0dXJlRmxvYXQiLCJ0ZXh0dXJlRmxvYXRSZW5kZXJhYmxlIiwiZXh0VGV4dHVyZUhhbGZGbG9hdCIsInRleHR1cmVIYWxmRmxvYXRSZW5kZXJhYmxlIiwidGV4dHVyZUhhbGZGbG9hdFVwZGF0YWJsZSIsImJvbmVMaW1pdCIsInN1cHBvcnRzSW1hZ2VCaXRtYXAiLCJleHRTdGFuZGFyZERlcml2YXRpdmVzIiwiYXJlYUxpZ2h0THV0Rm9ybWF0IiwiUElYRUxGT1JNQVRfUkdCQTMyRiIsInN1cHBvcnRzVGV4dHVyZUZldGNoIiwiaW5pdFdlYkdwdSIsImdsc2xhbmdVcmwiLCJ3aW5kb3ciLCJuYXZpZ2F0b3IiLCJncHUiLCJFcnJvciIsIkRlYnVnIiwibG9nIiwibG9hZFNjcmlwdCIsInVybCIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0Iiwic2NyaXB0IiwiZG9jdW1lbnQiLCJjcmVhdGVFbGVtZW50Iiwic3JjIiwiYXN5bmMiLCJvbmxvYWQiLCJvbmVycm9yIiwiYm9keSIsImFwcGVuZENoaWxkIiwiZ2xzbGFuZyIsImdwdUFkYXB0ZXIiLCJyZXF1ZXN0QWRhcHRlciIsIndncHUiLCJyZXF1ZXN0RGV2aWNlIiwic2V0UmVzb2x1dGlvbiIsImlubmVyV2lkdGgiLCJpbm5lckhlaWdodCIsImdwdUNvbnRleHQiLCJnZXRDb250ZXh0IiwicHJlZmVycmVkQ2FudmFzRm9ybWF0IiwiZ2V0UHJlZmVycmVkQ2FudmFzRm9ybWF0IiwiZnJhbWVidWZmZXJGb3JtYXQiLCJQSVhFTEZPUk1BVF9SR0JBOCIsIlBJWEVMRk9STUFUX0JHUkE4IiwiY2FudmFzQ29uZmlnIiwiZGV2aWNlIiwiY29sb3JTcGFjZSIsImFscGhhTW9kZSIsImZvcm1hdCIsInVzYWdlIiwiR1BVVGV4dHVyZVVzYWdlIiwiUkVOREVSX0FUVEFDSE1FTlQiLCJDT1BZX1NSQyIsInZpZXdGb3JtYXRzIiwiY29uZmlndXJlIiwiY3JlYXRlRnJhbWVidWZmZXIiLCJSZW5kZXJUYXJnZXQiLCJuYW1lIiwiZ3JhcGhpY3NEZXZpY2UiLCJkZXB0aCIsInNhbXBsZXMiLCJjcmVhdGVVbmlmb3JtQnVmZmVySW1wbCIsInVuaWZvcm1CdWZmZXIiLCJXZWJncHVVbmlmb3JtQnVmZmVyIiwiY3JlYXRlVmVydGV4QnVmZmVySW1wbCIsInZlcnRleEJ1ZmZlciIsIldlYmdwdVZlcnRleEJ1ZmZlciIsImNyZWF0ZUluZGV4QnVmZmVySW1wbCIsImluZGV4QnVmZmVyIiwiV2ViZ3B1SW5kZXhCdWZmZXIiLCJjcmVhdGVTaGFkZXJJbXBsIiwic2hhZGVyIiwiV2ViZ3B1U2hhZGVyIiwiY3JlYXRlVGV4dHVyZUltcGwiLCJ0ZXh0dXJlIiwiV2ViZ3B1VGV4dHVyZSIsImNyZWF0ZVJlbmRlclRhcmdldEltcGwiLCJyZW5kZXJUYXJnZXQiLCJXZWJncHVSZW5kZXJUYXJnZXQiLCJjcmVhdGVCaW5kR3JvdXBGb3JtYXRJbXBsIiwiYmluZEdyb3VwRm9ybWF0IiwiV2ViZ3B1QmluZEdyb3VwRm9ybWF0IiwiY3JlYXRlQmluZEdyb3VwSW1wbCIsImJpbmRHcm91cCIsIldlYmdwdUJpbmRHcm91cCIsInNldEJpbmRHcm91cCIsImluZGV4IiwicGFzc0VuY29kZXIiLCJpbXBsIiwic3VibWl0VmVydGV4QnVmZmVyIiwic2xvdCIsImVsZW1lbnRDb3VudCIsImVsZW1lbnRzIiwibGVuZ3RoIiwidmJCdWZmZXIiLCJidWZmZXIiLCJpIiwiZWxlbWVudCIsInNldFZlcnRleEJ1ZmZlciIsIm9mZnNldCIsImRyYXciLCJwcmltaXRpdmUiLCJudW1JbnN0YW5jZXMiLCJrZWVwQnVmZmVycyIsInJlYWR5IiwidmIwIiwidmVydGV4QnVmZmVycyIsInZiU2xvdCIsInZiMSIsImdldCIsImFzc2VydCIsInNldFBpcGVsaW5lIiwiaWIiLCJzZXRJbmRleEJ1ZmZlciIsImRyYXdJbmRleGVkIiwibnVtSW5kaWNlcyIsIm51bVZlcnRpY2VzIiwic2V0U2hhZGVyIiwiX3NoYWRlclN3aXRjaGVzUGVyRnJhbWUiLCJzZXRCbGVuZGluZyIsImJsZW5kaW5nIiwic2V0QmxlbmRGdW5jdGlvbiIsImJsZW5kU3JjIiwiYmxlbmREc3QiLCJzZXRCbGVuZEVxdWF0aW9uIiwiYmxlbmRFcXVhdGlvbiIsInNldERlcHRoRnVuYyIsImZ1bmMiLCJzZXREZXB0aFRlc3QiLCJkZXB0aFRlc3QiLCJzZXRDdWxsTW9kZSIsImN1bGxNb2RlIiwic2V0QWxwaGFUb0NvdmVyYWdlIiwic3RhdGUiLCJzZXRDb2xvcldyaXRlIiwid3JpdGVSZWQiLCJ3cml0ZUdyZWVuIiwid3JpdGVCbHVlIiwid3JpdGVBbHBoYSIsInNldERlcHRoV3JpdGUiLCJ3cml0ZURlcHRoIiwiaW5pdGlhbGl6ZUNvbnRleHRDYWNoZXMiLCJzdGFydFBhc3MiLCJyZW5kZXJQYXNzIiwicnQiLCJ3cnQiLCJpbml0UmVuZGVyVGFyZ2V0Iiwib3V0Q29sb3JCdWZmZXIiLCJnZXRDdXJyZW50VGV4dHVyZSIsIkRlYnVnSGVscGVyIiwic2V0TGFiZWwiLCJhc3NpZ25Db2xvclRleHR1cmUiLCJzZXR1cEZvclJlbmRlclBhc3MiLCJjcmVhdGVDb21tYW5kRW5jb2RlciIsImJlZ2luUmVuZGVyUGFzcyIsInJlbmRlclBhc3NEZXNjcmlwdG9yIiwiZW5kUGFzcyIsImVuZCIsInF1ZXVlIiwic3VibWl0IiwiZmluaXNoIiwiY2xlYXIiLCJmbGFncyIsIndpZHRoIiwiX3dpZHRoIiwiaGVpZ2h0IiwiX2hlaWdodCIsInNldERlcHRoQmlhcyIsIm9uIiwic2V0U3RlbmNpbFRlc3QiLCJlbmFibGUiLCJzZXRWaWV3cG9ydCIsIngiLCJ5IiwidyIsImgiLCJzZXRTY2lzc29yIiwic2V0U2Npc3NvclJlY3QiLCJjb3B5UmVuZGVyVGFyZ2V0Iiwic291cmNlIiwiZGVzdCIsImNvbG9yIiwiY29weVNpemUiLCJkZXB0aE9yQXJyYXlMYXllcnMiLCJEZWJ1Z0dyYXBoaWNzIiwicHVzaEdwdU1hcmtlciIsImNvcHlTcmMiLCJjb2xvckJ1ZmZlciIsImdwdVRleHR1cmUiLCJhc3NpZ25lZENvbG9yVGV4dHVyZSIsIm1pcExldmVsIiwiY29weURzdCIsImNvcHlUZXh0dXJlVG9UZXh0dXJlIiwic291cmNlUlQiLCJkZXB0aFRleHR1cmUiLCJkZXB0aEJ1ZmZlciIsInBvcEdwdU1hcmtlciIsInB1c2hNYXJrZXIiLCJwdXNoRGVidWdHcm91cCIsInBvcE1hcmtlciIsInBvcERlYnVnR3JvdXAiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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
