import { Debug, DebugHelper } from '../../../core/debug.js';
import { TRACEID_PIPELINELAYOUT_ALLOC, TRACEID_RENDERPIPELINE_ALLOC } from '../../../core/constants.js';
import { WebgpuVertexBufferLayout } from './webgpu-vertex-buffer-layout.js';
import { WebgpuDebug } from './webgpu-debug.js';

let _pipelineId = 0;
let _layoutId = 0;
const _primitiveTopology = ['point-list',
// PRIMITIVE_POINTS
'line-list',
// PRIMITIVE_LINES
undefined,
// PRIMITIVE_LINELOOP
'line-strip',
// PRIMITIVE_LINESTRIP
'triangle-list',
// PRIMITIVE_TRIANGLES
'triangle-strip',
// PRIMITIVE_TRISTRIP
undefined // PRIMITIVE_TRIFAN
];

const _blendOperation = ['add',
// BLENDEQUATION_ADD
'subtract',
// BLENDEQUATION_SUBTRACT
'reverse-subtract',
// BLENDEQUATION_REVERSE_SUBTRACT
'min',
// BLENDEQUATION_MIN
'max' // BLENDEQUATION_MAX
];

const _blendFactor = ['zero',
// BLENDMODE_ZERO
'one',
// BLENDMODE_ONE
'src',
// BLENDMODE_SRC_COLOR
'one-minus-src',
// BLENDMODE_ONE_MINUS_SRC_COLOR
'dst',
// BLENDMODE_DST_COLOR
'one-minus-dst',
// BLENDMODE_ONE_MINUS_DST_COLOR
'src-alpha',
// BLENDMODE_SRC_ALPHA
'src-alpha-saturated',
// BLENDMODE_SRC_ALPHA_SATURATE
'one-minus-src-alpha',
// BLENDMODE_ONE_MINUS_SRC_ALPHA
'dst-alpha',
// BLENDMODE_DST_ALPHA
'one-minus-dst-alpha',
// BLENDMODE_ONE_MINUS_DST_ALPHA
'constant',
// BLENDMODE_CONSTANT
'one-minus-constant' // BLENDMODE_ONE_MINUS_CONSTANT
];

const _compareFunction = ['never',
// FUNC_NEVER
'less',
// FUNC_LESS
'equal',
// FUNC_EQUAL
'less-equal',
// FUNC_LESSEQUAL
'greater',
// FUNC_GREATER
'not-equal',
// FUNC_NOTEQUAL
'greater-equal',
// FUNC_GREATEREQUAL
'always' // FUNC_ALWAYS
];

const _cullModes = ['none',
// CULLFACE_NONE
'back',
// CULLFACE_BACK
'front' // CULLFACE_FRONT
];

const _stencilOps = ['keep',
// STENCILOP_KEEP
'zero',
// STENCILOP_ZERO
'replace',
// STENCILOP_REPLACE
'increment-clamp',
// STENCILOP_INCREMENT
'increment-wrap',
// STENCILOP_INCREMENTWRAP
'decrement-clamp',
// STENCILOP_DECREMENT
'decrement-wrap',
// STENCILOP_DECREMENTWRAP
'invert' // STENCILOP_INVERT
];

// temp array to avoid allocation
const _bindGroupLayouts = [];

/**
 * @ignore
 */
class WebgpuRenderPipeline {
  constructor(device) {
    /** @type {import('./webgpu-graphics-device.js').WebgpuGraphicsDevice} */
    this.device = device;

    /**
     * The cache of vertex buffer layouts
     *
     * @type {WebgpuVertexBufferLayout}
     */
    this.vertexBufferLayout = new WebgpuVertexBufferLayout();

    /**
     * The cache of render pipelines
     *
     * @type {Map<string, object>}
     */
    this.cache = new Map();
  }
  get(primitive, vertexFormat0, vertexFormat1, shader, renderTarget, bindGroupFormats, blendState, depthState, cullMode, stencilEnabled, stencilFront, stencilBack) {
    // render pipeline unique key
    const key = this.getKey(primitive, vertexFormat0, vertexFormat1, shader, renderTarget, bindGroupFormats, blendState, depthState, cullMode, stencilEnabled, stencilFront, stencilBack);

    // cached pipeline
    let pipeline = this.cache.get(key);
    if (!pipeline) {
      const primitiveTopology = _primitiveTopology[primitive.type];
      Debug.assert(primitiveTopology, `Unsupported primitive topology`, primitive);

      // pipeline layout
      const pipelineLayout = this.getPipelineLayout(bindGroupFormats);

      // vertex buffer layout
      const vertexBufferLayout = this.vertexBufferLayout.get(vertexFormat0, vertexFormat1);

      // pipeline
      pipeline = this.create(primitiveTopology, shader, renderTarget, pipelineLayout, blendState, depthState, vertexBufferLayout, cullMode, stencilEnabled, stencilFront, stencilBack);
      this.cache.set(key, pipeline);
    }
    return pipeline;
  }

  /**
   * Generate a unique key for the render pipeline. Keep this function as lean as possible,
   * as it executes for each draw call.
   */
  getKey(primitive, vertexFormat0, vertexFormat1, shader, renderTarget, bindGroupFormats, blendState, depthState, cullMode, stencilEnabled, stencilFront, stencilBack) {
    let bindGroupKey = '';
    for (let i = 0; i < bindGroupFormats.length; i++) {
      bindGroupKey += bindGroupFormats[i].key;
    }
    const vertexBufferLayoutKey = this.vertexBufferLayout.getKey(vertexFormat0, vertexFormat1);
    const renderTargetKey = renderTarget.impl.key;
    const stencilKey = stencilEnabled ? stencilFront.key + stencilBack.key : '';
    return vertexBufferLayoutKey + shader.impl.vertexCode + shader.impl.fragmentCode + renderTargetKey + primitive.type + bindGroupKey + blendState.key + depthState.key + cullMode + stencilKey;
  }

  // TODO: this could be cached using bindGroupKey

  /**
   * @param {import('../bind-group-format.js').BindGroupFormat[]} bindGroupFormats - An array
   * of bind group formats.
   * @returns {any} Returns the pipeline layout.
   */
  getPipelineLayout(bindGroupFormats) {
    bindGroupFormats.forEach(format => {
      _bindGroupLayouts.push(format.bindGroupLayout);
    });
    const descr = {
      bindGroupLayouts: _bindGroupLayouts
    };
    _layoutId++;
    DebugHelper.setLabel(descr, `PipelineLayoutDescr-${_layoutId}`);

    /** @type {GPUPipelineLayout} */
    const pipelineLayout = this.device.wgpu.createPipelineLayout(descr);
    DebugHelper.setLabel(pipelineLayout, `PipelineLayout-${_layoutId}`);
    Debug.trace(TRACEID_PIPELINELAYOUT_ALLOC, `Alloc: Id ${_layoutId}`, {
      descr,
      bindGroupFormats
    });
    _bindGroupLayouts.length = 0;
    return pipelineLayout;
  }
  getBlend(blendState) {
    // blend needs to be undefined when blending is disabled
    let blend;
    if (blendState.blend) {
      /** @type {GPUBlendState} */
      blend = {
        color: {
          operation: _blendOperation[blendState.colorOp],
          srcFactor: _blendFactor[blendState.colorSrcFactor],
          dstFactor: _blendFactor[blendState.colorDstFactor]
        },
        alpha: {
          operation: _blendOperation[blendState.alphaOp],
          srcFactor: _blendFactor[blendState.alphaSrcFactor],
          dstFactor: _blendFactor[blendState.alphaDstFactor]
        }
      };

      // unsupported blend factors
      Debug.assert(blend.color.srcFactor !== undefined);
      Debug.assert(blend.color.dstFactor !== undefined);
      Debug.assert(blend.alpha.srcFactor !== undefined);
      Debug.assert(blend.alpha.dstFactor !== undefined);
    }
    return blend;
  }

  /** @private */
  getDepthStencil(depthState, renderTarget, stencilEnabled, stencilFront, stencilBack) {
    /** @type {GPUDepthStencilState} */
    let depthStencil;
    const {
      depth,
      stencil
    } = renderTarget;
    if (depth || stencil) {
      // format of depth-stencil attachment
      depthStencil = {
        format: renderTarget.impl.depthFormat
      };

      // depth
      if (depth) {
        depthStencil.depthWriteEnabled = depthState.write;
        depthStencil.depthCompare = _compareFunction[depthState.func];
      } else {
        // if render target does not have depth buffer
        depthStencil.depthWriteEnabled = false;
        depthStencil.depthCompare = 'always';
      }

      // stencil
      if (stencil && stencilEnabled) {
        // Note that WebGPU only supports a single mask, we use the one from front, but not from back.
        depthStencil.stencilReadMas = stencilFront.readMask;
        depthStencil.stencilWriteMask = stencilFront.writeMask;
        depthStencil.stencilFront = {
          compare: _compareFunction[stencilFront.func],
          failOp: _stencilOps[stencilFront.fail],
          passOp: _stencilOps[stencilFront.zpass],
          depthFailOp: _stencilOps[stencilFront.zfail]
        };
        depthStencil.stencilBack = {
          compare: _compareFunction[stencilBack.func],
          failOp: _stencilOps[stencilBack.fail],
          passOp: _stencilOps[stencilBack.zpass],
          depthFailOp: _stencilOps[stencilBack.zfail]
        };
      }
    }
    return depthStencil;
  }
  create(primitiveTopology, shader, renderTarget, pipelineLayout, blendState, depthState, vertexBufferLayout, cullMode, stencilEnabled, stencilFront, stencilBack) {
    const wgpu = this.device.wgpu;

    /** @type {import('./webgpu-shader.js').WebgpuShader} */
    const webgpuShader = shader.impl;

    /** @type {GPURenderPipelineDescriptor} */
    const descr = {
      vertex: {
        module: webgpuShader.getVertexShaderModule(),
        entryPoint: webgpuShader.vertexEntryPoint,
        buffers: vertexBufferLayout
      },
      fragment: {
        module: webgpuShader.getFragmentShaderModule(),
        entryPoint: webgpuShader.fragmentEntryPoint,
        targets: []
      },
      primitive: {
        topology: primitiveTopology,
        frontFace: 'ccw',
        cullMode: _cullModes[cullMode]
      },
      depthStencil: this.getDepthStencil(depthState, renderTarget, stencilEnabled, stencilFront, stencilBack),
      multisample: {
        count: renderTarget.samples
      },
      // uniform / texture binding layout
      layout: pipelineLayout
    };
    const colorAttachments = renderTarget.impl.colorAttachments;
    if (colorAttachments.length > 0) {
      // the same write mask is used by all color buffers, to match the WebGL behavior
      let writeMask = 0;
      if (blendState.redWrite) writeMask |= GPUColorWrite.RED;
      if (blendState.greenWrite) writeMask |= GPUColorWrite.GREEN;
      if (blendState.blueWrite) writeMask |= GPUColorWrite.BLUE;
      if (blendState.alphaWrite) writeMask |= GPUColorWrite.ALPHA;

      // the same blend state is used by all color buffers, to match the WebGL behavior
      const blend = this.getBlend(blendState);
      colorAttachments.forEach(attachment => {
        descr.fragment.targets.push({
          format: attachment.format,
          writeMask: writeMask,
          blend: blend
        });
      });
    }
    WebgpuDebug.validate(this.device);
    _pipelineId++;
    DebugHelper.setLabel(descr, `RenderPipelineDescr-${_pipelineId}`);
    const pipeline = wgpu.createRenderPipeline(descr);
    DebugHelper.setLabel(pipeline, `RenderPipeline-${_pipelineId}`);
    Debug.trace(TRACEID_RENDERPIPELINE_ALLOC, `Alloc: Id ${_pipelineId}`, descr);
    WebgpuDebug.end(this.device, {
      renderPipeline: this,
      descr,
      shader
    });
    return pipeline;
  }
}

export { WebgpuRenderPipeline };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2ViZ3B1LXJlbmRlci1waXBlbGluZS5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vc3JjL3BsYXRmb3JtL2dyYXBoaWNzL3dlYmdwdS93ZWJncHUtcmVuZGVyLXBpcGVsaW5lLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERlYnVnLCBEZWJ1Z0hlbHBlciB9IGZyb20gXCIuLi8uLi8uLi9jb3JlL2RlYnVnLmpzXCI7XG5pbXBvcnQgeyBUUkFDRUlEX1JFTkRFUlBJUEVMSU5FX0FMTE9DLCBUUkFDRUlEX1BJUEVMSU5FTEFZT1VUX0FMTE9DIH0gZnJvbSBcIi4uLy4uLy4uL2NvcmUvY29uc3RhbnRzLmpzXCI7XG5cbmltcG9ydCB7IFdlYmdwdVZlcnRleEJ1ZmZlckxheW91dCB9IGZyb20gXCIuL3dlYmdwdS12ZXJ0ZXgtYnVmZmVyLWxheW91dC5qc1wiO1xuaW1wb3J0IHsgV2ViZ3B1RGVidWcgfSBmcm9tIFwiLi93ZWJncHUtZGVidWcuanNcIjtcblxubGV0IF9waXBlbGluZUlkID0gMDtcbmxldCBfbGF5b3V0SWQgPSAwO1xuXG5jb25zdCBfcHJpbWl0aXZlVG9wb2xvZ3kgPSBbXG4gICAgJ3BvaW50LWxpc3QnLCAgICAgICAvLyBQUklNSVRJVkVfUE9JTlRTXG4gICAgJ2xpbmUtbGlzdCcsICAgICAgICAvLyBQUklNSVRJVkVfTElORVNcbiAgICB1bmRlZmluZWQsICAgICAgICAgIC8vIFBSSU1JVElWRV9MSU5FTE9PUFxuICAgICdsaW5lLXN0cmlwJywgICAgICAgLy8gUFJJTUlUSVZFX0xJTkVTVFJJUFxuICAgICd0cmlhbmdsZS1saXN0JywgICAgLy8gUFJJTUlUSVZFX1RSSUFOR0xFU1xuICAgICd0cmlhbmdsZS1zdHJpcCcsICAgLy8gUFJJTUlUSVZFX1RSSVNUUklQXG4gICAgdW5kZWZpbmVkICAgICAgICAgICAvLyBQUklNSVRJVkVfVFJJRkFOXG5dO1xuXG5jb25zdCBfYmxlbmRPcGVyYXRpb24gPSBbXG4gICAgJ2FkZCcsICAgICAgICAgICAgICAvLyBCTEVOREVRVUFUSU9OX0FERFxuICAgICdzdWJ0cmFjdCcsICAgICAgICAgLy8gQkxFTkRFUVVBVElPTl9TVUJUUkFDVFxuICAgICdyZXZlcnNlLXN1YnRyYWN0JywgLy8gQkxFTkRFUVVBVElPTl9SRVZFUlNFX1NVQlRSQUNUXG4gICAgJ21pbicsICAgICAgICAgICAgICAvLyBCTEVOREVRVUFUSU9OX01JTlxuICAgICdtYXgnICAgICAgICAgICAgICAgLy8gQkxFTkRFUVVBVElPTl9NQVhcbl07XG5cbmNvbnN0IF9ibGVuZEZhY3RvciA9IFtcbiAgICAnemVybycsICAgICAgICAgICAgICAgICAvLyBCTEVORE1PREVfWkVST1xuICAgICdvbmUnLCAgICAgICAgICAgICAgICAgIC8vIEJMRU5ETU9ERV9PTkVcbiAgICAnc3JjJywgICAgICAgICAgICAgICAgICAvLyBCTEVORE1PREVfU1JDX0NPTE9SXG4gICAgJ29uZS1taW51cy1zcmMnLCAgICAgICAgLy8gQkxFTkRNT0RFX09ORV9NSU5VU19TUkNfQ09MT1JcbiAgICAnZHN0JywgICAgICAgICAgICAgICAgICAvLyBCTEVORE1PREVfRFNUX0NPTE9SXG4gICAgJ29uZS1taW51cy1kc3QnLCAgICAgICAgLy8gQkxFTkRNT0RFX09ORV9NSU5VU19EU1RfQ09MT1JcbiAgICAnc3JjLWFscGhhJywgICAgICAgICAgICAvLyBCTEVORE1PREVfU1JDX0FMUEhBXG4gICAgJ3NyYy1hbHBoYS1zYXR1cmF0ZWQnLCAgLy8gQkxFTkRNT0RFX1NSQ19BTFBIQV9TQVRVUkFURVxuICAgICdvbmUtbWludXMtc3JjLWFscGhhJywgIC8vIEJMRU5ETU9ERV9PTkVfTUlOVVNfU1JDX0FMUEhBXG4gICAgJ2RzdC1hbHBoYScsICAgICAgICAgICAgLy8gQkxFTkRNT0RFX0RTVF9BTFBIQVxuICAgICdvbmUtbWludXMtZHN0LWFscGhhJywgIC8vIEJMRU5ETU9ERV9PTkVfTUlOVVNfRFNUX0FMUEhBXG4gICAgJ2NvbnN0YW50JywgICAgICAgICAgICAgLy8gQkxFTkRNT0RFX0NPTlNUQU5UXG4gICAgJ29uZS1taW51cy1jb25zdGFudCcgICAgLy8gQkxFTkRNT0RFX09ORV9NSU5VU19DT05TVEFOVFxuXTtcblxuY29uc3QgX2NvbXBhcmVGdW5jdGlvbiA9IFtcbiAgICAnbmV2ZXInLCAgICAgICAgICAgICAgICAvLyBGVU5DX05FVkVSXG4gICAgJ2xlc3MnLCAgICAgICAgICAgICAgICAgLy8gRlVOQ19MRVNTXG4gICAgJ2VxdWFsJywgICAgICAgICAgICAgICAgLy8gRlVOQ19FUVVBTFxuICAgICdsZXNzLWVxdWFsJywgICAgICAgICAgIC8vIEZVTkNfTEVTU0VRVUFMXG4gICAgJ2dyZWF0ZXInLCAgICAgICAgICAgICAgLy8gRlVOQ19HUkVBVEVSXG4gICAgJ25vdC1lcXVhbCcsICAgICAgICAgICAgLy8gRlVOQ19OT1RFUVVBTFxuICAgICdncmVhdGVyLWVxdWFsJywgICAgICAgIC8vIEZVTkNfR1JFQVRFUkVRVUFMXG4gICAgJ2Fsd2F5cycgICAgICAgICAgICAgICAgLy8gRlVOQ19BTFdBWVNcbl07XG5cbmNvbnN0IF9jdWxsTW9kZXMgPSBbXG4gICAgJ25vbmUnLCAgICAgICAgICAgICAgICAgLy8gQ1VMTEZBQ0VfTk9ORVxuICAgICdiYWNrJywgICAgICAgICAgICAgICAgIC8vIENVTExGQUNFX0JBQ0tcbiAgICAnZnJvbnQnICAgICAgICAgICAgICAgICAvLyBDVUxMRkFDRV9GUk9OVFxuXTtcblxuY29uc3QgX3N0ZW5jaWxPcHMgPSBbXG4gICAgJ2tlZXAnLCAgICAgICAgICAgICAgICAgLy8gU1RFTkNJTE9QX0tFRVBcbiAgICAnemVybycsICAgICAgICAgICAgICAgICAvLyBTVEVOQ0lMT1BfWkVST1xuICAgICdyZXBsYWNlJywgICAgICAgICAgICAgIC8vIFNURU5DSUxPUF9SRVBMQUNFXG4gICAgJ2luY3JlbWVudC1jbGFtcCcsICAgICAgLy8gU1RFTkNJTE9QX0lOQ1JFTUVOVFxuICAgICdpbmNyZW1lbnQtd3JhcCcsICAgICAgIC8vIFNURU5DSUxPUF9JTkNSRU1FTlRXUkFQXG4gICAgJ2RlY3JlbWVudC1jbGFtcCcsICAgICAgLy8gU1RFTkNJTE9QX0RFQ1JFTUVOVFxuICAgICdkZWNyZW1lbnQtd3JhcCcsICAgICAgIC8vIFNURU5DSUxPUF9ERUNSRU1FTlRXUkFQXG4gICAgJ2ludmVydCcgICAgICAgICAgICAgICAgLy8gU1RFTkNJTE9QX0lOVkVSVFxuXTtcblxuLy8gdGVtcCBhcnJheSB0byBhdm9pZCBhbGxvY2F0aW9uXG5jb25zdCBfYmluZEdyb3VwTGF5b3V0cyA9IFtdO1xuXG4vKipcbiAqIEBpZ25vcmVcbiAqL1xuY2xhc3MgV2ViZ3B1UmVuZGVyUGlwZWxpbmUge1xuICAgIGNvbnN0cnVjdG9yKGRldmljZSkge1xuICAgICAgICAvKiogQHR5cGUge2ltcG9ydCgnLi93ZWJncHUtZ3JhcGhpY3MtZGV2aWNlLmpzJykuV2ViZ3B1R3JhcGhpY3NEZXZpY2V9ICovXG4gICAgICAgIHRoaXMuZGV2aWNlID0gZGV2aWNlO1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBUaGUgY2FjaGUgb2YgdmVydGV4IGJ1ZmZlciBsYXlvdXRzXG4gICAgICAgICAqXG4gICAgICAgICAqIEB0eXBlIHtXZWJncHVWZXJ0ZXhCdWZmZXJMYXlvdXR9XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLnZlcnRleEJ1ZmZlckxheW91dCA9IG5ldyBXZWJncHVWZXJ0ZXhCdWZmZXJMYXlvdXQoKTtcblxuICAgICAgICAvKipcbiAgICAgICAgICogVGhlIGNhY2hlIG9mIHJlbmRlciBwaXBlbGluZXNcbiAgICAgICAgICpcbiAgICAgICAgICogQHR5cGUge01hcDxzdHJpbmcsIG9iamVjdD59XG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLmNhY2hlID0gbmV3IE1hcCgpO1xuICAgIH1cblxuICAgIGdldChwcmltaXRpdmUsIHZlcnRleEZvcm1hdDAsIHZlcnRleEZvcm1hdDEsIHNoYWRlciwgcmVuZGVyVGFyZ2V0LCBiaW5kR3JvdXBGb3JtYXRzLCBibGVuZFN0YXRlLFxuICAgICAgICBkZXB0aFN0YXRlLCBjdWxsTW9kZSwgc3RlbmNpbEVuYWJsZWQsIHN0ZW5jaWxGcm9udCwgc3RlbmNpbEJhY2spIHtcblxuICAgICAgICAvLyByZW5kZXIgcGlwZWxpbmUgdW5pcXVlIGtleVxuICAgICAgICBjb25zdCBrZXkgPSB0aGlzLmdldEtleShwcmltaXRpdmUsIHZlcnRleEZvcm1hdDAsIHZlcnRleEZvcm1hdDEsIHNoYWRlciwgcmVuZGVyVGFyZ2V0LCBiaW5kR3JvdXBGb3JtYXRzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBibGVuZFN0YXRlLCBkZXB0aFN0YXRlLCBjdWxsTW9kZSwgc3RlbmNpbEVuYWJsZWQsIHN0ZW5jaWxGcm9udCwgc3RlbmNpbEJhY2spO1xuXG4gICAgICAgIC8vIGNhY2hlZCBwaXBlbGluZVxuICAgICAgICBsZXQgcGlwZWxpbmUgPSB0aGlzLmNhY2hlLmdldChrZXkpO1xuICAgICAgICBpZiAoIXBpcGVsaW5lKSB7XG5cbiAgICAgICAgICAgIGNvbnN0IHByaW1pdGl2ZVRvcG9sb2d5ID0gX3ByaW1pdGl2ZVRvcG9sb2d5W3ByaW1pdGl2ZS50eXBlXTtcbiAgICAgICAgICAgIERlYnVnLmFzc2VydChwcmltaXRpdmVUb3BvbG9neSwgYFVuc3VwcG9ydGVkIHByaW1pdGl2ZSB0b3BvbG9neWAsIHByaW1pdGl2ZSk7XG5cbiAgICAgICAgICAgIC8vIHBpcGVsaW5lIGxheW91dFxuICAgICAgICAgICAgY29uc3QgcGlwZWxpbmVMYXlvdXQgPSB0aGlzLmdldFBpcGVsaW5lTGF5b3V0KGJpbmRHcm91cEZvcm1hdHMpO1xuXG4gICAgICAgICAgICAvLyB2ZXJ0ZXggYnVmZmVyIGxheW91dFxuICAgICAgICAgICAgY29uc3QgdmVydGV4QnVmZmVyTGF5b3V0ID0gdGhpcy52ZXJ0ZXhCdWZmZXJMYXlvdXQuZ2V0KHZlcnRleEZvcm1hdDAsIHZlcnRleEZvcm1hdDEpO1xuXG4gICAgICAgICAgICAvLyBwaXBlbGluZVxuICAgICAgICAgICAgcGlwZWxpbmUgPSB0aGlzLmNyZWF0ZShwcmltaXRpdmVUb3BvbG9neSwgc2hhZGVyLCByZW5kZXJUYXJnZXQsIHBpcGVsaW5lTGF5b3V0LCBibGVuZFN0YXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXB0aFN0YXRlLCB2ZXJ0ZXhCdWZmZXJMYXlvdXQsIGN1bGxNb2RlLCBzdGVuY2lsRW5hYmxlZCwgc3RlbmNpbEZyb250LCBzdGVuY2lsQmFjayk7XG4gICAgICAgICAgICB0aGlzLmNhY2hlLnNldChrZXksIHBpcGVsaW5lKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBwaXBlbGluZTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZW5lcmF0ZSBhIHVuaXF1ZSBrZXkgZm9yIHRoZSByZW5kZXIgcGlwZWxpbmUuIEtlZXAgdGhpcyBmdW5jdGlvbiBhcyBsZWFuIGFzIHBvc3NpYmxlLFxuICAgICAqIGFzIGl0IGV4ZWN1dGVzIGZvciBlYWNoIGRyYXcgY2FsbC5cbiAgICAgKi9cbiAgICBnZXRLZXkocHJpbWl0aXZlLCB2ZXJ0ZXhGb3JtYXQwLCB2ZXJ0ZXhGb3JtYXQxLCBzaGFkZXIsIHJlbmRlclRhcmdldCwgYmluZEdyb3VwRm9ybWF0cyxcbiAgICAgICAgYmxlbmRTdGF0ZSwgZGVwdGhTdGF0ZSwgY3VsbE1vZGUsIHN0ZW5jaWxFbmFibGVkLCBzdGVuY2lsRnJvbnQsIHN0ZW5jaWxCYWNrKSB7XG5cbiAgICAgICAgbGV0IGJpbmRHcm91cEtleSA9ICcnO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJpbmRHcm91cEZvcm1hdHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGJpbmRHcm91cEtleSArPSBiaW5kR3JvdXBGb3JtYXRzW2ldLmtleTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHZlcnRleEJ1ZmZlckxheW91dEtleSA9IHRoaXMudmVydGV4QnVmZmVyTGF5b3V0LmdldEtleSh2ZXJ0ZXhGb3JtYXQwLCB2ZXJ0ZXhGb3JtYXQxKTtcbiAgICAgICAgY29uc3QgcmVuZGVyVGFyZ2V0S2V5ID0gcmVuZGVyVGFyZ2V0LmltcGwua2V5O1xuICAgICAgICBjb25zdCBzdGVuY2lsS2V5ID0gc3RlbmNpbEVuYWJsZWQgPyBzdGVuY2lsRnJvbnQua2V5ICsgc3RlbmNpbEJhY2sua2V5IDogJyc7XG5cbiAgICAgICAgcmV0dXJuIHZlcnRleEJ1ZmZlckxheW91dEtleSArIHNoYWRlci5pbXBsLnZlcnRleENvZGUgKyBzaGFkZXIuaW1wbC5mcmFnbWVudENvZGUgK1xuICAgICAgICAgICAgcmVuZGVyVGFyZ2V0S2V5ICsgcHJpbWl0aXZlLnR5cGUgKyBiaW5kR3JvdXBLZXkgKyBibGVuZFN0YXRlLmtleSArIGRlcHRoU3RhdGUua2V5ICsgY3VsbE1vZGUgKyBzdGVuY2lsS2V5O1xuICAgIH1cblxuICAgIC8vIFRPRE86IHRoaXMgY291bGQgYmUgY2FjaGVkIHVzaW5nIGJpbmRHcm91cEtleVxuXG4gICAgLyoqXG4gICAgICogQHBhcmFtIHtpbXBvcnQoJy4uL2JpbmQtZ3JvdXAtZm9ybWF0LmpzJykuQmluZEdyb3VwRm9ybWF0W119IGJpbmRHcm91cEZvcm1hdHMgLSBBbiBhcnJheVxuICAgICAqIG9mIGJpbmQgZ3JvdXAgZm9ybWF0cy5cbiAgICAgKiBAcmV0dXJucyB7YW55fSBSZXR1cm5zIHRoZSBwaXBlbGluZSBsYXlvdXQuXG4gICAgICovXG4gICAgZ2V0UGlwZWxpbmVMYXlvdXQoYmluZEdyb3VwRm9ybWF0cykge1xuXG4gICAgICAgIGJpbmRHcm91cEZvcm1hdHMuZm9yRWFjaCgoZm9ybWF0KSA9PiB7XG4gICAgICAgICAgICBfYmluZEdyb3VwTGF5b3V0cy5wdXNoKGZvcm1hdC5iaW5kR3JvdXBMYXlvdXQpO1xuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCBkZXNjciA9IHtcbiAgICAgICAgICAgIGJpbmRHcm91cExheW91dHM6IF9iaW5kR3JvdXBMYXlvdXRzXG4gICAgICAgIH07XG5cbiAgICAgICAgX2xheW91dElkKys7XG4gICAgICAgIERlYnVnSGVscGVyLnNldExhYmVsKGRlc2NyLCBgUGlwZWxpbmVMYXlvdXREZXNjci0ke19sYXlvdXRJZH1gKTtcblxuICAgICAgICAvKiogQHR5cGUge0dQVVBpcGVsaW5lTGF5b3V0fSAqL1xuICAgICAgICBjb25zdCBwaXBlbGluZUxheW91dCA9IHRoaXMuZGV2aWNlLndncHUuY3JlYXRlUGlwZWxpbmVMYXlvdXQoZGVzY3IpO1xuICAgICAgICBEZWJ1Z0hlbHBlci5zZXRMYWJlbChwaXBlbGluZUxheW91dCwgYFBpcGVsaW5lTGF5b3V0LSR7X2xheW91dElkfWApO1xuICAgICAgICBEZWJ1Zy50cmFjZShUUkFDRUlEX1BJUEVMSU5FTEFZT1VUX0FMTE9DLCBgQWxsb2M6IElkICR7X2xheW91dElkfWAsIHtcbiAgICAgICAgICAgIGRlc2NyLFxuICAgICAgICAgICAgYmluZEdyb3VwRm9ybWF0c1xuICAgICAgICB9KTtcblxuICAgICAgICBfYmluZEdyb3VwTGF5b3V0cy5sZW5ndGggPSAwO1xuXG4gICAgICAgIHJldHVybiBwaXBlbGluZUxheW91dDtcbiAgICB9XG5cbiAgICBnZXRCbGVuZChibGVuZFN0YXRlKSB7XG5cbiAgICAgICAgLy8gYmxlbmQgbmVlZHMgdG8gYmUgdW5kZWZpbmVkIHdoZW4gYmxlbmRpbmcgaXMgZGlzYWJsZWRcbiAgICAgICAgbGV0IGJsZW5kO1xuXG4gICAgICAgIGlmIChibGVuZFN0YXRlLmJsZW5kKSB7XG5cbiAgICAgICAgICAgIC8qKiBAdHlwZSB7R1BVQmxlbmRTdGF0ZX0gKi9cbiAgICAgICAgICAgIGJsZW5kID0ge1xuICAgICAgICAgICAgICAgIGNvbG9yOiB7XG4gICAgICAgICAgICAgICAgICAgIG9wZXJhdGlvbjogX2JsZW5kT3BlcmF0aW9uW2JsZW5kU3RhdGUuY29sb3JPcF0sXG4gICAgICAgICAgICAgICAgICAgIHNyY0ZhY3RvcjogX2JsZW5kRmFjdG9yW2JsZW5kU3RhdGUuY29sb3JTcmNGYWN0b3JdLFxuICAgICAgICAgICAgICAgICAgICBkc3RGYWN0b3I6IF9ibGVuZEZhY3RvcltibGVuZFN0YXRlLmNvbG9yRHN0RmFjdG9yXVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgYWxwaGE6IHtcbiAgICAgICAgICAgICAgICAgICAgb3BlcmF0aW9uOiBfYmxlbmRPcGVyYXRpb25bYmxlbmRTdGF0ZS5hbHBoYU9wXSxcbiAgICAgICAgICAgICAgICAgICAgc3JjRmFjdG9yOiBfYmxlbmRGYWN0b3JbYmxlbmRTdGF0ZS5hbHBoYVNyY0ZhY3Rvcl0sXG4gICAgICAgICAgICAgICAgICAgIGRzdEZhY3RvcjogX2JsZW5kRmFjdG9yW2JsZW5kU3RhdGUuYWxwaGFEc3RGYWN0b3JdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgLy8gdW5zdXBwb3J0ZWQgYmxlbmQgZmFjdG9yc1xuICAgICAgICAgICAgRGVidWcuYXNzZXJ0KGJsZW5kLmNvbG9yLnNyY0ZhY3RvciAhPT0gdW5kZWZpbmVkKTtcbiAgICAgICAgICAgIERlYnVnLmFzc2VydChibGVuZC5jb2xvci5kc3RGYWN0b3IgIT09IHVuZGVmaW5lZCk7XG4gICAgICAgICAgICBEZWJ1Zy5hc3NlcnQoYmxlbmQuYWxwaGEuc3JjRmFjdG9yICE9PSB1bmRlZmluZWQpO1xuICAgICAgICAgICAgRGVidWcuYXNzZXJ0KGJsZW5kLmFscGhhLmRzdEZhY3RvciAhPT0gdW5kZWZpbmVkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBibGVuZDtcbiAgICB9XG5cbiAgICAvKiogQHByaXZhdGUgKi9cbiAgICBnZXREZXB0aFN0ZW5jaWwoZGVwdGhTdGF0ZSwgcmVuZGVyVGFyZ2V0LCBzdGVuY2lsRW5hYmxlZCwgc3RlbmNpbEZyb250LCBzdGVuY2lsQmFjaykge1xuXG4gICAgICAgIC8qKiBAdHlwZSB7R1BVRGVwdGhTdGVuY2lsU3RhdGV9ICovXG4gICAgICAgIGxldCBkZXB0aFN0ZW5jaWw7XG4gICAgICAgIGNvbnN0IHsgZGVwdGgsIHN0ZW5jaWwgfSA9IHJlbmRlclRhcmdldDtcbiAgICAgICAgaWYgKGRlcHRoIHx8IHN0ZW5jaWwpIHtcblxuICAgICAgICAgICAgLy8gZm9ybWF0IG9mIGRlcHRoLXN0ZW5jaWwgYXR0YWNobWVudFxuICAgICAgICAgICAgZGVwdGhTdGVuY2lsID0ge1xuICAgICAgICAgICAgICAgIGZvcm1hdDogcmVuZGVyVGFyZ2V0LmltcGwuZGVwdGhGb3JtYXRcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIC8vIGRlcHRoXG4gICAgICAgICAgICBpZiAoZGVwdGgpIHtcbiAgICAgICAgICAgICAgICBkZXB0aFN0ZW5jaWwuZGVwdGhXcml0ZUVuYWJsZWQgPSBkZXB0aFN0YXRlLndyaXRlO1xuICAgICAgICAgICAgICAgIGRlcHRoU3RlbmNpbC5kZXB0aENvbXBhcmUgPSBfY29tcGFyZUZ1bmN0aW9uW2RlcHRoU3RhdGUuZnVuY107XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIC8vIGlmIHJlbmRlciB0YXJnZXQgZG9lcyBub3QgaGF2ZSBkZXB0aCBidWZmZXJcbiAgICAgICAgICAgICAgICBkZXB0aFN0ZW5jaWwuZGVwdGhXcml0ZUVuYWJsZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBkZXB0aFN0ZW5jaWwuZGVwdGhDb21wYXJlID0gJ2Fsd2F5cyc7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIHN0ZW5jaWxcbiAgICAgICAgICAgIGlmIChzdGVuY2lsICYmIHN0ZW5jaWxFbmFibGVkKSB7XG5cbiAgICAgICAgICAgICAgICAvLyBOb3RlIHRoYXQgV2ViR1BVIG9ubHkgc3VwcG9ydHMgYSBzaW5nbGUgbWFzaywgd2UgdXNlIHRoZSBvbmUgZnJvbSBmcm9udCwgYnV0IG5vdCBmcm9tIGJhY2suXG4gICAgICAgICAgICAgICAgZGVwdGhTdGVuY2lsLnN0ZW5jaWxSZWFkTWFzID0gc3RlbmNpbEZyb250LnJlYWRNYXNrO1xuICAgICAgICAgICAgICAgIGRlcHRoU3RlbmNpbC5zdGVuY2lsV3JpdGVNYXNrID0gc3RlbmNpbEZyb250LndyaXRlTWFzaztcblxuICAgICAgICAgICAgICAgIGRlcHRoU3RlbmNpbC5zdGVuY2lsRnJvbnQgPSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBhcmU6IF9jb21wYXJlRnVuY3Rpb25bc3RlbmNpbEZyb250LmZ1bmNdLFxuICAgICAgICAgICAgICAgICAgICBmYWlsT3A6IF9zdGVuY2lsT3BzW3N0ZW5jaWxGcm9udC5mYWlsXSxcbiAgICAgICAgICAgICAgICAgICAgcGFzc09wOiBfc3RlbmNpbE9wc1tzdGVuY2lsRnJvbnQuenBhc3NdLFxuICAgICAgICAgICAgICAgICAgICBkZXB0aEZhaWxPcDogX3N0ZW5jaWxPcHNbc3RlbmNpbEZyb250LnpmYWlsXVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBkZXB0aFN0ZW5jaWwuc3RlbmNpbEJhY2sgPSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbXBhcmU6IF9jb21wYXJlRnVuY3Rpb25bc3RlbmNpbEJhY2suZnVuY10sXG4gICAgICAgICAgICAgICAgICAgIGZhaWxPcDogX3N0ZW5jaWxPcHNbc3RlbmNpbEJhY2suZmFpbF0sXG4gICAgICAgICAgICAgICAgICAgIHBhc3NPcDogX3N0ZW5jaWxPcHNbc3RlbmNpbEJhY2suenBhc3NdLFxuICAgICAgICAgICAgICAgICAgICBkZXB0aEZhaWxPcDogX3N0ZW5jaWxPcHNbc3RlbmNpbEJhY2suemZhaWxdXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBkZXB0aFN0ZW5jaWw7XG4gICAgfVxuXG4gICAgY3JlYXRlKHByaW1pdGl2ZVRvcG9sb2d5LCBzaGFkZXIsIHJlbmRlclRhcmdldCwgcGlwZWxpbmVMYXlvdXQsIGJsZW5kU3RhdGUsIGRlcHRoU3RhdGUsIHZlcnRleEJ1ZmZlckxheW91dCxcbiAgICAgICAgY3VsbE1vZGUsIHN0ZW5jaWxFbmFibGVkLCBzdGVuY2lsRnJvbnQsIHN0ZW5jaWxCYWNrKSB7XG5cbiAgICAgICAgY29uc3Qgd2dwdSA9IHRoaXMuZGV2aWNlLndncHU7XG5cbiAgICAgICAgLyoqIEB0eXBlIHtpbXBvcnQoJy4vd2ViZ3B1LXNoYWRlci5qcycpLldlYmdwdVNoYWRlcn0gKi9cbiAgICAgICAgY29uc3Qgd2ViZ3B1U2hhZGVyID0gc2hhZGVyLmltcGw7XG5cbiAgICAgICAgLyoqIEB0eXBlIHtHUFVSZW5kZXJQaXBlbGluZURlc2NyaXB0b3J9ICovXG4gICAgICAgIGNvbnN0IGRlc2NyID0ge1xuICAgICAgICAgICAgdmVydGV4OiB7XG4gICAgICAgICAgICAgICAgbW9kdWxlOiB3ZWJncHVTaGFkZXIuZ2V0VmVydGV4U2hhZGVyTW9kdWxlKCksXG4gICAgICAgICAgICAgICAgZW50cnlQb2ludDogd2ViZ3B1U2hhZGVyLnZlcnRleEVudHJ5UG9pbnQsXG4gICAgICAgICAgICAgICAgYnVmZmVyczogdmVydGV4QnVmZmVyTGF5b3V0XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBmcmFnbWVudDoge1xuICAgICAgICAgICAgICAgIG1vZHVsZTogd2ViZ3B1U2hhZGVyLmdldEZyYWdtZW50U2hhZGVyTW9kdWxlKCksXG4gICAgICAgICAgICAgICAgZW50cnlQb2ludDogd2ViZ3B1U2hhZGVyLmZyYWdtZW50RW50cnlQb2ludCxcbiAgICAgICAgICAgICAgICB0YXJnZXRzOiBbXVxuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgcHJpbWl0aXZlOiB7XG4gICAgICAgICAgICAgICAgdG9wb2xvZ3k6IHByaW1pdGl2ZVRvcG9sb2d5LFxuICAgICAgICAgICAgICAgIGZyb250RmFjZTogJ2NjdycsXG4gICAgICAgICAgICAgICAgY3VsbE1vZGU6IF9jdWxsTW9kZXNbY3VsbE1vZGVdXG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBkZXB0aFN0ZW5jaWw6IHRoaXMuZ2V0RGVwdGhTdGVuY2lsKGRlcHRoU3RhdGUsIHJlbmRlclRhcmdldCwgc3RlbmNpbEVuYWJsZWQsIHN0ZW5jaWxGcm9udCwgc3RlbmNpbEJhY2spLFxuXG4gICAgICAgICAgICBtdWx0aXNhbXBsZToge1xuICAgICAgICAgICAgICAgIGNvdW50OiByZW5kZXJUYXJnZXQuc2FtcGxlc1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgLy8gdW5pZm9ybSAvIHRleHR1cmUgYmluZGluZyBsYXlvdXRcbiAgICAgICAgICAgIGxheW91dDogcGlwZWxpbmVMYXlvdXRcbiAgICAgICAgfTtcblxuICAgICAgICBjb25zdCBjb2xvckF0dGFjaG1lbnRzID0gcmVuZGVyVGFyZ2V0LmltcGwuY29sb3JBdHRhY2htZW50cztcbiAgICAgICAgaWYgKGNvbG9yQXR0YWNobWVudHMubGVuZ3RoID4gMCkge1xuXG4gICAgICAgICAgICAvLyB0aGUgc2FtZSB3cml0ZSBtYXNrIGlzIHVzZWQgYnkgYWxsIGNvbG9yIGJ1ZmZlcnMsIHRvIG1hdGNoIHRoZSBXZWJHTCBiZWhhdmlvclxuICAgICAgICAgICAgbGV0IHdyaXRlTWFzayA9IDA7XG4gICAgICAgICAgICBpZiAoYmxlbmRTdGF0ZS5yZWRXcml0ZSkgd3JpdGVNYXNrIHw9IEdQVUNvbG9yV3JpdGUuUkVEO1xuICAgICAgICAgICAgaWYgKGJsZW5kU3RhdGUuZ3JlZW5Xcml0ZSkgd3JpdGVNYXNrIHw9IEdQVUNvbG9yV3JpdGUuR1JFRU47XG4gICAgICAgICAgICBpZiAoYmxlbmRTdGF0ZS5ibHVlV3JpdGUpIHdyaXRlTWFzayB8PSBHUFVDb2xvcldyaXRlLkJMVUU7XG4gICAgICAgICAgICBpZiAoYmxlbmRTdGF0ZS5hbHBoYVdyaXRlKSB3cml0ZU1hc2sgfD0gR1BVQ29sb3JXcml0ZS5BTFBIQTtcblxuICAgICAgICAgICAgLy8gdGhlIHNhbWUgYmxlbmQgc3RhdGUgaXMgdXNlZCBieSBhbGwgY29sb3IgYnVmZmVycywgdG8gbWF0Y2ggdGhlIFdlYkdMIGJlaGF2aW9yXG4gICAgICAgICAgICBjb25zdCBibGVuZCA9IHRoaXMuZ2V0QmxlbmQoYmxlbmRTdGF0ZSk7XG5cbiAgICAgICAgICAgIGNvbG9yQXR0YWNobWVudHMuZm9yRWFjaCgoYXR0YWNobWVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGRlc2NyLmZyYWdtZW50LnRhcmdldHMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIGZvcm1hdDogYXR0YWNobWVudC5mb3JtYXQsXG4gICAgICAgICAgICAgICAgICAgIHdyaXRlTWFzazogd3JpdGVNYXNrLFxuICAgICAgICAgICAgICAgICAgICBibGVuZDogYmxlbmRcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgV2ViZ3B1RGVidWcudmFsaWRhdGUodGhpcy5kZXZpY2UpO1xuXG4gICAgICAgIF9waXBlbGluZUlkKys7XG4gICAgICAgIERlYnVnSGVscGVyLnNldExhYmVsKGRlc2NyLCBgUmVuZGVyUGlwZWxpbmVEZXNjci0ke19waXBlbGluZUlkfWApO1xuXG4gICAgICAgIGNvbnN0IHBpcGVsaW5lID0gd2dwdS5jcmVhdGVSZW5kZXJQaXBlbGluZShkZXNjcik7XG5cbiAgICAgICAgRGVidWdIZWxwZXIuc2V0TGFiZWwocGlwZWxpbmUsIGBSZW5kZXJQaXBlbGluZS0ke19waXBlbGluZUlkfWApO1xuICAgICAgICBEZWJ1Zy50cmFjZShUUkFDRUlEX1JFTkRFUlBJUEVMSU5FX0FMTE9DLCBgQWxsb2M6IElkICR7X3BpcGVsaW5lSWR9YCwgZGVzY3IpO1xuXG4gICAgICAgIFdlYmdwdURlYnVnLmVuZCh0aGlzLmRldmljZSwge1xuICAgICAgICAgICAgcmVuZGVyUGlwZWxpbmU6IHRoaXMsXG4gICAgICAgICAgICBkZXNjcixcbiAgICAgICAgICAgIHNoYWRlclxuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4gcGlwZWxpbmU7XG4gICAgfVxufVxuXG5leHBvcnQgeyBXZWJncHVSZW5kZXJQaXBlbGluZSB9O1xuIl0sIm5hbWVzIjpbIl9waXBlbGluZUlkIiwiX2xheW91dElkIiwiX3ByaW1pdGl2ZVRvcG9sb2d5IiwidW5kZWZpbmVkIiwiX2JsZW5kT3BlcmF0aW9uIiwiX2JsZW5kRmFjdG9yIiwiX2NvbXBhcmVGdW5jdGlvbiIsIl9jdWxsTW9kZXMiLCJfc3RlbmNpbE9wcyIsIl9iaW5kR3JvdXBMYXlvdXRzIiwiV2ViZ3B1UmVuZGVyUGlwZWxpbmUiLCJjb25zdHJ1Y3RvciIsImRldmljZSIsInZlcnRleEJ1ZmZlckxheW91dCIsIldlYmdwdVZlcnRleEJ1ZmZlckxheW91dCIsImNhY2hlIiwiTWFwIiwiZ2V0IiwicHJpbWl0aXZlIiwidmVydGV4Rm9ybWF0MCIsInZlcnRleEZvcm1hdDEiLCJzaGFkZXIiLCJyZW5kZXJUYXJnZXQiLCJiaW5kR3JvdXBGb3JtYXRzIiwiYmxlbmRTdGF0ZSIsImRlcHRoU3RhdGUiLCJjdWxsTW9kZSIsInN0ZW5jaWxFbmFibGVkIiwic3RlbmNpbEZyb250Iiwic3RlbmNpbEJhY2siLCJrZXkiLCJnZXRLZXkiLCJwaXBlbGluZSIsInByaW1pdGl2ZVRvcG9sb2d5IiwidHlwZSIsIkRlYnVnIiwiYXNzZXJ0IiwicGlwZWxpbmVMYXlvdXQiLCJnZXRQaXBlbGluZUxheW91dCIsImNyZWF0ZSIsInNldCIsImJpbmRHcm91cEtleSIsImkiLCJsZW5ndGgiLCJ2ZXJ0ZXhCdWZmZXJMYXlvdXRLZXkiLCJyZW5kZXJUYXJnZXRLZXkiLCJpbXBsIiwic3RlbmNpbEtleSIsInZlcnRleENvZGUiLCJmcmFnbWVudENvZGUiLCJmb3JFYWNoIiwiZm9ybWF0IiwicHVzaCIsImJpbmRHcm91cExheW91dCIsImRlc2NyIiwiYmluZEdyb3VwTGF5b3V0cyIsIkRlYnVnSGVscGVyIiwic2V0TGFiZWwiLCJ3Z3B1IiwiY3JlYXRlUGlwZWxpbmVMYXlvdXQiLCJ0cmFjZSIsIlRSQUNFSURfUElQRUxJTkVMQVlPVVRfQUxMT0MiLCJnZXRCbGVuZCIsImJsZW5kIiwiY29sb3IiLCJvcGVyYXRpb24iLCJjb2xvck9wIiwic3JjRmFjdG9yIiwiY29sb3JTcmNGYWN0b3IiLCJkc3RGYWN0b3IiLCJjb2xvckRzdEZhY3RvciIsImFscGhhIiwiYWxwaGFPcCIsImFscGhhU3JjRmFjdG9yIiwiYWxwaGFEc3RGYWN0b3IiLCJnZXREZXB0aFN0ZW5jaWwiLCJkZXB0aFN0ZW5jaWwiLCJkZXB0aCIsInN0ZW5jaWwiLCJkZXB0aEZvcm1hdCIsImRlcHRoV3JpdGVFbmFibGVkIiwid3JpdGUiLCJkZXB0aENvbXBhcmUiLCJmdW5jIiwic3RlbmNpbFJlYWRNYXMiLCJyZWFkTWFzayIsInN0ZW5jaWxXcml0ZU1hc2siLCJ3cml0ZU1hc2siLCJjb21wYXJlIiwiZmFpbE9wIiwiZmFpbCIsInBhc3NPcCIsInpwYXNzIiwiZGVwdGhGYWlsT3AiLCJ6ZmFpbCIsIndlYmdwdVNoYWRlciIsInZlcnRleCIsIm1vZHVsZSIsImdldFZlcnRleFNoYWRlck1vZHVsZSIsImVudHJ5UG9pbnQiLCJ2ZXJ0ZXhFbnRyeVBvaW50IiwiYnVmZmVycyIsImZyYWdtZW50IiwiZ2V0RnJhZ21lbnRTaGFkZXJNb2R1bGUiLCJmcmFnbWVudEVudHJ5UG9pbnQiLCJ0YXJnZXRzIiwidG9wb2xvZ3kiLCJmcm9udEZhY2UiLCJtdWx0aXNhbXBsZSIsImNvdW50Iiwic2FtcGxlcyIsImxheW91dCIsImNvbG9yQXR0YWNobWVudHMiLCJyZWRXcml0ZSIsIkdQVUNvbG9yV3JpdGUiLCJSRUQiLCJncmVlbldyaXRlIiwiR1JFRU4iLCJibHVlV3JpdGUiLCJCTFVFIiwiYWxwaGFXcml0ZSIsIkFMUEhBIiwiYXR0YWNobWVudCIsIldlYmdwdURlYnVnIiwidmFsaWRhdGUiLCJjcmVhdGVSZW5kZXJQaXBlbGluZSIsIlRSQUNFSURfUkVOREVSUElQRUxJTkVfQUxMT0MiLCJlbmQiLCJyZW5kZXJQaXBlbGluZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFNQSxJQUFJQSxXQUFXLEdBQUcsQ0FBQyxD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
